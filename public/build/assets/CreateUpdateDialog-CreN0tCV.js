import{r as n,G as I,j as e}from"./app-fwyInB3c.js";import{D as M,b as G,c as O,d as R,f as U,g as q}from"./dialog-iaZkf6Xy.js";import{B as L}from"./button-Blwr-A5N.js";import{I as c}from"./input-CqlBlYgU.js";import{S as z}from"./separator-BWKairMX.js";import{G as H}from"./GoogleSearch-Altsbd1c.js";import"./command-PoUoScut.js";import"./popover-DaRbHQOK.js";import"./avatar-oBOSifLN.js";import"./tooltip-DFfoxvAF.js";import{I as P}from"./LucideIcon-CEqEhMjI.js";import{c as J}from"./index-DVo7DTeW.js";import{D as K}from"./DecisionModal-Dl8siGBG.js";import{A as j}from"./AdvanceDropdown-CXptW6sy.js";import{u as Q}from"./useTranslation-BtIkv0Na.js";import{o as N,u as p,s as r,n as k,a as m,b as v}from"./types-BZmDMmQb.js";import"./utils-CytzSlOG.js";import"./x-2mzC_aTV.js";import"./createLucideIcon-DoJ0Kelj.js";import"./index-DloWbRVd.js";import"./index-BwobEAja.js";import"./index-BIJodELy.js";import"./Map-D73hm0ip.js";import"./index.modern-WcJlzckG.js";import"./index-B7srb2QZ.js";import"./index-p2DxCSsL.js";import"./index-DmpKZt4E.js";import"./index-DmaU4p-o.js";import"./index-CyKk8pQ_.js";import"./tslib.es6-BUas5LQb.js";import"./index-CLai1W86.js";import"./index-BZgm3BCW.js";import"./index-BZxTbISK.js";import"./index-CeuhGnKJ.js";import"./calendar-days-Dti00tYQ.js";import"./calendar-k1x2vwx8.js";import"./check-5DjPwM22.js";import"./chevron-up-OjKdrhzc.js";import"./chevron-right-B1iws4WK.js";import"./user-plus-zM6CnMXf.js";import"./user-CNwXqt1W.js";import"./octagon-alert-BRAzZNeG.js";import"./alert-dialog-kDfn0La3.js";import"./Button-CQuYVLGu.js";import"./AdvanceDropdown-qoEi4BOz.js";import"./Create-tmHr2JLD.js";import"./AuthenticatedLayout-B4CSARVj.js";import"./sidebar-CPh6C6LB.js";import"./sheet-DHc5Hgr8.js";import"./skeleton-DSiYFg9q.js";import"./dropdown-menu-bHoOJ61X.js";import"./index-C_F9oucK.js";import"./index-v24TFYKQ.js";import"./PopUpIncidencias-CaovAEi3.js";import"./card-DYkZYgg5.js";import"./textarea-C969rVin.js";import"./UserAvatar-cKyxDEhx.js";import"./ApplicationLogo-C2FcO4AY.js";import"./Yoopta-Dj4Guze5.js";import"./throttle-CmSTFqON.js";import"./index-WlsBA3k2.js";import"./PrimaryButton-SsXyLm2e.js";import"./useNotifications-CSWGH93r.js";import"./ShowNotificactionFromJestream-cKOlvVdg.js";import"./OnboardingModal-D0HRNKzO.js";import"./Modal-BkRna8gK.js";import"./transition-ByAjZSmr.js";import"./StepItem-bNLmZaq8.js";import"./StepProgress-DNpLodXf.js";import"./WelcomeContent-BPJ5E7_N.js";import"./onboardingImages-CoczwfNn.js";import"./AboutContent-DOlAXyok.js";import"./TeamContent-C0DysUYq.js";import"./CreateLanguageForm-xwtvYsjX.js";import"./checkbox-BQT_ir1e.js";import"./index-BxSEkZvI.js";import"./index-4A9uUPu1.js";import"./alert-D9izbOQG.js";import"./InputSkeleton-CFMfUb-2.js";import"./table-cS0UKUSm.js";import"./GlobalFilter-DNA5td8x.js";import"./DataTableContext-BYrqyX0i.js";import"./index-Z1g0u-qm.js";import"./TableDebugging-C1u6ii1k.js";import"./AdvancedHeader-CpvwMmYr.js";import"./badge-BgloL8Ae.js";import"./select-B5O0TxCl.js";import"./DatePicker-YJSItPq7.js";import"./calendar-DctTJhwg.js";import"./endOfWeek-DoVA-Yvp.js";import"./toDate-qOSwr3PX.js";import"./format-Be40hyfq.js";import"./constants-BKFt95HM.js";import"./addDays-B9Fzl-_R.js";import"./parseISO-Efi0RkWR.js";import"./RowActionsColumn-CM2slffX.js";import"./RowActionsTrigger-DnJzXomR.js";import"./EmpleadoAvatar-BBWI_HPN.js";import"./ColumnFilter-oxYUebdb.js";import"./multi-select-BSyp-qjs.js";import"./Pill-l4GaXyto.js";import"./StatusEmpleadoMapColor-Bp2doaTo.js";import"./RowActionsColumn-C3VJw1Sg.js";import"./RowActionsTrigger-C2PXJFNn.js";import"./RowCheckedColumn-BShQ1j9z.js";import"./CreateUpdateDialog-1qQQjI_x.js";import"./useApiEndpoints-CHm1F3ft.js";import"./GoogleAddress-DWOptz48.js";import"./useDebounce-xNcQ83OW.js";import"./FetchSelect-CvqHmH4Y.js";import"./Spinner-DPRe7Z_J.js";import"./SheetTable-CiCNZjvD.js";import"./SheetTable-oFCbTdfY.js";import"./tabs-DtCm3GAf.js";import"./SheetTableHeader-vhJO3F_n.js";import"./ContratosVigentesDialog-SpBmuJuH.js";import"./DataHandlerContext--vx6a3_3.js";import"./WeekDay-C1ZcXS4Y.js";import"./GetModalidadIcon-BUgIPR97.js";import"./getRoundingMethod-D0I6Z7xl.js";import"./es-DNLwfvrq.js";const W=a=>N({id:k(m({message:a("dialog.id")})),nombre:r().nonempty({message:a("dialog.nombre")}),siglas:r().nonempty({message:a("dialog.siglas")}),cif:r().nonempty({message:a("dialog.cif")}),email:r().email({message:a("dialog.email")}),telefono:r().nonempty({message:a("dialog.telefono")}),representante_id:p([m(),v()]).refine(i=>i!==null,{message:a("dialog.representante")}),adjunto_id:p([m(),v()]).refine(i=>i!==null,{message:a("dialog.adjunto")}),direccion:N({id:k(m({message:a("dialog.id")})),full_address:r().nonempty({message:a("dialog.direccion")}),latitud:p([m(),r()]).refine(i=>i!==null,{message:a("dialog.latitud")}),longitud:p([m(),r()]).refine(i=>i!==null,{message:a("dialog.longitud")}),codigo_postal:r().nullable(),numero:r().nullable(),piso:r().nullable(),puerta:r().nullable(),escalera:r().nullable(),bloque:r().nullable()})});function ds({dataId:a,open:i,onOpenChange:u}){const{t:o}=Q("datatable"),[x,y]=n.useState(null),[X,D]=n.useState(!0),[Y,b]=n.useState(!1),[w,h]=n.useState(!1),S={id:null,nombre:"",siglas:"",cif:"",email:"",telefono:"",representante_id:null,adjunto_id:null,direccion:{id:null,full_address:"",latitud:"",longitud:"",codigo_postal:"",numero:"",piso:"",puerta:"",escalera:"",bloque:""}};n.useEffect(()=>{if(a)return(async()=>{try{const l=await axios.get(route("api.v1.admin.empresas.show",{id:a}));l.status===200?(y(l.data.empresa),_(l.data.empresa)):b(!0)}catch{b(!0)}finally{D(!1)}})(),()=>{}},[a]);const _=s=>{const{id:l,nombre:d,siglas:T,cif:V,email:A,telefono:B,representante:g,adjunto:f,direccion:F}=s;t.setData({id:l,nombre:d,siglas:T,cif:V,email:A,telefono:B,representante_id:g==null?void 0:g.id,adjunto_id:f==null?void 0:f.id,direccion:F})},t=I(S),C=o(a?"tables.editarempresa":"tables.creacionempresa"),E=()=>{const s=W(o).safeParse(t.data);if(!s.success){const l=s.error.flatten().fieldErrors;Object.keys(l).forEach(d=>{t.setError(d,l[d][0])});return}x?t.put(route("admin.empresas.update",{id:x.id}),{onSuccess:()=>{t.reset(),u()},preserveState:!0,errorBag:"updateOrCreateEmpresa"}):t.post(route("admin.empresas.store"),{onSuccess:()=>{t.reset(),u()},errorBag:"updateOrCreateEmpresa"})};return e.jsxs(e.Fragment,{children:[e.jsxs(M,{open:i,onOpenChange:u,children:[e.jsxs(J,{children:[" ",o("tables.creacionempresa")," "]}),e.jsxs(G,{className:"sm:max-w-[1225px] sm:h-[620px] bg-custom-white dark:bg-custom-blackLight",children:[e.jsx(O,{children:e.jsx(R,{className:"",children:C})}),e.jsxs("div",{className:"flex flex-col gap-4 h-full overflow-y-auto p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold  text-custom-blue dark:text-custom-white",children:[o("datatable.nombre"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(c,{placeholder:o("tables.añadirnombre"),className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.nombre,onChange:s=>t.setData("nombre",s.target.value)}),t.errors.nombre&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.nombre})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[o("datatable.siglas"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(c,{placeholder:"Siglas de la empresa",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.siglas,onChange:s=>t.setData("siglas",s.target.value)}),t.errors.siglas&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.siglas})]}),e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["CIF",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(c,{placeholder:"CIF de la empresa",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.cif,onChange:s=>t.setData("cif",s.target.value)}),t.errors.cif&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.cif}),e.jsx("span",{className:"text-xs text-custom-gray-semiDark dark:text-custom-gray-dark pl-1",children:o("tables.RepetirRegistro")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[o("tables.representante")," ",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(j,{defaultValue:t.data.representante_id,onChangeValue:s=>t.setData("representante_id",s),enableCreateUpdateView:!0,enableSheetTableView:!0}),t.errors.representante_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.representante_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[o("tables.adjunto")," ",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(j,{defaultValue:t.data.adjunto_id,onChangeValue:s=>t.setData("adjunto_id",s)}),t.errors.adjunto_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.adjunto_id})]})]}),e.jsx(z,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h3",{className:"font-bold ",children:"Informacion de contacto"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[o("tables.direccion")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(H,{selectedAddress:t.data.direccion.full_address,onSelect:s=>t.setData("direccion",{...t.data.direccion,...s}),showMap:!1}),t.errors.direccion&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.direccion})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Email ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(c,{placeholder:"Email de la empresa",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.email,onChange:s=>t.setData("email",s.target.value)}),t.errors.email&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.email})]}),e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[o("tables.telefono")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(c,{placeholder:"Teléfono de la empresa",className:" rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.telefono,onChange:s=>t.setData("telefono",s.target.value)}),t.errors.telefono&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.telefono})]})]})]}),e.jsxs(U,{className:"flex justify-end gap-4 ",children:[e.jsx(q,{className:"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-hidden hover:bg-custom-gray-default dark:hover:bg-custom-blackSemi text-custom-black dark:text-custom-white rounded-full",children:o("tables.cancelar")}),e.jsx(L,{className:"bg-custom-orange  hover:bg-custom-blue text-custom-white dark:text-custom-black dark:hover:bg-custom-white rounded-full",onClick:()=>h(!0),children:x?"Editar":"Crear"})]})]})]}),e.jsx(K,{variant:"confirm",open:w,onOpenChange:()=>h(!i),action:E,title:"¿Estas seguro de crear la empresa?",content:"Esta acción creará una nueva empresa en el sistema. Ejecutando los flujos necesarios para su correcto funcionamiento.",icon:e.jsx(P,{name:"TriangleAlert",className:"text-custom-orange"})})]})}export{ds as default};
