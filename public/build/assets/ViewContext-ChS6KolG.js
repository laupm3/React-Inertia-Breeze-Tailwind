import{r as u,a as h,j as P}from"./app-fwyInB3c.js";import{toast as S}from"./index-WlsBA3k2.js";function $(){const[l,f]=u.useState(!1);return{isProcessing:l,processApproval:async(i,s,r,b=null,p=null)=>{var v,d,V,w;try{if(f(!0),!["manager","hr","direction"].includes(s))throw new Error(`Tipo de aprobaci칩n no v치lido: ${s}`);const o=`/api/v1/admin/solicitudes/${i}/process-approval`,c=await h.post(o,{tipo_aprobacion:s,aprobado:r==="aprobar",observacion:b});if(c.status===200){const n=`Solicitud ${r==="aprobar"?"aprobada":"rechazada"} como ${s}`;return S.success(n),p&&p(c.data),!0}return!1}catch(t){console.error(`Error al ${r} solicitud:`,t);let o=`Error al ${r} la solicitud`;if(((v=t.response)==null?void 0:v.status)===403)o="No tienes permisos para realizar esta acci칩n";else if(((d=t.response)==null?void 0:d.status)===422){const c=t.response.data.errors||{},n=Object.values(c)[0];o=Array.isArray(n)?n[0]:n||o}else(w=(V=t.response)==null?void 0:V.data)!=null&&w.message&&(o=t.response.data.message);return S.error(o),!1}finally{f(!1)}},getApprovalStatus:async i=>{try{const s=`/api/v1/admin/solicitudes/${i}/approval-status`,r=await h.get(s);return r.status===200?r.data:null}catch(s){return console.error("Error al obtener estado de aprobaci칩n:",s),null}}}}const A=u.createContext(null),j=({children:l,CreateUpdateViewComponent:f=null,SheetTableViewComponent:m=null,DeleteViewComponent:x=null,refreshData:i=null})=>{const{processApproval:s,isProcessing:r}=$(),[b,p]=u.useState({open:!1,model:null}),[v,d]=u.useState({open:!1,model:null}),[V,w]=u.useState({open:!1,model:null}),t=e=>{p(a=>({open:!a.open,model:y(e)}))},o=e=>{d(a=>({open:!a.open,model:y(e)}))},c=e=>{w(a=>({open:!a.open,model:y(e)}))},n=async(e,a,g,C=null)=>{const E=e.id||e;return{success:await s(E,a,g,C,T=>{i&&i()})}},y=e=>(e==null?void 0:e.id)??e??null;return P.jsx(A.Provider,{value:{createUpdateView:b,setCreateUpdateView:p,sheetView:v,setSheetView:d,destroyView:V,setDestroyView:w,handleCreateUpdateView:t,handleSheetView:o,handleDestroyView:c,handleDropdownMenu:n,isProcessingApproval:r,CreateUpdateViewComponent:f,SheetTableViewComponent:m,DeleteViewComponent:x},children:l})};function _(){const l=u.useContext(A);if(!l)throw new Error("useView debe usarse dentro de ViewContextProvider");return l}const U=Object.freeze(Object.defineProperty({__proto__:null,ViewContextProvider:j,useView:_},Symbol.toStringTag,{value:"Module"}));export{j as V,_ as a,U as b,$ as u};
