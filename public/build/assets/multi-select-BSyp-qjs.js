import{r as n,j as e}from"./app-fwyInB3c.js";import{c as X}from"./index-BwobEAja.js";import{c as u}from"./utils-CytzSlOG.js";import{S as N}from"./separator-BWKairMX.js";import{B as G}from"./button-Blwr-A5N.js";import{B as C}from"./badge-BgloL8Ae.js";import{P as H,a as K,b as q}from"./popover-DaRbHQOK.js";import{C as A,a as S,b as J,c as Q,d as k,e as g}from"./command-PoUoScut.js";import{I as U}from"./input-CqlBlYgU.js";import{C as Y}from"./LucideIcon-CEqEhMjI.js";import{X as Z}from"./x-2mzC_aTV.js";import{C as M}from"./chevron-up-OjKdrhzc.js";import{C as P}from"./check-5DjPwM22.js";const V=X("m-1 transition ease-in-out delay-150 hover:-translate-y-1 hover:scale-110 duration-300",{variants:{variant:{default:"border-foreground/10 text-foreground bg-card hover:bg-card/80",secondary:"border-foreground/10 bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",inverted:"inverted"}},defaultVariants:{variant:"default"}}),ee=n.forwardRef(({options:o,onValueChange:i,variant:x,defaultValue:O=[],placeholder:B="Select options",animation:se=0,maxCount:h=1,modalPopover:E=!1,asChild:re=!1,className:L,...R},D)=>{const[F,T]=n.useState({selectedValues:O,isPopoverOpen:!1,searchValue:""}),{selectedValues:t,isPopoverOpen:b,searchValue:m}=F,f=n.useRef(null),z=n.useMemo(()=>Object.fromEntries(t.map(s=>[s,!0])),[t]),c=n.useMemo(()=>{if(!m.trim())return o;const s=m.toLowerCase().trim();return o.filter(a=>{const r=typeof a.label=="string"?a.label.toLowerCase():"";return a.value.toLowerCase().includes(s)||r.includes(s)})},[o,m]),l=n.useCallback(s=>{T(a=>({...a,...s}))},[]),p=n.useCallback(s=>{const a=t.includes(s)?t.filter(r=>r!==s):[...t,s];l({selectedValues:a}),i(a)},[t,i,l]),I=n.useCallback(s=>{l({searchValue:s||""})},[l]),j=n.useCallback(()=>{l({selectedValues:[],searchValue:""}),i([])},[i,l]),[v,_]=n.useState(h);n.useEffect(()=>{if(!f.current)return;const s=()=>{var w;const r=((w=f.current)==null?void 0:w.clientWidth)||0,d=Math.floor((r-60)/100);_(Math.max(1,Math.min(d,h)))},a=new ResizeObserver(s);return a.observe(f.current),()=>a.disconnect()},[h]);const $=Math.min(v,t.length),y=t.length-$,W=n.useMemo(()=>t.slice(0,v).map(s=>{const a=o.find(r=>r.value===s);return e.jsx(C,{className:u("badge-item bg-transparent text-foreground border-foreground/1 hover:bg-transparent shrink-0",V({variant:x})),children:e.jsxs("div",{className:"px-1 py-1 flex items-center",children:[a==null?void 0:a.label,e.jsx(Y,{className:"h-4 w-4 cursor-pointer ml-2",onClick:r=>{r.stopPropagation(),p(s)}})]})},s)}),[t,v,o,x,p]);return e.jsxs(H,{open:b,onOpenChange:s=>l({isPopoverOpen:s}),modal:E,children:[e.jsx(K,{asChild:!0,children:e.jsx(G,{ref:D,...R,onClick:()=>l({isPopoverOpen:!b}),className:u("flex w-full p-1 min-h-10 h-auto items-center justify-between bg-inherit hover:bg-inherit [&_svg]:pointer-events-auto dark:text-custom-gray-default  dark:bg-custom-blackSemi rounded-full bg-custom-white border-2",L),children:t.length>0?e.jsxs("div",{className:"flex justify-between items-center overflow-hidden w-full",children:[e.jsxs("div",{ref:f,className:"rounded-full flex justify-between items-center w-full calc[100% - 50px] overflow-hidden relative",children:[e.jsx("div",{className:"flex items-center gap-1 w-full overflow-hidden flex-nowrap",children:W}),e.jsx("div",{className:"flex items-center z-10 shrink-0",children:y>0&&e.jsx(C,{className:u("bg-primary/10 text-primary border-primary/20 hover:bg-primary/20 w-8 h-8 flex items-center justify-center rounded-full",V({variant:x})),children:`+${y}`})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsx(Z,{className:"h-4 cursor-pointer text-muted-foreground",onClick:s=>{s.stopPropagation(),j()}}),e.jsx(N,{orientation:"vertical",className:"flex min-h-6 h-full"}),e.jsx(M,{className:"h-4 cursor-pointer text-muted-foreground"})]})]}):e.jsxs("div",{className:"flex items-center justify-between w-full mx-auto",children:[e.jsx("span",{className:"text-sm text-muted-foreground mx-3",children:B}),e.jsx(M,{className:"h-4 cursor-pointer text-muted-foreground mx-2"})]})})}),e.jsxs(q,{className:"w-80 sm:w-96 max-w-[calc(100vw-2rem)] p-0 z-[9999]",align:"start",onEscapeKeyDown:()=>l({isPopoverOpen:!1}),children:[e.jsx("div",{className:"p-3 sm:p-4",children:e.jsx(U,{placeholder:"Buscar...",value:m,onChange:s=>I(s.target.value),className:"mb-3"})}),e.jsxs(A,{shouldFilter:!1,className:"w-full",children:[e.jsxs("div",{className:"flex items-center cursor-pointer p-3 py-2 gap-2 hover:bg-accent hover:text-accent-foreground rounded-sm mx-2",onClick:()=>{const s=c.map(r=>r.value);if(s.every(r=>t.includes(r))){const r=t.filter(d=>!s.includes(d));l({selectedValues:r}),i(r)}else{const r=[...t.filter(d=>!s.includes(d)),...s];l({selectedValues:r}),i(r)}},children:[e.jsx("div",{className:u("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",c.length>0&&c.every(s=>t.includes(s.value))?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(P,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm",children:m?c.every(s=>t.includes(s.value))?`Deseleccionar resultados (${c.length})`:`Seleccionar resultados (${c.length})`:t.length===o.length?"Deseleccionar todo":"Seleccionar todo"})]}),e.jsx(S,{}),e.jsxs(J,{className:"max-h-[40vh] sm:max-h-[300px]",children:[e.jsx(Q,{children:"No results found."}),e.jsx(k,{className:"p-0",children:c.map(s=>{const a=z[s.value];return e.jsxs(g,{onSelect:()=>p(s.value),className:"cursor-pointer mx-2 px-3 py-2 text-sm rounded-sm",children:[e.jsx("div",{className:u("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary flex-shrink-0",a?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(P,{className:"h-4 w-4"})}),e.jsx("span",{className:"truncate",children:s.label})]},s.value)})})]}),e.jsx(S,{}),e.jsx(k,{className:"p-0",children:e.jsxs("div",{className:"flex items-center justify-between p-2 mx-2",children:[t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(g,{onSelect:j,className:"flex-1 justify-center cursor-pointer text-sm py-2",children:"Clear"}),e.jsx(N,{orientation:"vertical",className:"flex min-h-6 h-full mx-2"})]}),e.jsx(g,{onSelect:()=>l({isPopoverOpen:!1}),className:"flex-1 justify-center cursor-pointer max-w-full text-sm py-2",children:"Close"})]})})]})]})]})});ee.displayName="MultiSelect";export{ee as M};
