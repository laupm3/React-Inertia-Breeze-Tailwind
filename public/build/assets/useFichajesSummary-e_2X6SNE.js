import{useDataHandler as E}from"./DataHandlerContext-eWg_TTj1.js";import{r as I}from"./app-fwyInB3c.js";import{a as T}from"./addDays-B9Fzl-_R.js";import{d as b}from"./differenceInMilliseconds-D_qISUSz.js";import"./endOfWeek-DoVA-Yvp.js";import"./toDate-qOSwr3PX.js";import"./format-Be40hyfq.js";import"./constants-BKFt95HM.js";const f=(t,e)=>{if(!t||!e)return null;const a=t.split(" ")[0];return new Date(`${a}T${e}`)},P=t=>{let e=0,a=0;for(const i of t){const{fecha_inicio:o,horarioInicio:p,horarioFin:M,fichajeEntrada:u,fichajeSalida:F,descansosAdicionales:H}=i;let m=f(o,p),c=f(o,M);m&&c&&c<m&&(c=T(c,1));const S=m&&c?b(c,m):0;a+=S;let h=f(o,u),n=f(o,F);if(h&&n&&n<h&&(n=T(n,1)),h&&n){const y=(H||[]).map(r=>{let l=f(o,r.descansoInicio),d=f(o,r.descansoFin);return l&&d&&d<l&&(d=T(d,1)),l&&d?{start:l,end:d}:null}).filter(Boolean).sort((r,l)=>r.start-l.start);let s=h,j=0;for(const r of y){if(r.start>n)break;r.start>s&&(j+=b(r.start,s)),s=r.end>s?r.end:s}s<n&&(j+=b(n,s)),e+=j}}return{totalMsFichaje:e,totalMsTeorico:a}},$=t=>{if(isNaN(t)||t===null)return"00:00";const e=t<0?"-":"",a=Math.abs(t),i=Math.floor(a/36e5),o=Math.floor(a%36e5/6e4);return`${e}${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`};function _(){const{data:t}=E();return I.useMemo(()=>{const{totalMsFichaje:a,totalMsTeorico:i}=P(t||[]),o=a-i,p=$(a),M=$(i),u=$(o),F=o>0?`+${u}`:u;return{jornadaEfectuada:p,jornadaTotal:M,balanceHoras:F}},[t])}export{_ as useFichajesSummary};
