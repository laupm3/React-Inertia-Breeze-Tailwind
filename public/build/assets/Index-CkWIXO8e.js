import{r as c,j as e,G as se,a as te,S as re}from"./app-fwyInB3c.js";import{A as ae}from"./AuthenticatedLayout-B4CSARVj.js";import oe from"./CreateUpdateView-DlIErSmT.js";import{ViewContextProvider as le}from"./ViewContext-DEo2JOKd.js";import{DataHandlerContextProvider as ie}from"./DataHandlerContext-BHBV8SJt.js";import ne from"./DataTablePortal-Cl965DN5.js";import ce from"./SheetTableView-sVIfejvD.js";import de from"./DeleteView-BIB6dwHF.js";import{f as me,c as Q,d as W,e as ue,b as X,D as Y,a as xe}from"./dialog-iaZkf6Xy.js";import{u as Z}from"./useTranslation-BtIkv0Na.js";import{o as q,u as C,s as h,n as I,a as N,b as S}from"./types-BZmDMmQb.js";import{toast as E}from"./index-WlsBA3k2.js";import{I as _}from"./input-CqlBlYgU.js";import{S as M}from"./separator-BWKairMX.js";import{G as pe}from"./GoogleAddress-DWOptz48.js";import{u as fe}from"./useDebounce-xNcQ83OW.js";import{F as he}from"./FetchSelect-CvqHmH4Y.js";import{A as H}from"./AdvanceDropdown-CXptW6sy.js";import{A as ge}from"./AdvanceDropdown-qoEi4BOz.js";import{A as be}from"./AdvancedHeader-CpvwMmYr.js";import{C as v}from"./ColumnFilter-oxYUebdb.js";import{r as je}from"./RowActionsColumn-C3VJw1Sg.js";import{r as we}from"./RowCheckedColumn-BShQ1j9z.js";import{E as R}from"./EmpleadoAvatar-BBWI_HPN.js";import{C as Ne}from"./CreateUpdateDialog-1qQQjI_x.js";import{S as ve}from"./SheetTable-CiCNZjvD.js";import{S as u}from"./skeleton-DSiYFg9q.js";import{B as z}from"./Button-CQuYVLGu.js";import{S as ke}from"./Spinner-DPRe7Z_J.js";import{O as Ce}from"./octagon-alert-BRAzZNeG.js";import{S as B}from"./SheetTable-oFCbTdfY.js";import{B as G}from"./BlockCard-TCX704se.js";import{S as O}from"./StatusCentroMapColor-CX6Qfqkj.js";import{P as J}from"./Pill-l4GaXyto.js";import{M as De}from"./Maps-BeRVQUtC.js";import{B as ye}from"./button-Blwr-A5N.js";import{I as k}from"./LucideIcon-CEqEhMjI.js";import{D as Se}from"./DecisionModal-Dl8siGBG.js";import"./sidebar-CPh6C6LB.js";import"./index-DloWbRVd.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./sheet-DHc5Hgr8.js";import"./index-DVo7DTeW.js";import"./index-DmpKZt4E.js";import"./index-p2DxCSsL.js";import"./index-B7srb2QZ.js";import"./index-BIJodELy.js";import"./index-DmaU4p-o.js";import"./index-CyKk8pQ_.js";import"./tslib.es6-BUas5LQb.js";import"./index-BZxTbISK.js";import"./x-2mzC_aTV.js";import"./createLucideIcon-DoJ0Kelj.js";import"./tooltip-DFfoxvAF.js";import"./index-CLai1W86.js";import"./index-BZgm3BCW.js";import"./index-CeuhGnKJ.js";import"./dropdown-menu-bHoOJ61X.js";import"./index-C_F9oucK.js";import"./index-v24TFYKQ.js";import"./check-5DjPwM22.js";import"./chevron-right-B1iws4WK.js";import"./popover-DaRbHQOK.js";import"./avatar-oBOSifLN.js";import"./PopUpIncidencias-CaovAEi3.js";import"./card-DYkZYgg5.js";import"./textarea-C969rVin.js";import"./UserAvatar-cKyxDEhx.js";import"./ApplicationLogo-C2FcO4AY.js";import"./Yoopta-Dj4Guze5.js";import"./throttle-CmSTFqON.js";import"./PrimaryButton-SsXyLm2e.js";import"./useNotifications-CSWGH93r.js";import"./ShowNotificactionFromJestream-cKOlvVdg.js";import"./OnboardingModal-D0HRNKzO.js";import"./Modal-BkRna8gK.js";import"./transition-ByAjZSmr.js";import"./StepItem-bNLmZaq8.js";import"./StepProgress-DNpLodXf.js";import"./WelcomeContent-BPJ5E7_N.js";import"./onboardingImages-CoczwfNn.js";import"./AboutContent-DOlAXyok.js";import"./TeamContent-C0DysUYq.js";import"./calendar-days-Dti00tYQ.js";import"./calendar-k1x2vwx8.js";import"./chevron-up-OjKdrhzc.js";import"./user-plus-zM6CnMXf.js";import"./user-CNwXqt1W.js";import"./DataTable-D4Fn3B2g.js";import"./table-cS0UKUSm.js";import"./DataTableContext-BYrqyX0i.js";import"./index-Z1g0u-qm.js";import"./TableFilters-ZojjKFl2.js";import"./GlobalFilter-DNA5td8x.js";import"./ImportExportDropdown-COI3HdRN.js";import"./index-C-xs73Vr.js";import"./index-DpIruHMc.js";import"./badge-BgloL8Ae.js";import"./scroll-area-CvQ1XCoU.js";import"./select-B5O0TxCl.js";import"./index-4A9uUPu1.js";import"./checkbox-BQT_ir1e.js";import"./index-BxSEkZvI.js";import"./TableDebugging-C1u6ii1k.js";import"./useColumns-BxN8FBLc.js";import"./RowSelectionColumn-COjZFz9T.js";import"./RowActionsColumn-CM2slffX.js";import"./RowActionsTrigger-DnJzXomR.js";import"./command-PoUoScut.js";import"./DatePicker-YJSItPq7.js";import"./calendar-DctTJhwg.js";import"./endOfWeek-DoVA-Yvp.js";import"./toDate-qOSwr3PX.js";import"./format-Be40hyfq.js";import"./constants-BKFt95HM.js";import"./addDays-B9Fzl-_R.js";import"./parseISO-Efi0RkWR.js";import"./multi-select-BSyp-qjs.js";import"./Map-D73hm0ip.js";import"./index.modern-WcJlzckG.js";import"./StatusEmpleadoMapColor-Bp2doaTo.js";import"./Create-tmHr2JLD.js";import"./CreateLanguageForm-xwtvYsjX.js";import"./alert-D9izbOQG.js";import"./alert-dialog-kDfn0La3.js";import"./InputSkeleton-CFMfUb-2.js";import"./RowActionsTrigger-C2PXJFNn.js";import"./useApiEndpoints-CHm1F3ft.js";import"./tabs-DtCm3GAf.js";import"./SheetTableHeader-vhJO3F_n.js";import"./ContratosVigentesDialog-SpBmuJuH.js";import"./DataHandlerContext--vx6a3_3.js";import"./WeekDay-C1ZcXS4Y.js";import"./GetModalidadIcon-BUgIPR97.js";import"./getRoundingMethod-D0I6Z7xl.js";import"./es-DNLwfvrq.js";function Fe(){return c.useMemo(()=>[we,{id:"nombre",title:"Nombre empresa",enableHiding:!1,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,header:({column:s})=>e.jsx(be,{column:s,className:"max-w-[250px]"}),cell:({row:s})=>e.jsx("span",{children:s.original.nombre}),accessorFn:s=>s.nombre,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"siglas",title:"Siglas",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx("span",{children:s.original.siglas}),accessorFn:s=>s.siglas,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"cif",title:"CIF",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx("span",{children:s.original.cif}),accessorFn:s=>s.cif,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"direccion",title:"Dirección fiscal",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx("div",{className:"text-ellipsis overflow-hidden whitespace-nowrap max-w-[250px]",children:s.original.direccion.full_address}),accessorFn:s=>s.direccion.full_address,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"email",title:"Email",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx("span",{children:s.original.email}),accessorFn:s=>s.email,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"telefono",title:"Teléfono",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx("span",{children:s.original.telefono}),accessorFn:s=>s.telefono,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"representante",title:"Representante",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx(R,{empleado:s.original.representante}),accessorFn:s=>`${s.representante.primerApellido} ${s.representante.segundoApellido}, ${s.representante.nombre}`,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"adjunto",title:"Adjunto",enableHiding:!0,enableSorting:!0,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,className:"max-w-[250px]"},`filter${s.id}`),cell:({row:s})=>e.jsx(R,{empleado:s.original.adjunto}),accessorFn:s=>`${s.adjunto.primerApellido} ${s.adjunto.segundoApellido}, ${s.adjunto.nombre}`,filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.toLowerCase().includes(o.toLowerCase()))}},{id:"centros",title:"Centros",enableHiding:!1,enableSorting:!1,sortUndefined:"last",enableFiltering:!0,hideColumn:!0,header:({column:s})=>e.jsx(v,{column:s,labelFn:a=>`${a.nombre}`,valueFn:a=>a.nombre,className:"min-w-[150px] max-w-[250px]"},`filter${s.id}`),accessorFn:s=>s.centros?s.centros.map(a=>a.nombre.toLowerCase()):[],filterFn:(s,a,t)=>{if(!t.length)return!0;const l=s.getValue(a);return t.some(o=>l.some(i=>i.includes(o.toLowerCase())))}},je],[])}function Ee({defaultValue:r=null,onChangeValue:s=()=>{},enableCreateUpdateView:a=!1,enableSheetTableView:t=!1}){return e.jsx(ge,{defaultValue:r,onChangeValue:s,renderSelection:l=>e.jsx("span",{children:l.nombre}),fetchUrl:route("api.v1.admin.empresas.index"),dataKey:"empresas",columns:Fe(),enableCreateUpdateView:a,enableSheetTableView:t,CreateUpdateViewComponent:Ne,SheetTableViewComponent:ve,cacheDuration:2*60*1e3})}const _e=()=>{const{t:r}=Z(["datatable"]);return q({id:I(N({message:"El ID es requerido"})),nombre:h().nonempty({message:"El nombre es requerido"}),email:h().email({message:"El email no es válido"}),telefono:h().nonempty({message:"El teléfono es requerido"}),empresa_id:C([N(),S()]).refine(s=>s!==null,{message:"La empresa es requerida"}),estado_id:C([N(),S()]).refine(s=>s!==null,{message:"El estado es requerido"}),coordinador_id:C([N(),S()]).refine(s=>s!==null,{message:"El coordinador es requerido"}),responsable_id:C([N(),S()]).refine(s=>s!==null,{message:"El responsable es requerido"}),direccion:q({id:I(N({message:"El ID es requerido"})),full_address:h().nonempty({message:"La dirección es requerida"}),latitud:C([N(),h()]).refine(s=>s!==null,{message:"La latitud es requerida"}),longitud:C([N(),h()]).refine(s=>s!==null,{message:"La longitud es requerida"}),codigo_postal:h().nullable(),numero:h().nullable(),piso:h().nullable(),puerta:h().nullable(),escalera:h().nullable(),bloque:h().nullable()})})},F={id:null,nombre:"",email:"",telefono:"",empresa_id:null,estado_id:null,responsable_id:null,coordinador_id:null,direccion:{id:null,full_address:"",latitud:"",longitud:"",codigo_postal:"",numero:"",piso:"",puerta:"",escalera:"",bloque:""}},Le=r=>{var a,t,l,o;return r?{id:r.id,nombre:r.nombre,email:r.email,telefono:r.telefono,responsable_id:(a=r.responsable)==null?void 0:a.id,coordinador_id:(t=r.coordinador)==null?void 0:t.id,empresa_id:(l=r.empresa)==null?void 0:l.id,estado_id:(o=r.estado)==null?void 0:o.id,departamento_ids:r.departamentos.map(i=>i.id),direccion:r.direccion}:void 0},L=r=>c.useMemo(()=>({show:r?route("api.v1.admin.centros.show",{centro:r}):null,store:route("api.v1.admin.centros.store"),update:r?route("api.v1.admin.centros.update",{centro:r}):null,delete:r?route("api.v1.admin.centros.destroy",{centro:r}):null}),[r]),K=c.createContext(null),Ve=({children:r,model:s,onOpenChange:a,dataKey:t,onSaveData:l=null,modelAlias:o="registro"})=>{const[i,g]=c.useState(!1),[x,f]=c.useState(!1),[n,j]=c.useState(!1),[b,V]=c.useState(!1),y=L(s),d=se(F),$=_e();c.useEffect(()=>{const m=async()=>{try{j(!0),f(!1);const p=await axios.get(y.show);p.status===200?d.setData(Le(p.data[t])):f(!0)}catch(p){console.error("Error al cargar datos:",p),f(!0)}finally{j(!1)}};return d.clearErrors(),s?m():(d.setData(F),d.clearErrors(),f(!1),j(!1)),()=>{}},[s]),c.useEffect(()=>{s||(d.setData(F),d.clearErrors(),f(!1))},[s,d.setData]);const T=c.useCallback((m,p)=>{if(typeof m=="object"&&p===void 0){d.setData(w=>({...w,...m}));return}d.setData(w=>({...w,[m]:p}))},[d]),A=c.useCallback(()=>{const m=$.safeParse(d.data);if(d.clearErrors(),!m.success){const p=m.error.flatten().fieldErrors;Object.keys(p).forEach(w=>{d.setError(w,p[w][0])})}return m.success},[d,$]),U=c.useCallback(async()=>{try{V(!0),f(!1),d.clearErrors();const m=s?await axios.put(y.update,d.data):await axios.post(y.store,d.data);l&&l(m.data[t]),s||(d.setData(F),d.clearErrors()),a(!1),E.success(s?`Registro ${o} actualizado con éxito`:`Registro ${o} creado con éxito`)}catch(m){if(f(!0),m.response&&m.response.data&&m.response.data.errors){const{errors:p}=m.response.data;Object.keys(p).forEach(w=>{d.setError(w,p[w][0])})}E.error(s?`Error al actualizar el ${o}`:`Error al crear el ${o}`)}finally{V(!1)}},[s,y.update,y.store,d,l,a]),P=c.useCallback(()=>{A()&&U()},[A,U]),ee=c.useMemo(()=>({modelAlias:o,model:s,error:x,form:d,updateForm:T,handleSubmit:P,setError:f,onOpenChange:a,isProcessing:i,isLoading:n,isSaving:b,setIsProcessing:g}),[o,s,x,d,T,P,a,i,n,b]);return e.jsx(K.Provider,{value:ee,children:r})};function D(){const r=c.useContext(K);if(!r)throw new Error("useDialogData debe usarse dentro de DialogDataContextProvider");return r}function $e({}){var f;const{form:r,updateForm:s}=D(),{data:a,errors:t}=r,{t:l}=Z("datatable"),[o,i]=c.useState(a),g=fe(s,500);c.useEffect(()=>{i(a)},[a]);const x=c.useCallback((n,j)=>{i(typeof n=="object"?b=>({...b,...n}):b=>({...b,[n]:j})),t[n]&&delete t[n],g(n,j)},[g]);return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"grid gap-8",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Nombre",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(_,{placeholder:"Nombre del centro",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:o.nombre,onChange:n=>x("nombre",n.target.value)}),t.nombre&&e.jsx("span",{className:"text-xs text-red-500",children:t.nombre})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.administradorcentro"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(H,{defaultValue:o.responsable_id,onChangeValue:n=>x("responsable_id",n),enableCreateUpdateView:!0,enableSheetTableView:!0}),t.responsable_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.responsable_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.coordinador"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(H,{defaultValue:o.coordinador_id,onChangeValue:n=>x("coordinador_id",n),enableCreateUpdateView:!0,enableSheetTableView:!0}),t.coordinador_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.coordinador_id})]})]}),e.jsx(M,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h1",{className:"font-bold dark:text-custom-white",children:"Informacion de contacto"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.direccion")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(pe,{selectedAddress:(f=o.direccion)==null?void 0:f.full_address,onSelect:n=>x("direccion",{...o.direccion,...n}),data:o.direccion,handleChange:(n,j)=>x("direccion",{...o.direccion,[n]:j})}),t.direccion&&e.jsx("span",{className:"text-xs text-red-500",children:t.direccion})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Email ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(_,{placeholder:"Añadir email",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:o.email,onChange:n=>x("email",n.target.value),type:"tel"}),t.email&&e.jsx("span",{className:"text-xs text-red-500",children:t.email})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.telefono")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(_,{placeholder:"Añadir teléfono",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:o.telefono,onChange:n=>x("telefono",n.target.value),type:"tel"}),t.telefono&&e.jsx("span",{className:"text-xs text-red-500",children:t.telefono})]})]})]}),e.jsx(M,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h1",{className:"font-bold dark:text-custom-white",children:"Vinculación"}),e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.empresa")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(Ee,{defaultValue:o.empresa_id,onChangeValue:n=>x("empresa_id",n),enableCreateUpdateView:!0,enableSheetTableView:!0}),t.empresa_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.empresa_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[l("tables.estado")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(he,{fetchRoute:"api.v1.admin.centros.status",responseParameter:"estadoCentros",value:o.estado_id,onValueChange:n=>x("estado_id",Number(n)),disabled:!1}),t.estado_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.estado_id})]})]})]})}function Te(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col w-full gap-12 bg-custom-white dark:bg-custom-blackLight p-4",children:[e.jsx("div",{className:"flex flex-col gap-4 dark:dark-scrollbar",children:e.jsx(u,{className:"h-8 w-[350px]"})}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(u,{className:"h-8 w-[250px]"}),e.jsx(u,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(u,{className:"h-8 w-[250px]"}),e.jsx(u,{className:"h-12 w-full"})]})]}),e.jsx(u,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(u,{className:"h-8 w-[250px]"}),e.jsx(u,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(u,{className:"h-8 w-[250px]"}),e.jsx(u,{className:"h-12 w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4",children:[e.jsx(u,{className:"h-10 w-24"}),e.jsx(u,{className:"h-10 w-24"})]})]})}function Ae(){const{model:r,handleSubmit:s,onOpenChange:a,isSaving:t}=D(),l=r?"Actualizar":"Guardar",o=r?"Actualizando...":"Guardando...";return e.jsxs(me,{children:[e.jsx("div",{className:"flex flex-row w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center ml-auto justify-end gap-2",children:[e.jsx(z,{variant:"secondary",onClick:()=>a(!1),disabled:t,children:"Cancelar"}),e.jsx(z,{variant:"primary",onClick:()=>s(),disabled:t,children:l})]})}),t&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2",children:[e.jsx(ke,{size:"sm",className:"text-custom-orange"}),e.jsxs("span",{className:"text-md",children:[o,"..."]})]})]})}function Ue(){const{modelAlias:r,model:s}=D(),a=c.useMemo(()=>s?`Actualizar ${r}`:`Crear ${r}`,[s]);return e.jsxs(Q,{children:[e.jsx(W,{className:"dark:text-custom-white",children:a}),e.jsx(ue,{className:"hidden",children:a})]})}const Pe=()=>{const{error:r}=D();return r?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(Ce,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo procesar la solicitud. Por favor, inténtalo de nuevo."})]})]}):null};function qe({children:r}){const{isSaving:s}=D();return e.jsxs("div",{className:`flex flex-col gap-4 h-full overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200 ${s?"opacity-60":"opacity-100"}`,children:[e.jsx(Pe,{}),r]})}function Ie(){const{isLoading:r}=D();return e.jsx(X,{className:"flex flex-col gap-4 justify-between max-w-[1225px] h-[725px] bg-custom-white dark:bg-custom-blackLight",children:r?e.jsx(Te,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{}),e.jsx(qe,{children:e.jsx($e,{})}),e.jsx(Ae,{})]})})}const Me=c.memo(function({open:s,onOpenChange:a,model:t=null,onSaveData:l=null}){return e.jsx(Y,{open:s,onOpenChange:a,children:e.jsx(Ve,{model:t,onSaveData:l,onOpenChange:a,modelAlias:"centro",dataKey:"centro",children:e.jsx(Ie,{})})})});function He({data:r}){var o;function s({title:i,value:g}){return e.jsxs("section",{className:"flex flex-col sm:flex-row border-b border-custom-gray-default dark:border-custom-blackSemi last:border-b-0",children:[e.jsx("div",{className:"flex items-center py-3 px-4 sm:w-40 md:w-48 bg-custom-gray-default dark:bg-custom-blackSemi",children:e.jsx("span",{className:"text-sm text-custom-black dark:text-custom-white font-semibold",children:i})}),e.jsx("div",{className:"flex-1 py-3 px-4",children:e.jsx("span",{className:"text-sm text-custom-black dark:text-custom-white opacity-70",children:g})})]})}function a({department:i}){return e.jsxs("section",{className:"flex flex-col sm:flex-row sm:items-center gap-3 p-4 border-b border-custom-gray-semiLight dark:border-custom-gray-semiDark last:border-b-0",children:[e.jsxs("div",{className:"flex-1 sm:w-1/3",children:[e.jsx("span",{className:"block text-xs text-custom-gray-semiDark dark:text-custom-gray-dark sm:hidden",children:"Departamento"}),e.jsx("span",{className:"text-sm text-custom-black dark:text-custom-white font-medium",children:i.nombre})]}),e.jsx("div",{className:"flex-1 sm:w-1/3 sm:text-center",children:e.jsxs("span",{className:"text-sm text-custom-black dark:text-custom-white opacity-70",children:[i.contratosVigentes.length," Usuarios"]})}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 sm:w-1/3",children:[e.jsx("span",{className:"block text-xs text-custom-gray-semiDark dark:text-custom-gray-dark sm:hidden",children:"Manager:"}),e.jsx("img",{src:i.manager.user.profile_photo_url,alt:i.manager.user.name,className:"w-8 h-8 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-sm text-custom-black dark:text-custom-white opacity-70 truncate",children:i.manager.nombreCompleto})]})]})}const t=({center:i})=>e.jsxs("div",{className:"bg-custom-white dark:bg-custom-blackLight border border-custom-gray-semiLight dark:border-custom-gray-semiDark space-y-3 p-4 m-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{name:"MapPin",className:"w-4 h-4 mt-0.5 flex-shrink-0 text-custom-blue dark:text-custom-orange"}),e.jsx("h1",{className:"font-bold text-base text-custom-black dark:text-custom-white",children:i.nombre})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{name:"Map",className:"w-4 h-4 mt-0.5 flex-shrink-0 text-custom-blue dark:text-custom-orange"}),e.jsx("p",{className:"text-sm text-custom-black dark:text-custom-white opacity-80 leading-relaxed",children:i.direccion.full_address})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{name:"Phone",className:"w-4 h-4 flex-shrink-0 text-custom-blue dark:text-custom-orange"}),e.jsx("p",{className:"text-sm text-custom-black dark:text-custom-white opacity-80",children:i.telefono})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{name:"Activity",className:"w-4 h-4 flex-shrink-0 text-custom-blue dark:text-custom-orange"}),e.jsx(J,{identifier:i.estado.nombre,children:i.estado.nombre,mapColor:O,size:"text-xs",textClassName:"font-medium"})]})]}),l=({centro:i})=>e.jsxs(Y,{children:[e.jsx(xe,{asChild:!0,children:e.jsxs(ye,{variant:"secondary",className:"rounded-full bg-custom-gray-default dark:bg-custom-blackSemi hover:bg-custom-gray-semiLight dark:hover:bg-custom-gray-semiDark transition-colors",children:[e.jsx(k,{name:"MapPin",className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"Ver en mapa"})]})}),e.jsx(X,{className:"max-w-[95vw] w-full sm:max-w-[1025px] h-[90vh] sm:h-[625px] bg-custom-white dark:bg-custom-blackLight p-0",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[e.jsx("div",{className:"lg:col-span-2 order-2 lg:order-1",children:e.jsx("div",{className:"rounded-xl overflow-hidden max-w-full h-[500px] sm:h-fit sm:min-h-[300px] sm:max-h-[550px]",children:e.jsx(De,{centers:[i],center:{lat:i.direccion.latitud,lng:i.direccion.longitud},zoom:15})})}),e.jsxs("div",{className:"lg:col-span-1 order-1 lg:order-2 overflow-auto",children:[e.jsx(Q,{className:"pb-4",children:e.jsx(W,{className:"text-lg font-semibold text-custom-blue dark:text-custom-white",children:"Información del Centro"})}),e.jsx("div",{className:"overflow-auto",children:e.jsx(t,{center:i})})]})]})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{title:"Información",children:e.jsxs("div",{className:"rounded-3xl overflow-auto border-4 border-custom-gray-default dark:border-custom-blackSemi",children:[e.jsx(s,{title:"Nombre",value:r.nombre}),e.jsx(s,{title:"Empresa",value:(o=r.empresa)==null?void 0:o.nombre}),e.jsx(s,{title:"Responsable",value:r.responsable.nombreCompleto}),e.jsx(s,{title:"Coordinador",value:r.coordinador.nombreCompleto}),e.jsx(s,{title:"Estado",value:e.jsx(J,{identifier:r.estado.nombre,children:r.estado.nombre,mapColor:O,size:"text-xs",textClassName:"font-medium"})}),e.jsx(s,{title:"Dirección",value:e.jsx("span",{className:"break-words",children:r.direccion.full_address})}),e.jsx(s,{title:"Teléfono",value:r.telefono}),e.jsx(s,{title:"Email",value:e.jsx("span",{className:"break-all",children:r.email})})]})}),e.jsx(G,{title:`Departamentos (${r.departamentos.length})`,children:r.departamentos.length>0?e.jsxs("div",{className:"rounded-xl overflow-hidden border border-custom-gray-default dark:border-custom-blackSemi",children:[e.jsxs("div",{className:"hidden sm:flex items-center px-4 py-3 text-custom-black dark:text-custom-white bg-custom-gray-default dark:bg-custom-blackSemi",children:[e.jsx("div",{className:"w-1/3",children:e.jsx("span",{className:"text-sm font-semibold",children:"Departamento"})}),e.jsx("div",{className:"w-1/3 text-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Usuarios"})}),e.jsx("div",{className:"w-1/3",children:e.jsx("span",{className:"text-sm font-semibold",children:"Manager"})})]}),e.jsx("div",{className:"divide-y divide-custom-gray-semiLight dark:divide-custom-gray-semiDark",children:r.departamentos.map((i,g)=>e.jsx(a,{department:i},i.id||g))})]}):e.jsxs("div",{className:"flex items-center gap-2 p-4 text-custom-gray-semiDark dark:text-custom-gray-dark",children:[e.jsx(k,{name:"AlertTriangle",size:"16"}),e.jsx("span",{className:"text-sm",children:"No hay departamentos asignados"})]})}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(l,{centro:r})})]})}function Re(){return e.jsxs("div",{className:"flex flex-col w-full space-y-8",children:[e.jsxs("div",{className:"w-full flex items-center space-x-4",children:[e.jsx(u,{className:"h-24 w-24 rounded-full"}),e.jsxs("div",{className:"flex flex-col justify-center space-y-2",children:[e.jsx(u,{className:"h-4 w-[250px]"}),e.jsx(u,{className:"h-4 w-[200px]"})]})]}),e.jsx(u,{className:"h-20 w-full"}),e.jsx(u,{className:"h-96 w-full"})]})}function ze({open:r,onOpenChange:s,model:a,enableToView:t=!0}){const l=L(a),[o,i]=c.useState(null),[g,x]=c.useState(!0),[f,n]=c.useState(!1);return c.useEffect(()=>((async()=>{try{x(!0);const b=await axios.get(l.show);b.status===200?i(b.data.centro):n(!0)}catch{n(!0)}finally{x(!1)}})(),()=>{}),[a]),g||!t?e.jsx(B,{title:null,open:r,onOpenChange:s,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx("div",{className:"flex items-center justify-center w-full h-full mt-6",children:e.jsx(Re,{})})}):e.jsx(B,{title:null,open:r,onOpenChange:s,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx(e.Fragment,{children:o&&e.jsx(e.Fragment,{children:e.jsx(He,{data:o})})})})}function Be({open:r,onOpenChange:s,model:a,onDelete:t}){const l=L(a),o=async()=>{try{(await te.delete(l.delete)).status===200&&(t&&t(a),E.success("Registro eliminado correctamente"))}catch(i){console.error("error :>> ",i),E.error("Error al eliminar el registro")}};return e.jsx(Se,{title:"¿Estás seguro de que quieres eliminar este centro?",content:"Esta acción no se puede deshacer. Todos los datos relacionados con este centro se eliminarán.",open:r,onOpenChange:s,action:o,variant:"destructive",icon:e.jsx(k,{name:"OctagonAlert",className:"w-6 h-6 text-red-500"})})}function Ge(){return e.jsxs(e.Fragment,{children:[e.jsx(re,{title:"Administración de centros"}),e.jsx("div",{className:"max-w-full mx-auto py-7 xl:px-8 px-4 overflow-hidden",children:e.jsx(le,{CreateUpdateViewComponent:Me,SheetTableViewComponent:ze,DeleteViewComponent:Be,children:e.jsxs(ie,{children:[e.jsx(ne,{}),e.jsx(oe,{}),e.jsx(ce,{}),e.jsx(de,{})]})})})]})}Ge.layout=r=>e.jsx(ae,{children:r});export{Ge as default};
