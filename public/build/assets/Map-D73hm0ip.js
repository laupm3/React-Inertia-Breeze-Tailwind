import{j as c,r as o}from"./app-fwyInB3c.js";import{A as T,u as M,b as _,M as q}from"./index.modern-WcJlzckG.js";import{I as N}from"./input-CqlBlYgU.js";import"./popover-DaRbHQOK.js";const O="AIzaSyDO1l2WVxOvve3sR8uYJ4989hI8Y_tze-A";function V({children:u}){return c.jsx(T,{apiKey:O,children:u})}const Z=({onPlaceSelect:u,selectedAddress:h=""})=>{const p=M(),s=_("places"),k=o.useRef(null),a=o.useRef(null),[i,E]=o.useState(),[b,x]=o.useState(null),[m,I]=o.useState(null),[f,g]=o.useState([]),[L,l]=o.useState(!1),[A,w]=o.useState("");o.useEffect(()=>{if(!(!s||!p))return x(new s.AutocompleteService),I(new s.PlacesService(p)),E(new s.AutocompleteSessionToken),()=>x(null)},[p,s]),o.useEffect(()=>{w(h)},[h]);const v=o.useCallback(()=>{l(!1),g([])},[]);o.useEffect(()=>{const e=d=>{a.current&&!a.current.contains(d.target)&&v()},n=d=>{const y=d.target||d.currentTarget;if(a.current&&!a.current.contains(y)){const C=a.current.querySelector(".absolute");(!C||!C.contains(y))&&v()}},r=d=>{d.key==="Escape"&&v()};document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),document.addEventListener("scroll",n,!0),document.addEventListener("keydown",r);const t=document.querySelector('[role="dialog"]');return t&&t.addEventListener("scroll",n,!0),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e),document.removeEventListener("scroll",n,!0),document.removeEventListener("keydown",r),t&&t.removeEventListener("scroll",n,!0)}},[v]);const S=o.useCallback(async e=>{if(!b||!e){g([]),l(!1);return}const n={input:e,sessionToken:i},r=await b.getPlacePredictions(n);g(r.predictions),l(r.predictions.length>0)},[b,i]),P=o.useCallback(e=>{var r;const n=((r=e.target)==null?void 0:r.value)||"";w(n),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{S(n),n.trim()===""&&(u({full_address:"",latitud:null,longitud:null}),l(!1))},400)},[S,u]),j=o.useCallback(()=>{f.length>0&&l(!0)},[f.length]),R=o.useCallback(e=>{if(!s)return;const n={placeId:e,fields:["geometry","name","formatted_address"],sessionToken:i},r=t=>{u({full_address:t==null?void 0:t.formatted_address,latitud:t==null?void 0:t.geometry.location.lat(),longitud:t==null?void 0:t.geometry.location.lng()}),g([]),l(!1),w((t==null?void 0:t.formatted_address)??""),E(new s.AutocompleteSessionToken)};m==null||m.getDetails(n,r)},[u,s,m,i]);return c.jsxs("div",{className:"autocomplete-container relative w-full",ref:a,children:[c.jsx(N,{value:A,autoFocus:!0,onInput:e=>P(e),onFocus:j,placeholder:"Busca una direcciÃ³n...",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi w-full text-sm"}),L&&f.length>0&&c.jsx("div",{className:"absolute bg-custom-white dark:bg-custom-blackLight border border-gray-300 shadow-lg z-[9999] w-full max-h-60 overflow-y-auto mt-2 rounded-xl",onScroll:e=>e.stopPropagation(),onTouchMove:e=>e.stopPropagation(),children:c.jsx("ul",{children:f.map(({place_id:e,description:n})=>c.jsx("li",{className:"hover:bg-custom-gray-default p-2 cursor-pointer dark:hover:text-custom-blackSemi text-left px-2.5",onClick:()=>R(e),children:n},e))})})]})};function $({defaultZoom:u=3,defaultCenter:h={lat:22.54992,lng:0}}){return c.jsx(q,{defaultZoom:3,defaultCenter:{lat:22.54992,lng:0},gestureHandling:"greedy",disableDefaultUI:!0})}export{V as A,$ as M,Z as a};
