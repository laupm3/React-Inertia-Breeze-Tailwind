import{j as e,r as h}from"./app-fwyInB3c.js";import{b as $,D as z}from"./dialog-iaZkf6Xy.js";import"./avatar-oBOSifLN.js";import"./tooltip-DFfoxvAF.js";import{u as p,D as T}from"./DataHandlerContext--vx6a3_3.js";import{g as O,j as F,k as N,f as M}from"./format-Be40hyfq.js";import R from"./WeekDay-C1ZcXS4Y.js";import{C as v}from"./calendar-k1x2vwx8.js";import{g as H}from"./getRoundingMethod-D0I6Z7xl.js";import{t as b}from"./toDate-qOSwr3PX.js";import{b as k,c as w,d as D,a as C}from"./constants-BKFt95HM.js";import{e as A}from"./es-DNLwfvrq.js";import{p as _}from"./parseISO-Efi0RkWR.js";import{O as P}from"./octagon-alert-BRAzZNeG.js";function V(s,l){const r=b(s),c=b(l),i=r.getTime()-c.getTime();return i<0?-1:i>0?1:i}function W(s,l,r){const c=O(),i=(r==null?void 0:r.locale)??c.locale??F,o=V(s,l);if(isNaN(o))throw new RangeError("Invalid time value");const m=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let u,a;o>0?(u=b(l),a=b(s)):(u=b(s),a=b(l));const d=H((r==null?void 0:r.roundingMethod)??"round"),y=a.getTime()-u.getTime(),g=y/C,j=N(a)-N(u),x=(y-j)/C,f=r==null?void 0:r.unit;let t;if(f?t=f:g<1?t="second":g<60?t="minute":g<k?t="hour":x<w?t="day":x<D?t="month":t="year",t==="second"){const n=d(y/1e3);return i.formatDistance("xSeconds",n,m)}else if(t==="minute"){const n=d(g);return i.formatDistance("xMinutes",n,m)}else if(t==="hour"){const n=d(g/60);return i.formatDistance("xHours",n,m)}else if(t==="day"){const n=d(x/k);return i.formatDistance("xDays",n,m)}else if(t==="month"){const n=d(x/w);return n===12&&f!=="month"?i.formatDistance("xYears",1,m):i.formatDistance("xMonths",n,m)}else{const n=d(x/D);return i.formatDistance("xYears",n,m)}}function Y(){return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-64 max-h-[370px] overflow-y-auto dark:dark-scrollbar",children:e.jsx("div",{className:"animate-pulse",children:[...Array(3)].map((s,l)=>e.jsxs("div",{className:"relative flex flex-col items-start pb-6",children:[l<2&&e.jsx("div",{className:"w-1 bg-gray-300 dark:bg-gray-700 absolute ml-2 h-full"}),e.jsxs("div",{className:"flex flex-row items-start gap-3",children:[e.jsx("div",{className:"min-w-5 min-h-5 rounded-full z-10 bg-gray-300 dark:bg-gray-700 border-4 border-gray-300 dark:border-gray-700"}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-28"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-20"})]})]}),l===0&&e.jsx("div",{className:"flex flex-col pt-2",children:e.jsxs("div",{className:"flex flex-row items-start gap-3",children:[e.jsx("div",{className:"min-w-5 min-h-5 rounded-full z-10 bg-gray-300 dark:bg-gray-700 border-4 border-gray-300 dark:border-gray-700"}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-16"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-16"})]})]})})]},l))})}),e.jsx("div",{className:"border-4 border-custom-gray-default p-4 rounded-xl flex-1",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("div",{className:"h-5 bg-gray-300 dark:bg-gray-700 rounded w-32"}),e.jsx("div",{className:"h-5 bg-gray-300 dark:bg-gray-700 rounded w-4"}),e.jsx("div",{className:"h-5 bg-gray-300 dark:bg-gray-700 rounded w-40"})]}),e.jsxs("div",{className:"lg:grid lg:grid-cols-2 gap-5 space-y-3 lg:space-y-0",children:[e.jsxs("div",{className:"bg-custom-gray-default p-6 rounded-xl space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-28"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-36"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-20"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-16"})]})]}),e.jsxs("div",{className:"bg-custom-gray-default p-5 rounded-xl space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-28"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 bg-gray-300 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-20"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-36"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 bg-gray-300 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-16"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-5 bg-gray-300 dark:bg-gray-700 rounded w-16 mb-2"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:[...Array(5)].map((s,l)=>e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"h-full min-h-full w-[10px] min-w-[10px] bg-gray-300 dark:bg-gray-700 rounded-ss-xl rounded-es-xl"}),e.jsxs("div",{className:"flex flex-col flex-1 py-2 px-3 bg-custom-gray-default dark:bg-custom-blackSemi rounded-ee-xl rounded-se-xl gap-1 max-w-[12rem] min-w-[12rem]",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-16"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-4 w-4 bg-gray-300 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-12"}),e.jsx("div",{className:"h-4 w-4 bg-gray-300 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-12"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-4 w-4 bg-gray-300 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-20"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-4"}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-700 rounded w-16"})]})]})]},l))})]})]})})]})}function B({data:s=[],onItemClick:l}){const[r,c]=h.useState(null);h.useEffect(()=>{s&&s.length>0&&!r&&(c("0"),l(s[0]))},[s,l,r]);const i=h.useCallback(a=>{if(!a)return"Sin fecha";try{return M(new Date(a),"dd/MM/yyyy")}catch{return a}},[]),o=h.useCallback((a,d)=>{r!==d&&(c(d),l(a))},[r,l]),m=h.useCallback(a=>r?r.startsWith(a.toString()):!1,[r]);return h.useMemo(()=>s&&s.length>0,[s])?e.jsx("div",{children:s.map((a,d)=>{var j;const y=a.is_vigente,g=m(d);return e.jsxs("div",{className:"relative flex flex-col items-start hover:cursor-pointer pb-6",children:[(d<s.length-1||a.anexos&&a.anexos.length>0)&&e.jsx("div",{className:"w-1 bg-custom-gray-semiLight absolute ml-2",style:{height:d===s.length-1&&a.anexos&&a.anexos.length>0?`calc(${a.anexos.length*40}px + 10px)`:"100%"}}),e.jsxs("div",{className:"flex flex-row items-start gap-3",onClick:()=>o(a,d.toString()),children:[e.jsx("div",{className:`min-w-5 min-h-5 rounded-full z-10
                                ${y?"bg-custom-orange border-4 border-custom-orange":"bg-custom-gray-semiLight border-4 border-custom-gray-semiLight"}
                                ${r==d.toString()||g?"border-custom-orange bg-custom-orange":""}
                            `}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs sm:text-sm font-bold",children:((j=a.asignacion)==null?void 0:j.nombre)||"Sin nombre"}),e.jsxs("p",{className:"text-xs",children:["(",i(a.fechaInicio),")"]})]})]}),h.useMemo(()=>!a.anexos||!Array.isArray(a.anexos)||a.anexos.length===0?null:e.jsx("div",{className:"flex flex-col",children:a.anexos.map((x,f)=>{const t=`${d}-${f}`,n=x.is_vigente,E={...x,asignacion:{...a.asignacion,nombre:`Anexo ${f+1}`},tipo_contrato:a.tipo_contrato||a.tipoContrato,departamento:a.departamento,centro:a.centro,empresa:a.empresa};return e.jsx("div",{className:"pt-2",onClick:L=>{L.stopPropagation(),o(E,t)},children:e.jsxs("div",{className:"flex flex-row items-start gap-3",children:[e.jsx("div",{className:`min-w-5 min-h-5 rounded-full z-10
                                                        ${n?"bg-custom-orange border-4 border-custom-orange":"bg-custom-gray-semiLight border-4 border-custom-gray-semiLight"}
                                                        ${r===t?"border-custom-orange bg-custom-orange":""}
                                                        ${g&&r!==t?"border-custom-orange bg-custom-gray-semiLight":""}
                                                    `}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-bold",children:`Anexo ${f+1}`}),e.jsxs("p",{className:"text-xs",children:["(",i(x.fechaInicio),")"]})]})]})},t)})}),[a.anexos,a.asignacion,a.tipo_contrato,a.tipoContrato,a.departamento,a.centro,a.empresa,d,i,o,r,g])]},d)})}):e.jsx("div",{className:"text-center py-4",children:"No hay contratos disponibles"})}function U({contrato:s}){var l,r,c,i;return e.jsxs("div",{className:"border-4 border-custom-gray-default p-4 rounded-xl flex-1",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2 text-base sm:text-md",children:[e.jsx("span",{className:"text-custom-orange font-bold",children:((l=s.asignacion)==null?void 0:l.nombre)||"Asignación no especificada"}),e.jsx("span",{className:"text-custom-blackLight dark:text-custom-white",children:"|"}),e.jsx("span",{className:"text-custom-blackLight dark:text-custom-white",children:((r=s.asignacion)==null?void 0:r.n_expediente)||"Nº Expediente no especificado"})]}),e.jsxs("div",{className:"lg:grid lg:grid-cols-2 gap-5 space-y-3 lg:space-y-0",children:[e.jsxs("div",{className:"bg-custom-gray-default p-6 rounded-xl",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-custom-blackSemi font-bold",children:"Tipo de contrato"}),e.jsx("p",{className:"text-custom-blackSemi",children:((c=s.tipo_contrato)==null?void 0:c.nombre)||((i=s.tipoContrato)==null?void 0:i.nombre)||"Tipo de contrato no especificado"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-custom-blackSemi font-bold",children:"Antigüedad"}),e.jsx("p",{className:"text-custom-blackSemi",children:q(s.fechaInicio)})]})]}),e.jsxs("div",{className:"bg-custom-gray-default p-5 rounded-xl",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-custom-blackSemi font-bold",children:"Fecha de inicio"}),e.jsxs("p",{className:"text-custom-blackSemi flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),S(s.fechaInicio)]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-custom-blackSemi font-bold",children:"Fecha de finalización"}),e.jsxs("p",{className:"text-custom-blackSemi flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),S(s.fechaFin)||"En vigor"]})]})]})]})]}),s.jornada&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-custom-blue dark:text-white font-bold my-2",children:"Jornadas"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.jornada.esquema.map((o,m)=>{const u=J(o);return u?e.jsx(R,{weekday:u},m):null}).filter(Boolean)})]})]})}function q(s){if(!s)return null;try{const l=typeof s=="string"?_(s):s;return W(new Date,l,{locale:A,addSuffix:!1,unit:"day",roundingMethod:"floor"})}catch(l){return console.error("Error al calcular antigüedad:",l),null}}const S=(s,l="dd/MM/yyyy")=>{if(!s)return"En vigor";const r=typeof s=="string"?_(s):s;try{return M(r,l,{locale:A})}catch{return typeof s=="string"?s:"Formato inválido"}},J=s=>({weekday_name:s.weekday_name,turno:{horaInicio:s.turno.hora_inicio||s.turno.horaInicio,horaFin:s.turno.hora_fin||s.turno.horaFin,color:s.turno.color},modalidad:s.modalidad,centro:s.turno.centro});function G(){const{data:s={}}=p(),{contratos:l=[]}=s,[r,c]=h.useState(l[0]??null),i=o=>c(o);return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-64 max-h-[370px] overflow-y-auto dark:dark-scrollbar",children:e.jsx(B,{data:l,onItemClick:i})}),r?e.jsx(U,{contrato:r}):e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 bg-custom-gray-default rounded-xl",children:e.jsx("p",{className:"text-custom-blackSemi dark:text-custom-white",children:"No hay contratos disponibles para mostrar."})})]})}const I=()=>{const{error:s}=p();return s?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(P,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo obtener la información del empleado. Por favor, intentelo más tarde."})]})]}):null};function K(){const{isLoading:s,error:l}=p();return e.jsx($,{className:"flex flex-col gap-4 justify-between max-w-[1225px] h-[725px] bg-custom-white dark:bg-custom-blackLight",children:s?e.jsx(Y,{}):e.jsx("div",{className:"flex flex-col gap-4 flex-1 overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200",children:l?e.jsx(I,{}):e.jsx(G,{})})})}function me({open:s,onOpenChange:l,model:r}){return e.jsx(z,{open:s,onOpenChange:l,children:e.jsx(T,{model:r,onOpenChange:l,children:e.jsx(K,{})})})}export{me as C};
