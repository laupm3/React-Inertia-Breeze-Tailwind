const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-WlsBA3k2.js","assets/app-fwyInB3c.js","assets/app-CrPud50x.css"])))=>i.map(i=>d[i]);
import{X as U,j as e,x as P,A as ye,r as l,a as ve,_ as L,c as Q,l as xe,i as ke,G as Se,S as _e}from"./app-fwyInB3c.js";import{u as M,S as Ce,a as G,b as J,c as F,d as Y,e as q,f as V,g as Te,h as Ee,i as Pe,j as De}from"./sidebar-CPh6C6LB.js";import{c as Ae}from"./sheet-DHc5Hgr8.js";import{D as he,a as fe,b as pe,c as E,e as K,f as Z,g as ee,h as se}from"./dropdown-menu-bHoOJ61X.js";import{I as x}from"./LucideIcon-CEqEhMjI.js";import{P as te,a as ae,b as re}from"./popover-DaRbHQOK.js";import{S as ne}from"./skeleton-DSiYFg9q.js";import{T as Le,a as oe,b as ie,c as le}from"./tooltip-DFfoxvAF.js";import{A as Fe,a as Me,b as Ie}from"./avatar-oBOSifLN.js";import{P as ze}from"./PopUpIncidencias-CaovAEi3.js";import{U as Re}from"./UserAvatar-cKyxDEhx.js";import{A as ce}from"./ApplicationLogo-C2FcO4AY.js";import{V as $e}from"./Yoopta-Dj4Guze5.js";import{toast as C,Toaster as Oe}from"./index-WlsBA3k2.js";import{u as H}from"./useTranslation-BtIkv0Na.js";import{P as Be}from"./PrimaryButton-SsXyLm2e.js";import{D as X}from"./DecisionModal-Dl8siGBG.js";import{u as ge}from"./useNotifications-CSWGH93r.js";import{z as qe,S as Ve}from"./ShowNotificactionFromJestream-cKOlvVdg.js";import{B as A}from"./Button-CQuYVLGu.js";import Ue from"./OnboardingModal-D0HRNKzO.js";function He(){const{auth:{user:r},jetstream:s}=U().props,{isMobile:i}=M(),{current_team:c}=r,j=(p,f)=>{p.preventDefault(),ye.put(route("current-team.update"),{team_id:f.id})};return e.jsx(Ce,{className:`bg-custom-gray-default dark:bg-custom-blackSemi shadow-2xl ${i?"rounded-tl-2xl":"rounded-tr-2xl"}`,children:e.jsx(G,{children:e.jsx(J,{children:e.jsxs(he,{children:[s.hasTeamFeatures&&e.jsx(fe,{asChild:!0,children:e.jsxs(F,{className:"rounded-xl font-bold truncate",children:[e.jsx("div",{className:"rounded p-1 flex items-center justify-center",style:{backgroundColor:c.bg_color},children:e.jsx(x,{name:c.icon,color:c.icon_color,size:16})}),r.current_team.name,e.jsx(x,{name:i?"ChevronDown":"ChevronRight",className:"ml-auto text-custom-orange"})]})}),e.jsxs(pe,{side:i?"":"left",className:`${i?"mt-10":"ml-4"} w-[--radix-popper-anchor-width] rounded-xl bg-custom-gray-default dark:bg-custom-blackLight`,children:[e.jsx(Y,{children:"Manage Teams"}),s.canCreateTeams&&e.jsx(E,{children:e.jsx(P,{href:route("teams.create"),children:"Create New Team"})}),e.jsx(Y,{children:"Switch Teams"}),r.all_teams.map(p=>e.jsx(E,{onClick:f=>j(f,p),children:e.jsxs("div",{className:"flex items-center",children:[r.current_team_id===p.id&&e.jsx("svg",{className:"me-2 h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("div",{children:p.name})]})},p.id))]})]})})})})}function Ge(){const{state:r}=M(),s=r==="collapsed",i=()=>e.jsxs("div",{className:`rounded-xl h-8 flex gap-2 px-2 items-center w-full ${s?"justify-center":""}`,children:[e.jsx(ne,{className:"size-4 rounded-md flex-shrink-0 bg-gray-300 dark:bg-gray-600"}),!s&&e.jsx(ne,{className:"h-4 flex-1 rounded-md bg-gray-300 dark:bg-gray-600",style:{width:`${Math.floor(Math.random()*40)+50}%`,maxWidth:"70%"}})]});return e.jsx(q,{children:e.jsx(V,{children:e.jsx(G,{children:Array.from({length:7}).map((c,j)=>e.jsx(J,{className:"pt-4",children:e.jsx(i,{})},`skeleton-${j}`))})})})}const Je=()=>{const[r,s]=l.useState(!0),[i,c]=l.useState(null),[j,p]=l.useState([]),f=async()=>{try{s(!0),c(null);const w=await ve.get("/api/v1/user/navigation");if(w.data&&w.data.links)p(w.data.links);else throw new Error("No se pudieron cargar los datos de navegaciÃ³n")}catch(w){console.error("Error al obtener la navegaciÃ³n:",w),c(w.message||"Error al cargar la navegaciÃ³n");try{const k=(await L(async()=>{const{default:a}=await import("./ContentOneItems-Xn0bxxoU.js");return{default:a}},[])).default,_=(await L(async()=>{const{default:a}=await import("./ContentTwoItems-7ZHJvACM.js");return{default:a}},[])).default,S=[...k,..._.map(a=>({...a,isAdmin:!0}))];p(S)}catch(k){console.error("Error al cargar elementos fallback:",k),p([])}}finally{s(!1)}};return l.useEffect(()=>{f()},[]),{isLoading:r,error:i,links:j,refreshNavigation:()=>{f()}}},R=r=>{try{return!r||typeof r!="string"?!1:typeof window<"u"&&window.route&&window.route.list?window.route.list().includes(r):(route(r),!0)}catch{return!1}},de=(r,s="#")=>{if(!r||!R(r))return s;try{return route(r)}catch{return s}};function We(){const[r,s]=l.useState([]),[i,c]=l.useState({}),j=l.useRef(null),{isLoading:p,error:f,links:v,refreshNavigation:w}=Je(),{isMobile:k,state:_}=M(),S=_==="collapsed";l.useEffect(()=>{if(k&&j.current){const t=j.current,u=n=>{n.stopPropagation()};return t.addEventListener("wheel",u,{passive:!0}),t.addEventListener("touchmove",u,{passive:!0}),t.addEventListener("scroll",u,{passive:!0}),()=>{t.removeEventListener("wheel",u),t.removeEventListener("touchmove",u),t.removeEventListener("scroll",u)}}},[k]);const a=t=>S&&!k?t.name||t.title||"":!S&&t.description?t.description:"",N=t=>{const u=a(t);return u&&u.trim()!==""&&!k&&(S||!S&&t.description)},g=({children:t,content:u,disabled:n=!1,side:h="right"})=>n||!u||u.trim()===""||k?t:e.jsxs(oe,{delayDuration:700,children:[e.jsx(ie,{asChild:!0,children:t}),Q.createPortal(e.jsx(le,{side:h,align:"center",sideOffset:8,className:"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",children:u}),document.body)]}),b=({item:t,children:u})=>{const n=a(t);return N(t)?e.jsxs(oe,{delayDuration:700,children:[e.jsx(ie,{asChild:!0,children:e.jsx("div",{className:"w-full",children:u})}),e.jsx(le,{side:"right",align:"center",sideOffset:8,className:"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",children:n})]}):u},o=t=>{c(u=>({...u,[t]:!u[t]}))},d=t=>!t.children||!Array.isArray(t.children)||t.children.length===0?!1:t.children.some(u=>!!(u.route_name&&R(u.route_name)||d(u))),m=t=>!!(t.route_name&&R(t.route_name)||d(t));l.useEffect(()=>{if(!p&&!f&&v.length>0){const t=v.filter(u=>!u.parent_id&&m(u));s(t)}},[p,f,v]);const y=(t,u=1)=>{if(!t||t.length===0)return null;const n=t.filter(h=>m(h));return n.length===0?null:e.jsx("div",{className:"flex flex-col space-y-1",children:n.map(h=>d(h)?k?e.jsxs("div",{children:[e.jsxs("button",{className:"flex items-center w-full px-4 py-2 text-sm rounded-xl hover:bg-custom-white dark:hover:bg-custom-blackLight",onClick:()=>o(`${h.id}-${u}`),children:[e.jsx(x,{name:h.icon||"Folder",className:"mr-2 h-4 w-4 text-custom-orange"}),h.name,e.jsx(x,{name:i[`${h.id}-${u}`]?"ChevronDown":"ChevronRight",size:"14",className:"ml-auto text-custom-orange"})]}),i[`${h.id}-${u}`]&&e.jsx("div",{className:"ml-4 mt-1 space-y-1",children:y(h.children,u+1)})]},h.id):e.jsxs(te,{modal:!1,children:[e.jsx(ae,{asChild:!0,children:e.jsxs("button",{className:"flex items-center w-full px-4 py-2 text-sm rounded-xl hover:bg-custom-white dark:hover:bg-custom-blackLight",children:[e.jsx(x,{name:h.icon||"Folder",className:"mr-2 h-4 w-4 text-custom-orange"}),h.name,e.jsx(x,{name:"ChevronRight",size:"14",className:"ml-auto text-custom-orange"})]})}),e.jsx(re,{side:"right",align:"start",className:"rounded-lg bg-custom-gray-default dark:bg-custom-blackSemi shadow-xl p-2 ml-2",onPointerDownCapture:I=>I.stopPropagation(),onTouchStart:I=>I.stopPropagation(),children:y(h.children,u+1)})]},h.id):h.route_name&&R(h.route_name)?e.jsxs(P,{href:de(h.route_name),className:"flex items-center px-4 py-2 text-sm rounded-xl hover:bg-custom-white dark:hover:bg-custom-blackLight",children:[e.jsx(x,{name:h.icon||"Link",className:"mr-2 h-4 w-4 text-custom-orange"}),h.name]},h.id):null)})};return e.jsx(Le,{children:e.jsxs(Te,{className:"bg-custom-gray-default dark:bg-custom-blackSemi !overflow-y-auto no-scrollbar touch-pan-y",children:[p&&e.jsx(Ge,{}),f&&e.jsx(q,{children:e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 px-2",children:[e.jsx(x,{name:"AlertCircle",className:"h-4 w-4 text-red-500 mb-2"}),e.jsx("span",{className:"text-xs text-red-500 text-center",children:"Error al cargar navegaciÃ³n"}),e.jsx("button",{onClick:w,className:"mt-2 text-xs text-custom-orange hover:underline",children:"Reintentar"})]})})}),!p&&r.length>0&&e.jsx(q,{children:e.jsx(V,{children:e.jsx(G,{children:r.map((t,u)=>{const n=d(t);return e.jsx(J,{className:"pt-4",children:n?k?e.jsxs("div",{children:[e.jsxs(F,{className:"rounded-xl w-full flex items-center justify-between",onClick:()=>o(t.id),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{name:t.icon||"Link",className:"text-custom-orange h-5 w-5 flex-shrink-0 mr-2"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:t.name})]}),e.jsx(x,{name:i[t.id]?"ChevronDown":"ChevronRight",className:"ml-auto text-custom-orange"})]}),i[t.id]&&e.jsx("div",{className:"mt-2 ml-4 space-y-1",children:y(t.children)})]}):e.jsx(b,{item:t,children:e.jsxs(te,{modal:!1,children:[e.jsx(ae,{asChild:!0,children:e.jsxs(F,{className:"rounded-xl w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(x,{name:t.icon||"Link",className:"text-custom-orange h-5 w-5 flex-shrink-0 mr-2"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:t.name})]}),e.jsx(x,{name:"ChevronRight",className:"ml-auto text-custom-orange"})]})}),e.jsx(re,{side:"right",align:"start",className:"rounded-lg bg-custom-gray-default dark:bg-custom-blackSemi shadow-xl p-2",onPointerDownCapture:h=>h.stopPropagation(),onTouchStart:h=>h.stopPropagation(),children:y(t.children)})]})}):t.route_name&&R(t.route_name)?e.jsx(g,{content:a(t),disabled:!N(t),children:e.jsx(F,{asChild:!0,className:"rounded-xl",children:e.jsx(P,{href:de(t.route_name),children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(x,{name:t.icon||"Link",className:"text-custom-orange h-5 w-5 flex-shrink-0 mr-2"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:t.name})]})})})}):e.jsx(g,{content:a(t),disabled:!N(t),children:e.jsx(F,{className:"rounded-xl cursor-default",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(x,{name:t.icon||"Link",className:"text-custom-orange h-5 w-5 flex-shrink-0 mr-2"}),e.jsx("span",{className:"ml-2 font-medium truncate",children:t.name})]})})})},`${t.name}-${u}`)})})})}),!p&&!f&&r.length===0&&e.jsx(q,{children:e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-4 px-2",children:[e.jsx(x,{name:"Lock",className:"h-4 w-4 text-gray-400 mb-2"}),e.jsx("span",{className:"text-xs text-gray-500 text-center",children:"Sin elementos disponibles"})]})})})]})})}function Qe(){const{isMobile:r}=M(),s=U().props.auth.user,i=U().props.jetstream,[c,j]=l.useState("system"),[p,f]=l.useState(!1);l.useEffect(()=>{const a=localStorage.getItem("theme");if(a&&a!=="system")j(a),v(a);else{const b=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"default";j(b),v(b)}const N=window.matchMedia("(prefers-color-scheme: dark)"),g=b=>{if(c==="system"){const o=b.matches?"dark":"default";j(o),v(o)}};return N.addEventListener("change",g),()=>{N.removeEventListener("change",g)}},[]);const v=a=>{a==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},w=a=>{a==="system"?localStorage.removeItem("theme"):localStorage.setItem("theme",a),j(a),v(a)},k=a=>{ke.changeLanguage(a)},_=()=>{l.startTransition(()=>{f(a=>!a)})},S=()=>{_()};return e.jsx(Ee,{className:`bg-custom-gray-default dark:bg-custom-blackSemi shadow-2xl ${r?"rounded-bl-2xl":"rounded-br-2xl"}`,children:e.jsxs(G,{children:[e.jsx(F,{asChild:!0,className:"rounded-xl",onClick:S,children:e.jsxs("div",{className:"font-medium",children:[e.jsx(x,{name:"CircleHelp",className:"text-custom-orange"}),"Ayuda"]})}),p&&e.jsx("div",{children:e.jsx(ze,{className:"absolute bottom-20 left-20",onClose:()=>f(!1),formData:{}})}),e.jsx(J,{children:e.jsxs(he,{children:[e.jsx(fe,{asChild:!0,children:e.jsxs(F,{className:"flex rounded-xl font-extrabold",children:[e.jsx(Re,{user:s,className:"-ml-2"}),r?e.jsx(x,{name:"ChevronUp",className:"ml-auto text-custom-orange"}):e.jsx(x,{name:"ChevronRight",className:"ml-auto text-custom-orange"})]})}),e.jsxs(pe,{side:r?"":"left",className:`${r?"mb-12":"ml-4"} w-[--radix-popper-anchor-width] rounded-xl bg-custom-gray-default dark:bg-custom-blackLight`,children:[e.jsx(E,{asChild:!0,className:"rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-sm",children:[e.jsx(Fe,{className:"h-8 w-8 rounded-full",children:i.managesProfilePhotos?e.jsx(Me,{src:s.profile_photo_url,alt:s.name}):e.jsx(Ie,{className:"rounded-lg",children:s.name})}),e.jsxs("div",{className:"rounded-xl grid flex-1 text-left text-sm leading-tight",children:[e.jsx("span",{className:"truncate font-semibold",children:s.name}),e.jsx("span",{className:"truncate text-xs",children:s.email})]})]})}),e.jsx(E,{asChild:!0,className:`rounded-xl ${r?"gap-2":""}`,children:e.jsxs(P,{href:route("profile.show"),children:[e.jsx(x,{name:"User",className:"text-custom-orange"}),"Perfil"]})}),i.hasApiFeatures&&e.jsx(E,{asChild:!0,className:`rounded-xl ${r?"gap-2":""}`,children:e.jsxs(P,{href:route("api-tokens.index"),children:[e.jsx(x,{name:"Settings",className:"text-custom-orange"}),e.jsx("span",{children:"Tokens API"})]})}),e.jsxs(K,{children:[e.jsxs(Z,{className:`rounded-xl ${r?"gap-2":""}`,children:[e.jsx(x,{name:"Languages",className:"text-custom-orange w-4 mr-2"})," ","Idioma"]}),e.jsx(ee,{children:e.jsx(se,{className:`bg-custom-gray-default dark:bg-custom-blackLight ${r?"mr-5":"ml-3"}`,children:xe.map(a=>e.jsx(E,{className:"rounded-xl",onClick:()=>k(a.locale),children:e.jsxs("span",{children:[a.name," (",a.region,")"]})},a.id))})})]}),e.jsxs(K,{children:[e.jsxs(Z,{className:"rounded-xl",children:[e.jsx(x,{name:"Moon",className:"text-custom-orange w-4 h-4 mr-2"})," ",e.jsx("span",{children:"Tema"})]}),e.jsx(ee,{children:e.jsxs(se,{className:`bg-custom-gray-default dark:bg-custom-blackLight ${r?"mr-5":"ml-3"}`,children:[e.jsx(E,{className:"rounded-xl",onClick:()=>w("system"),children:e.jsx("span",{children:"Tema del Sistema"})}),e.jsx(E,{className:"rounded-xl",onClick:()=>w("default"),children:e.jsx("span",{children:"Tema Claro"})}),e.jsx(E,{className:"rounded-xl",onClick:()=>w("dark"),children:e.jsx("span",{children:"Modo Oscuro"})})]})})]}),e.jsx(E,{asChild:!0,className:`rounded-xl w-full ${r?"gap-2":""}`,children:e.jsxs(P,{href:route("logout"),method:"post",as:"button",children:[e.jsx(x,{name:"LogOut",className:"text-custom-orange"}),"Cerrar SesiÃ³n"]})})]})]})})]})})}function Xe(){const{toggleSidebar:r,open:s}=M();return e.jsx("button",{onClick:r,className:`hidden md:block absolute top-1 ${s?"ml-64":"ml-14"} bg-gray-400 hover:bg-gray-500 p-1 rounded-full`,children:s?e.jsx(x,{name:"ChevronLeft",className:"h-5 w-5 text-gray-200"}):e.jsx(x,{name:"ChevronRight",className:"h-5 w-5 text-gray-200"})})}function Ye(){const{open:r,openMobile:s,setOpenMobile:i,isMobile:c}=M();return e.jsxs(Pe,{collapsible:"icon",side:c?"right":"left",className:`shadow-2xl dark:shadow-black rounded-2xl ${r?"w-64":"w-20"}`,open:c?s:r,children:[c&&e.jsx(Ae,{className:"sr-only",children:"MenÃº de navegaciÃ³n"}),e.jsx(Xe,{onClick:()=>c?i(j=>!j):null}),e.jsx(He,{}),e.jsx(We,{}),e.jsx(Qe,{})]})}const Ke=!1;function Ze({notifications:r,unreadCount:s,markAsRead:i,markAllAsRead:c}){const[j,p]=l.useState(r||[]);l.useEffect(()=>{p(r||[])},[r]);const{i18n:f}=H(),{t:v}=H("events"),w=()=>xe.find(n=>f.language===n.locale),k=n=>new Date(n).toLocaleDateString(w().cultural_configuration,{year:"2-digit",month:"long",day:"numeric"}),_=n=>new Date(n).toLocaleTimeString(w().cultural_configuration,{hour:"numeric",minute:"numeric"}),[S,a]=l.useState(!1),[N,g]=l.useState(null),b=l.useRef(null),o=l.useRef(null),d=()=>{a(n=>!n)};l.useEffect(()=>{const n=h=>{b.current&&!b.current.contains(h.target)&&o.current&&!o.current.contains(h.target)&&(a(!1),g(null))};return S&&document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[S]);const m=async n=>{n.is_read||await i(n.id),g({...n,is_read:!0}),a(!0)},y=()=>{g(null)},t=n=>n.charAt(0).toUpperCase(),u=async()=>{try{await c()?(p(h=>h.map(D=>({...D,is_read:!0}))),C.success(v("allNotificationsMarkedAsRead"))):C.error(v("errorMarkingAllAsRead"))}catch{C.error(v("errorMarkingAllAsRead"))}};return e.jsx("nav",{className:"bg-custom-white dark:bg-custom-blackLight",children:e.jsx("div",{className:"container mx-auto flex items-center justify-between",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{ref:o,onClick:d,className:"relative p-2 bg-custom-gray-light dark:bg-custom-gray-darker hover:bg-custom-gray-dark rounded-full focus:outline-none",children:[e.jsx(x,{name:"Bell",className:"text-custom-blackSemi dark:text-white h-4 w-4"}),s>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-[16px] h-[16px] bg-red-500 rounded-full text-white text-[9px] font-bold",children:s>9?"9+":s})]}),S&&!N&&Q.createPortal(e.jsxs("div",{ref:b,className:"fixed top-12 right-12 w-80 bg-custom-gray-default dark:bg-custom-blackSemi shadow-lg rounded-2xl p-4 z-40",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h2",{className:"text-center text-lg font-bold text-custom-orange",children:v("notifications")}),j.some(n=>!n.is_read)&&e.jsx("button",{onClick:u,className:"text-xs text-custom-orange hover:text-custom-gray-darker dark:hover:text-custom-gray-light",children:"Marcar todas como leÃ­das"})]}),j.length>0?e.jsxs(e.Fragment,{children:[e.jsx("ul",{className:"space-y-3 max-h-80 overflow-y-auto no-scrollbar",children:j.slice(0,10).map(n=>e.jsxs("li",{className:`flex items-start space-x-3 p-2 cursor-pointer dark:hover:bg-custom-gray-semiDark hover:bg-custom-gray-light rounded-lg ${n.is_read?"opacity-30":""}`,onClick:()=>m(n),children:[e.jsx("div",{className:"relative flex-shrink-0",children:n.sender.profile_photo_url?e.jsx("img",{src:n.sender.profile_photo_url,alt:n.sender.name,className:"w-10 h-10 rounded-full bg-custom-gray-dark"}):e.jsx("div",{className:"w-10 h-10 bg-custom-white dark:bg-custom-gray-semiDark rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm text-custom-blackLight dark:text-custom-white font-bold",children:t(n.sender.name)})})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-custom-blackLight dark:text-custom-white",children:n.sender.name}),e.jsx("p",{className:"text-[8px] text-custom-gray-darker dark:text-custom-gray-light",children:k(n.sent_at)})]}),n.title&&e.jsx("p",{className:" text-xs line-clamp-2 text-custom-gray-darker dark:text-custom-gray-light",children:n.title})]})]},n.id))}),e.jsx("div",{className:"text-center text-sm mt-2 font-bold pt-3",children:e.jsx(P,{href:route("notifications"),className:"text-custom-orange hover:text-custom-black duration-300",children:v("seeAll")})})]}):e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(x,{name:"BellOff",className:"text-custom-blackSemi dark:text-white h-4 w-4"})})]}),document.body),N&&Q.createPortal(e.jsx("div",{ref:b,className:"fixed top-12 right-12 w-80 bg-custom-gray-default dark:bg-custom-blackSemi shadow-lg rounded-2xl p-4 z-40",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"flex items-center mb-2 relative gap-2",children:[e.jsx("button",{onClick:y,children:e.jsx(x,{name:"ArrowLeft",size:"14"})}),N.sender.profile_photo_url?e.jsx("img",{src:N.sender.profile_photo_url,alt:N.sender.name,className:"w-10 h-10 rounded-full bg-custom-gray-dark"}):e.jsx("div",{className:"w-10 h-10 bg-custom-white dark:bg-custom-gray-semiDark rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm text-custom-blackLight dark:text-custom-white font-bold",children:t(N.sender.name)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:N.sender.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:v("nonEspecificJob")})]})]}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsxs("div",{className:"flex items-center text-custom-gray-semiDark dark:text-custom-white bg-custom-white dark:bg-custom-gray-darker py-1 px-2 rounded-full",children:[e.jsx("span",{className:"mr-2",children:e.jsx(x,{name:"Calendar",size:"14",className:"text-custom-orange"})}),e.jsx("p",{className:"text-xs",children:k(N.sent_at)})]}),e.jsxs("div",{className:"flex items-center text-custom-gray-semiDark dark:text-custom-white ml-4 bg-custom-white dark:bg-custom-gray-darker py-1 px-2 rounded-full",children:[e.jsx("span",{className:"mr-2",children:e.jsx(x,{name:"Clock",size:"14",className:"text-custom-orange"})}),e.jsx("p",{className:"text-xs",children:_(N.sent_at)})]})]}),N.title&&e.jsx("p",{className:"max-h-60 overflow-y-auto no-scrollbar text-custom-gray-semiDark dark:text-custom-white mb-3 bg-custom-white dark:bg-custom-gray-darker py-1 px-2 rounded-xl",children:N.content}),Ke,e.jsx(P,{href:route("notifications"),className:"text-custom-orange hover:text-custom-black dark:hover:text-custom-gray-dark duration-300",children:v("seeOnCalendar")})]})}),document.body)]})})})}const je=l.createContext(),es=(r,s)=>{switch(s.type){case"SET_STATE":return{...r,...s.payload};case"SET_FICHAJES":return{...r,fichajes:s.payload};case"RESET":return{...be};default:return r}},be={fichajeSelected:null,fichajes:[],error:!1,errorMessage:"",loading:!0,isClockingIn:!1,isPaused:!1,openModal:!1,updated:!1};function ss({children:r}){const[s,i]=l.useReducer(es,be);l.useEffect(()=>{if(s.fichajeSelected)switch(s.fichajeSelected.estado_fichaje){case"en_curso":i({type:"SET_STATE",payload:{isClockingIn:!0,isPaused:!1}});break;case"en_pausa":case"descanso_obligatorio":i({type:"SET_STATE",payload:{isClockingIn:!0,isPaused:!0}});break;case"finalizado":i({type:"SET_STATE",payload:{isClockingIn:!1,isPaused:!1,openModal:!1}});break;default:i({type:"SET_STATE",payload:{isClockingIn:!1,isPaused:!1,openModal:!1}});break}else i({type:"SET_STATE",payload:{isClockingIn:!1,isPaused:!1,openModal:!1}})},[s.fichajeSelected]);const c=Se({accion:"",horario_id:"",horario_siguiente_id:"",coordenadas:{latitud:"",longitud:"",ip_address:"",user_agent:""}}),j=l.useCallback(async()=>{try{const o=await axios.get(route("api.v1.user.fichaje.estado")),{horarios:d}=o.data.datos,m=d.filter(u=>(u==null?void 0:u.estado_fichaje)!=="finalizado"),y=u=>{const[n,h]=u.split(":");return parseInt(n)*3600+parseInt(h)*60},t={loading:!1,error:!1,fichajes:d};if(m.length===0)t.fichajeSelected=null,t.isClockingIn=!1,t.isPaused=!1;else if(d.length===1)t.fichajeSelected=d[0],t.isClockingIn=d[0].estado_fichaje!=="en_curso",t.isPaused=d[0].estado_fichaje!=="en_pausa"||d[0].estado_fichaje!=="descanso_obligatorio";else if(d.length>1){const u=d.find(n=>n.estado_fichaje==="en_curso"||n.estado_fichaje==="en_pausa"||n.estado_fichaje==="descanso_obligatorio");if(u)t.fichajeSelected=u,t.isClockingIn=!0,t.isPaused=u.estado_fichaje==="en_pausa"||u.estado_fichaje==="descanso_obligatorio";else{const n=y(new Date().toLocaleTimeString("es-AR",{hour12:!1}));t.fichajeSelected=m.find(h=>y(h.hora_entrada)<=n&&n<=y(h.hora_salida))||m.reduce((h,D)=>y(D.hora_entrada)<y(h.hora_entrada)?D:h,m[0])}}i({type:"SET_STATE",payload:t})}catch(o){console.error("Fetch error:",o),i({type:"SET_STATE",payload:{loading:!1}})}},[]);l.useEffect(()=>{j()},[]);const p=l.useCallback(()=>{axios.post(route("api.v1.user.fichaje.accion"),c.data).then(o=>{const d=o.data.datos.horarios.find(m=>m.estado_fichaje==="en_curso"||m.estado_fichaje==="en_pausa"||m.estado_fichaje==="descanso_obligatorio");i({type:"SET_STATE",payload:{fichajeSelected:d}})}).catch(o=>{var d,m,y,t,u;console.error("Update error:",o),i({type:"SET_STATE",payload:{error:!0,errorMessage:((m=(d=o==null?void 0:o.response)==null?void 0:d.data)==null?void 0:m.message)||((u=(t=(y=o==null?void 0:o.response)==null?void 0:y.data)==null?void 0:t.error)==null?void 0:u.mensaje)}})})},[c.data]);l.useEffect(()=>{s.updated&&(p(),i({type:"SET_STATE",payload:{updated:!1}}))},[s.updated,p]);const f=l.useCallback(async o=>{try{const d=await w(),m=await v();c.setData(y=>{var t;return{...y,accion:o,horario_id:(t=s.fichajeSelected)==null?void 0:t.horario_id,coordenadas:{...y.coordenadas,latitud:d.latitude,longitud:d.longitude,ip_address:m,user_agent:navigator.userAgent}}}),i({type:"SET_STATE",payload:{updated:!0}})}catch(d){throw console.error("Error getting location:",d),d}},[c,s.fichajeSelected]),v=l.useCallback(async()=>{try{return(await(await fetch("https://api.ipify.org/?format=json")).json()).ip}catch(o){return console.error("Error al obtener la IP:",o),null}},[]),w=l.useCallback(()=>new Promise((o,d)=>{var y;const m=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>o({latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy,source:"navigator"}),async t=>{console.error("Geolocation error:",t),d(new Error("No se pudo obtener la ubicaciÃ³n"))},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}):d(new Error("Geolocation no soportado"))};(y=navigator.permissions)!=null&&y.query?navigator.permissions.query({name:"geolocation"}).then(t=>{t.state==="granted"||t.state==="prompt"?m():(alert("Habilita los permisos de ubicaciÃ³n"),d(new Error("Permiso denegado")))}).catch(()=>m()):m()}),[]),k=l.useCallback(async()=>{try{await f("iniciar")}catch(o){console.error("Clock in error:",o)}},[f]),_=l.useCallback(()=>{const o=s.isPaused?"reanudar":"descanso_adicional";f(o)},[s.isPaused,f]),S=l.useCallback(()=>{const o=s.isPaused?"reanudar":"descanso_obligatorio";f(o)},[s.isPaused,f]),a=l.useCallback(()=>{i({type:"SET_STATE",payload:{openModal:!0}})},[]),N=l.useCallback(()=>{f("finalizar")},[f]),g=l.useCallback(o=>{if(o<0)return"00:00:00";const d=Math.floor(o/3600),m=Math.floor(o%3600/60);return`${String(d).padStart(2,"0")}:${String(m).padStart(2,"0")}`},[]),b=l.useMemo(()=>{var o,d,m,y;return{recharge:j,fichaje:s.fichajeSelected,fichajes:s.fichajes,loading:s.loading,setFichajeSelected:t=>i({type:"SET_STATE",payload:{fichajeSelected:t}}),isClockingIn:s.isClockingIn,isPaused:s.isPaused,tiempoRestante:(o=s.fichajeSelected)==null?void 0:o.tiempo_restante,tiempoTranscurrido:((d=s.fichajeSelected)==null?void 0:d.tiempo_total)-((m=s.fichajeSelected)==null?void 0:m.tiempo_restante),disabled:((y=s.fichajeSelected)==null?void 0:y.estado_fichaje)==="finalizado",handleClockIn:k,handlePause:_,handleMealBreak:S,handleFinalize:a,confirmHandleFinalize:N,formatTime:g}},[s,k,_,a,N,g]);return e.jsxs(je.Provider,{value:b,children:[r,e.jsx(X,{title:"Â¿EstÃ¡s seguro de que quieres finalizar el fichaje?",content:"FinalizarÃ¡s el fichaje de tu turno, Â¿estÃ¡s seguro de continuar?",open:s.openModal,onOpenChange:o=>i({type:"SET_STATE",payload:{openModal:!s.openModal}}),action:N,variant:"confirm",icon:e.jsx(x,{name:"OctagonAlert",className:"w-6 h-6 text-red-500"})}),e.jsx(X,{title:"Error",content:s.errorMessage,open:s.error,onOpenChange:o=>i({type:"SET_STATE",payload:{error:!1,errorMessage:""}}),action:()=>i({type:"SET_STATE",payload:{error:!1,errorMessage:""}}),variant:"error",icon:e.jsx(x,{name:"OctagonAlert",className:"w-6 h-6 text-red-500"})})]})}function we(){return l.useContext(je)}const ts={antesDeFicharEntrada:5,despuesDeFicharEntrada:5,antesDeFicharDescanso:5,despuesDeFicharDescanso:5,antesDeFicharDescansoFin:5,despuesDeFicharDescansoFin:5,antesDeFicharSalida:5,despuesDeFicharSalida:0},T=(r,s,i=!1)=>{"Notification"in window&&(window.Notification.permission==="granted"?new window.Notification(r,{body:s}):window.Notification.permission!=="denied"&&window.Notification.requestPermission().then(j=>{j==="granted"&&new window.Notification(r,{body:s})})),!i&&C(e.jsxs("div",{className:"flex w-full items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("strong",{children:r}),e.jsx("br",{}),e.jsx("span",{children:s})]}),e.jsx("div",{children:e.jsx("button",{className:"bg-custom-orange text-white rounded-lg px-4 py-2 mt-2 hover:bg-custom-orange/80 text-nowrap",onClick:()=>C.dismiss(),children:"Vale"})})]}),{position:"bottom-right",duration:5e3,style:{backgroundColor:document.documentElement.classList.contains("dark")?"#212529":"#FFFFFF",border:"none",boxShadow:"none"}})};function me({time:r,minutes:s,add:i=!0}){const c=new Date(`2000-01-01T${r}:00`),j=i?1:-1;return c.setMinutes(c.getMinutes()+j*s),c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function ue({currentTime:r,fichaje:s,fichajes:i,isClockingIn:c,isPaused:j,openModal:p,countDown:f}){const{antesDeFicharEntrada:v,despuesDeFicharEntrada:w,antesDeFicharDescanso:k,despuesDeFicharDescanso:_,antesDeFicharDescansoFin:S,despuesDeFicharDescansoFin:a,antesDeFicharSalida:N,despuesDeFicharSalida:g}=ts,b=d=>{const[m,y]=d.split(":");return parseInt(m)*3600+parseInt(y)*60};if(!i||i.length===0)return null;const o=(d,m,y=!0)=>r===me({time:d,minutes:m,add:y});if(!c&&o(s==null?void 0:s.hora_entrada,v,!1)&&T("Fichaje",`Quedan ${v} minutos para la hora de fichaje`),!c&&o(s==null?void 0:s.hora_entrada,w,!0)&&T("Fichaje",`Han pasado ${w} minutos desde la hora de fichaje`),c&&o(s==null?void 0:s.descanso_inicio,k,!1)&&T("Descanso",`Quedan ${k} minutos para el descanso obligatorio`),c&&!j&&o(s==null?void 0:s.descanso_inicio,_,!0)&&T("Descanso",`Han pasado ${_} minutos desde que empezo el descanso obligatorio`),c&&o(s==null?void 0:s.descanso_fin,S,!1)&&T("Descanso",`Quedan ${S} minutos para finalizar el descanso obligatorio`),c&&o(s==null?void 0:s.descanso_fin,a,!0)&&T("Descanso",`Han pasado ${a} minutos desde que finalizo el descanso obligatorio`),c&&o(s==null?void 0:s.hora_salida,N,!1)&&T("Fichaje",`Quedan ${N} minutos para finalizar el turno`),c&&b(r)>=b(me({time:s==null?void 0:s.hora_salida,minutes:g,add:!0}))&&f<=0&&(p({title:"Fichaje",content:"Â¿Quieres fichar la salida?",action:"finalize"}),T("Fichaje","Es hora de fichar la salida",!0)),i.length>1){const d=[];i.forEach(m=>{i.find(t=>t.hora_salida===m.hora_entrada&&t.horario_id!==m.horario_id)&&d.push(m.hora_entrada)}),c&&d.some(m=>r===m)&&!j?(p({title:"Fichaje",content:"Ha pasado la hora de tu primer turno, Se ha cambiado el fichaje a tu siguiente turno",action:"change"}),T("Fichaje","Es hora de cambiar de turno",!0)):c&&d.some(m=>r===m)&&j&&(p({title:"Fichaje",content:"Tu turno esta pausado, Â¿quieres finalizar tu horario para poder fichar en tu siguiente turno?",action:"finalize"}),T("Fichaje","Es hora de cambiar de turno",!0))}}function as(){const{t:r}=H(),{recharge:s,fichaje:i,fichajes:c,disabled:j,isClockingIn:p,isPaused:f,handleClockIn:v,handlePause:w,handleMealBreak:k,handleFinalize:_,formatTime:S,tiempoTranscurrido:a,tiempoRestante:N,confirmHandleFinalize:g}=we(),[b,o]=l.useState(a),[d,m]=l.useState(!1),[y,t]=l.useState(""),[u,n]=l.useState(!1),[h,D]=l.useState(""),I=({title:O,content:z,action:W})=>{t(O),n(z),D(W),m(!0)};return l.useEffect(()=>{const z=new Date().toTimeString().slice(0,5);ue({currentTime:z,fichaje:i,fichajes:c,isClockingIn:p,isPaused:f,openModal:I});const W=setInterval(()=>{const Ne=new Date().toTimeString().slice(0,5);ue({currentTime:Ne,fichaje:i,fichajes:c,isClockingIn:p,isPaused:f,openModal:I})},6e4);return()=>clearInterval(W)},[b,f]),l.useEffect(()=>{if(p&&!f){const O=setInterval(()=>{o(z=>Math.max(z+60,0))},6e4);return()=>clearInterval(O)}},[p,f]),l.useEffect(()=>{p&&o(a)},[p,a]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[p&&c.length!==0&&i&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"hidden md:block text-sm font-bold text-gray-700 dark:text-gray-300",children:r(f?"Clock.pause":"Clock.working")}),e.jsx("div",{className:`w-full h-8 gap-2 py-1 px-8 rounded-full text-center flex items-center justify-center ${f?"bg-custom-gray-default dark:bg-custom-blackSemi text-black dark:text-white animate-pulse":"bg-custom-gray-default dark:bg-custom-blackSemi text-black dark:text-white"}`,children:e.jsx("span",{className:"text-sm font-bold",children:S(b)})})]}),c.length!==0&&i&&(i==null?void 0:i.estado_fichaje)!=="finalizado"&&e.jsx("div",{className:"flex items-center gap-1",children:p?e.jsx("div",{className:"flex items-center gap-2 py-1 px-2 rounded-full bg-custom-gray-default dark:bg-custom-blackSemi",children:f?e.jsx(e.Fragment,{children:e.jsx("button",{onClick:w,className:"flex items-center justify-center w-8 h-8 rounded-full p-1 hover:bg-sky-500/30 hover:text-sky-500 transition-colors",children:e.jsx(x,{name:"Play",size:16})})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:k,className:"flex items-center justify-center w-8 h-8 rounded-full p-1 hover:bg-sky-500/30 hover:text-sky-500 transition-colors",children:e.jsx(x,{name:"Utensils",size:16})}),e.jsx("button",{onClick:w,className:"flex items-center justify-center w-8 h-8 rounded-full p-1 hover:bg-custom-gray-light dark:hover:bg-custom-gray-semiDark transition-colors",children:e.jsx(x,{name:"Pause",size:16})}),e.jsx("button",{onClick:_,className:"flex items-center justify-center w-8 h-8 text-red-500 rounded-full p-1 hover:bg-red-500/30 transition-colors",children:e.jsx(x,{name:"Square",size:16})})]})}):e.jsx(Be,{onClick:v,className:"px-3 py-1 text-sm",disabled:j,children:r("Clock.entrance")})})]}),e.jsx(X,{variant:"default",title:y,content:u,open:d,icon:e.jsx(x,{name:"ClockAlert",className:"text-custom-orange"}),action:()=>{h==="finalize"?g():h==="change"&&s(),m(!1)},onOpenChange:()=>{m(!1)}})]})}function rs(){const{toggleSidebar:r}=M(),[s,i]=l.useState(!0),c=()=>{r(),i(!s)};return e.jsx("button",{onClick:c,className:"md:hidden w-8 h-8 flex items-center justify-center p-1 bg-custom-gray-light dark:bg-custom-gray-darker hover:bg-custom-gray-dark rounded-full focus:outline-none",children:e.jsx(x,{name:"Menu",className:"m-auto h-4 w-4"})})}function ns(){const{isClockingIn:r,entry:s,exit:i}=we(),{notifications:c,unreadCount:j,markAsRead:p,markAllAsRead:f}=ge();return e.jsx("nav",{className:"border-b border-custom-gray-default bg-white dark:border-gray-700 dark:bg-custom-blackLight",children:e.jsx("div",{className:"mx-auto w-full px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex h-16 items-center justify-end relative",children:[e.jsx("div",{className:"hidden md:flex ml-12 xl:ml-0 flex-1 justify-start xl:justify-center items-center",children:e.jsx("div",{className:"flex items-center max-w-64 justify-center z-30",children:e.jsx(P,{href:route("dashboard"),children:e.jsx(ce,{})})})}),e.jsxs("div",{className:"absolute justify-between md:justify-end items-center sm:right-0 top-1/2 transform -translate-y-1/2 z-20 flex gap-4 w-full",children:[e.jsx(P,{href:route("dashboard"),className:"md:hidden max-w-64",children:e.jsx(ce,{short:r})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(as,{}),e.jsx(Ze,{notifications:c,unreadCount:j,markAsRead:p,markAllAsRead:f}),e.jsx(rs,{})]})]})]})})})}const os=({...r})=>{const{theme:s="system"}=qe();return e.jsx(Oe,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...r})},$={showRecommendation:()=>{const r=C(e.jsxs("div",{className:"w-full p-2 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 flex items-center justify-center flex-shrink-0",children:e.jsx(x,{name:"Bell",className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Â¡Activa las notificaciones!"}),e.jsxs("div",{className:"text-sm text-red-800 space-y-2",children:[e.jsx("p",{className:"font-medium text-red-700",children:"ðŸ“… Nunca te pierdas un evento importante"}),e.jsxs("ul",{className:"text-xs text-red-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Recibe avisos cuando el navegador estÃ© minimizado"}),e.jsx("li",{children:"â€¢ Notificaciones de nuevos eventos del calendario"}),e.jsx("li",{children:"â€¢ Alertas importantes del sistema"})]}),e.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-red-900 mb-1 flex items-center",children:[e.jsx(x,{name:"Lightbulb",className:"w-4 h-4 mr-1"}),"Â¿CÃ³mo activar?"]}),e.jsxs("ol",{className:"text-xs text-red-800 space-y-1",children:[e.jsx("li",{children:"1. Haz clic en el candado ðŸ”“ o dialogo ðŸ’¬ la barra de direcciones"}),e.jsx("li",{children:'2. Busca "Notificaciones" y selecciona "Permitir"'}),e.jsx("li",{children:"3. Â¡Listo! Ya recibirÃ¡s notificaciones importantes"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{variant:"primary",size:"sm",className:"flex-1",onClick:async()=>{try{await Notification.requestPermission()==="granted"?(C.dismiss(r),C.success(e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx(x,{name:"Check",className:"w-3 h-3 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm text-green-900",children:"Â¡Notificaciones activadas!"}),e.jsx("div",{className:"text-xs text-green-800",children:"Ya recibirÃ¡s alertas importantes"})]})]}),{duration:4e3,style:{backgroundColor:"#fee2e2",border:"none"}})):C.info(e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{name:"Info",className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-red-800",children:"TambiÃ©n puedes activarlas manualmente haciendo clic en el candado ðŸ”’"})]}),{duration:6e3,style:{backgroundColor:"#fee2e2",border:"none"}})}catch{C.error(e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{name:"AlertCircle",className:"w-5 h-5 text-red-500 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-red-800",children:"Error al solicitar permisos. IntÃ©ntalo manualmente desde el candado ðŸ”’"})]}),{duration:5e3,style:{backgroundColor:"#fee2e2",border:"none"}})}},children:[e.jsx(x,{name:"Bell",className:"w-4 h-4 mr-1"}),"Activar ahora"]}),e.jsx(A,{variant:"secondary",size:"sm",onClick:()=>C.dismiss(r),children:"DespuÃ©s"})]}),"            "]}),{duration:1/0,position:"top-center",style:{width:"420px",backgroundColor:"#fee2e2",border:`2px solid ${document.documentElement.classList.contains("dark")?"#FB7D16":"#002048"}`,borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}});return r},showBlocked:()=>{const r=C(e.jsxs("div",{className:"w-full p-2 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-red-500 flex items-center justify-center flex-shrink-0",children:e.jsx(x,{name:"BellOff",className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-red-700 mb-2",children:"NotificaciÃ³n bloqueada"}),e.jsxs("div",{className:"text-sm text-gray-700  space-y-2",children:[e.jsx("p",{className:"text-gray-800",children:"Se intentÃ³ enviar una notificaciÃ³n pero estÃ¡n deshabilitadas."}),e.jsxs("div",{className:"bg-red-50 border border-red-200  rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-red-800 mb-1 flex items-center",children:[e.jsx(x,{name:"Settings",className:"w-4 h-4 mr-1"}),"Para activarlas:"]}),e.jsxs("ol",{className:"text-xs text-red-700 space-y-1",children:[e.jsx("li",{children:"1. Haz clic en el candado ðŸ”’ en la barra de direcciones"}),e.jsx("li",{children:'2. Busca "Notificaciones" â†’ Cambiar a "Permitir"'}),e.jsx("li",{children:"3. Recarga la pÃ¡gina"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>{C.info(e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{name:"Info",className:"w-5 h-5 text-blue-600 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-blue-800",children:"Busca el Ã­cono ðŸ”’ en la barra de direcciones â†’ ConfiguraciÃ³n del sitio â†’ Notificaciones â†’ Permitir"})]}),{duration:8e3,style:{backgroundColor:"#BBD2EC",border:"none"}})},children:[e.jsx(x,{name:"ExternalLink",className:"w-4 h-4 mr-1"}),"                        Ver instrucciones"]}),e.jsx(A,{variant:"secondary",size:"sm",className:"!bg-red-600 hover:!bg-red-700 !text-white !border-red-600",onClick:()=>C.dismiss(r),children:"Entendido"})]}),"            "]}),{duration:1/0,position:"top-center",style:{width:"400px",backgroundColor:"#fee2e2",border:"2px solid #ef4444",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}});return r},showRejected:()=>{const r=C(e.jsxs("div",{className:"w-full p-2 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500 flex items-center justify-center flex-shrink-0",children:e.jsx(x,{name:"X",className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Notificaciones rechazadas"}),e.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[e.jsx("p",{className:"text-red-800",children:"Has rechazado las notificaciones. Sin ellas, podrÃ­as perderte eventos importantes."}),e.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-red-900 mb-1 flex items-center",children:[e.jsx(x,{name:"RotateCcw",className:"w-4 h-4 mr-1"}),"Para cambiar tu decisiÃ³n:"]}),e.jsx("p",{className:"text-xs text-red-800",children:"ConfiguraciÃ³n del navegador â†’ Privacidad â†’ ConfiguraciÃ³n del sitio â†’ Notificaciones â†’ Permitir"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{variant:"secondary",size:"sm",className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white border-orange-500",onClick:()=>{C.info(e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(x,{name:"Settings",className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsx("div",{className:"text-sm text-red-800",children:"Ve a la configuraciÃ³n del navegador para cambiar los permisos"})]}),{duration:6e3,style:{backgroundColor:"#fee2e2",border:"none"}})},children:[e.jsx(x,{name:"Settings",className:"w-4 h-4 mr-1"}),"                        Configurar"]}),e.jsx(A,{variant:"secondary",size:"sm",className:"!bg-red-600 hover:!bg-red-700 !text-white !border-red-600",onClick:()=>C.dismiss(r),children:"Entendido"})]})]}),{duration:1/0,position:"top-center",style:{width:"400px",backgroundColor:"#fee2e2",border:"2px solid #f97316",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}});return r},showUnsupported:()=>{const r=C(e.jsxs("div",{className:"w-full p-2 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-500 flex items-center justify-center flex-shrink-0",children:e.jsx(x,{name:"AlertTriangle",className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"Navegador no compatible"}),e.jsxs("div",{className:"text-sm text-red-700 space-y-2",children:[e.jsx("p",{className:"text-red-800",children:"Tu navegador no soporta notificaciones del sistema."}),e.jsxs("div",{className:"bg-red-100 border border-red-300 rounded-lg p-3",children:[e.jsx("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Recomendamos usar:"}),e.jsx("div",{className:"text-xs text-red-700 space-y-1",children:e.jsx("p",{children:"â€¢ Chrome (recomendado) â€¢ Firefox â€¢ Edge â€¢ Opera"})})]})]})]})]}),"                ",e.jsx("div",{className:"flex justify-end",children:e.jsx(A,{variant:"secondary",size:"sm",className:"!bg-red-600 hover:!bg-red-700 !text-white !border-red-600",onClick:()=>C.dismiss(r),children:"Entendido"})})]}),{duration:1/0,position:"top-center",style:{width:"380px",backgroundColor:"#fee2e2",border:"2px solid #9ca3af",borderRadius:"16px",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"}});return r}},B=Object.freeze(Object.defineProperty({__proto__:null,NotificationPermissionToast:$},Symbol.toStringTag,{value:"Module"})),is=()=>{const[r,s]=l.useState(!0),[i,c]=l.useState(!1),[j,p]=l.useState(!1),[f,v]=l.useState("default"),[w,k]=l.useState(!1);l.useEffect(()=>{const g=()=>{s(!document.hidden)},b=()=>{s(!0)},o=()=>{s(!1)};return document.addEventListener("visibilitychange",g),window.addEventListener("focus",b),window.addEventListener("blur",o),()=>{document.removeEventListener("visibilitychange",g),window.removeEventListener("focus",b),window.removeEventListener("blur",o)}},[]),l.useEffect(()=>{(async()=>{if(!("Notification"in window)){p(!1),v("unsupported"),c(!1);return}p(!0);const b=Notification.permission;if(v(b),b==="granted"){c(!0);return}if(b==="denied"){c(!1);return}b==="default"&&c(!1)})()},[]);const _=async()=>{if(!("Notification"in window))throw new Error("Browser does not support notifications");const g=navigator.userAgent,b=g.includes("Firefox"),o=g.includes("Edg/");let d;try{return b?Notification.requestPermission.length===0?d=await Notification.requestPermission():d=await new Promise(m=>{Notification.requestPermission(m)}):o?(await new Promise(m=>setTimeout(m,100)),d=await Notification.requestPermission()):d=await Notification.requestPermission(),d}catch(m){throw new Error(`Failed to request permissions: ${m.message}`)}},S=g=>{var b,o,d,m,y,t,u;if((b=g.sender)!=null&&b.name)return g.sender.name;if(g.originalEvent){const n=g.originalEvent;if((o=n.user)!=null&&o.name)return n.user.name;if((d=n.creator)!=null&&d.name)return n.creator.name;if((m=n.createdBy)!=null&&m.name)return n.createdBy.name;if((y=n.author)!=null&&y.name)return n.author.name;if((t=n.owner)!=null&&t.name)return n.owner.name;if(((u=n.participantes)==null?void 0:u.length)>0){const h=n.participantes[0];return h.name||h.username||h.email}}return"Sistema"},a=g=>{if(!g)return{date:"",time:""};const b=new Date(g);return{date:b.toLocaleDateString(),time:b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}};return{isWindowVisible:r,hasPermissions:i,isSupported:j,permissionStatus:f,showNotification:g=>{if(!j)return $.showUnsupported(),!1;if(r)return!1;if(!i)return f==="denied"?$.showBlocked():f==="default"&&$.showRecommendation(),!1;try{const{date:b,time:o}=a(g.sent_at||g.created_at),d=g.title||"Nueva notificaciÃ³n",m=S(g),y=`ðŸ“… ${b} â° ${o}
ðŸ‘¤ Creado por ${m}`,u=navigator.userAgent.includes("Firefox"),n={body:y,icon:"/favicon.ico",tag:`notification-${g.id}`,requireInteraction:!1,silent:!1,data:{id:g.id,type:g.type||"general",url:g.url||"/notifications"}};u?(delete n.timestamp,delete n.badge):(n.badge="/favicon.ico",n.timestamp=new Date(g.sent_at||Date.now()).getTime());const h=new Notification(d,n);return h.onclick=D=>{D.preventDefault(),window.parent&&window.parent.focus(),window.focus(),(g.url||n.data.url)&&(window.location.href=g.url||n.data.url),h.close()},setTimeout(()=>{h.close()},8e3),!0}catch{return!1}},requestPermissions:_,testToast:()=>$.showTest()}},ls=()=>{const{t:r}=H("events"),{calendarEvents:s}=ge(),{showNotification:i,testToast:c,hasPermissions:j,isSupported:p,permissionStatus:f}=is(),[v,w]=l.useState(new Set);l.useEffect(()=>(window.testNotificationSystem={testToast:c,showRecommendation:()=>L(()=>Promise.resolve().then(()=>B),void 0).then(a=>a.NotificationPermissionToast.showRecommendation()),showBlocked:()=>L(()=>Promise.resolve().then(()=>B),void 0).then(a=>a.NotificationPermissionToast.showBlocked()),showRejected:()=>L(()=>Promise.resolve().then(()=>B),void 0).then(a=>a.NotificationPermissionToast.showRejected()),showUnsupported:()=>L(()=>Promise.resolve().then(()=>B),void 0).then(a=>a.NotificationPermissionToast.showUnsupported()),status:()=>({hasPermissions:j,isSupported:p,permissionStatus:f,currentPermission:Notification.permission}),forcePermissionRequest:async()=>{try{return await Notification.requestPermission()}catch{return null}},clearToasts:()=>{L(()=>import("./index-WlsBA3k2.js"),__vite__mapDeps([0,1,2])).then(a=>a.toast.dismiss())}},()=>{delete window.testNotificationSystem}),[c,j,p,f]);const k=a=>{if(!a)return null;if(typeof a=="object")return a;try{return JSON.parse(a)}catch{return[{id:"fallback-paragraph",type:"paragraph",children:[{text:a}]}]}},_=a=>{if(!a)return{date:"",time:""};const N=new Date(a);return{date:N.toLocaleDateString(),time:N.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}},S=a=>{var m;const{date:N,time:g}=_(a.sent_at||a.created_at),b=a.title||"Nuevo evento",o=((m=a.data)==null?void 0:m.color)||"bg-custom-orange",d=k(a.message);C(e.jsxs("div",{className:"gap-2 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${o} aspect-square`}),e.jsx("span",{className:"text-base font-medium",children:b})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-custom-gray-dark dark:text-custom-gray-light mt-2",children:[e.jsxs("span",{className:"flex items-center bg-custom-gray-default dark:bg-custom-blackSemi rounded-full px-3 py-2",children:[e.jsx(x,{name:"Calendar",className:"w-4 h-4 mr-2 text-custom-orange"}),N]}),e.jsxs("span",{className:"flex items-center bg-custom-gray-default dark:bg-custom-blackSemi rounded-full px-3 py-2",children:[e.jsx(x,{name:"Clock",className:"w-4 h-4 mr-2 text-custom-orange"}),g]})]}),e.jsxs("div",{className:"w-full dark:dark-scrollbar max-h-[250px] overflow-hidden mt-3 ml-1",children:[e.jsx("div",{className:"!pb-2 p-2 mb-2 rounded-xl !w-full bg-custom-gray-default dark:bg-custom-blackSemi !text-custom-blackSemi dark:!text-custom-white font-sans !text-sm line-clamp-2 text-ellipsis overflow-hidden",children:e.jsx($e,{value:d})}),e.jsx("div",{className:"w-full flex justify-end",children:e.jsx(A,{variant:"primary",onClick:()=>{window.location.href="/user/eventos"},children:"Ver en calendario"})})]})]}),{duration:5e3,style:{backgroundColor:document.documentElement.classList.contains("dark")?"#212529":"#FFFFFF",border:"none"}})};return l.useEffect(()=>(s.forEach(a=>{if(!v.has(a.id)){w(g=>new Set([...g,a.id]));const N={id:a.id,title:a.title||"Nuevo evento de calendario",message:a.descripcion||"Se ha agregado un nuevo evento al calendario",sent_at:a.start,sender:a.user||a.creator||a.createdBy||a.participantes&&a.participantes[0]||null,originalEvent:a,url:"/user/eventos",type:"calendar-event",data:{color:a.color||"bg-custom-orange",event_id:a.id,start:a.start,end:a.end}};S(N),i(N)}}),()=>{if(v.size>100){const a=Array.from(v);w(new Set(a.slice(-50)))}}),[s,i]),null};function Ds({children:r,title:s}){const{empleados:i=[]}=U().props,[c,j]=l.useState(!1);l.useEffect(()=>{const w=window.location.pathname,k=localStorage.getItem("onboardingCompleted");!localStorage.getItem("onboardingVisited")&&!k&&w==="/dashboard"&&j(!0)},[]),l.useEffect(()=>(c?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[c]);const[p,f]=l.useState(()=>{if(typeof window<"u"){const w=localStorage.getItem("sidebar-open");return w!==null?JSON.parse(w):!0}return!0}),v=w=>{f(w),typeof window<"u"&&localStorage.setItem("sidebar-open",JSON.stringify(w))};return l.useEffect(()=>{const w=k=>{k.key==="sidebar-open"&&k.newValue!==null&&f(JSON.parse(k.newValue))};if(typeof window<"u")return window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[]),l.useEffect(()=>(window.Echo.join("presence-app"),()=>{window.Echo.leave("presence-app")}),[]),e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:s}),e.jsxs(De,{open:p,onOpenChange:v,children:[e.jsx(Ye,{}),e.jsx("main",{className:"h-screen bg-custom-white dark:bg-custom-gray-sidebar w-full flex flex-col dark:dark-scrollbar max-w-full overflow-hidden",children:e.jsxs(ss,{children:[e.jsx("div",{className:"bg-custom-gray-default dark:bg-custom-gray-sidebar h-16",children:e.jsx(ns,{})}),e.jsx("section",{className:"flex-1 overflow-auto",children:r})]})}),e.jsx(Ve,{}),e.jsx(ls,{}),e.jsx(os,{richColors:!0,expand:!0,theme:()=>document.documentElement.classList.contains("dark")?"dark":"light"}),e.jsx(Ue,{show:c,onClose:()=>j(!1),empleados:i})]})]})}export{Ds as A,we as u};
