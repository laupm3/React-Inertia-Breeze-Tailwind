const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FormFields-gEQCVFUJ.js","assets/app-fwyInB3c.js","assets/app-CrPud50x.css","assets/input-CqlBlYgU.js","assets/utils-CytzSlOG.js","assets/separator-BWKairMX.js","assets/index-BIJodELy.js","assets/index-DloWbRVd.js","assets/useDebounce-xNcQ83OW.js","assets/FetchSelect-CvqHmH4Y.js","assets/select-B5O0TxCl.js","assets/index-DmpKZt4E.js","assets/index-p2DxCSsL.js","assets/index-C_F9oucK.js","assets/index-B7srb2QZ.js","assets/index-DmaU4p-o.js","assets/index-CyKk8pQ_.js","assets/tslib.es6-BUas5LQb.js","assets/index-CLai1W86.js","assets/index-BZgm3BCW.js","assets/index-4A9uUPu1.js","assets/index-CeuhGnKJ.js","assets/chevron-up-OjKdrhzc.js","assets/createLucideIcon-DoJ0Kelj.js","assets/check-5DjPwM22.js","assets/AdvanceDropdown-CXptW6sy.js","assets/AdvanceDropdown-qoEi4BOz.js","assets/Create-tmHr2JLD.js","assets/AuthenticatedLayout-B4CSARVj.js","assets/sidebar-CPh6C6LB.js","assets/index-BwobEAja.js","assets/button-Blwr-A5N.js","assets/sheet-DHc5Hgr8.js","assets/index-DVo7DTeW.js","assets/index-BZxTbISK.js","assets/x-2mzC_aTV.js","assets/skeleton-DSiYFg9q.js","assets/tooltip-DFfoxvAF.js","assets/LucideIcon-CEqEhMjI.js","assets/calendar-days-Dti00tYQ.js","assets/calendar-k1x2vwx8.js","assets/chevron-right-B1iws4WK.js","assets/user-plus-zM6CnMXf.js","assets/user-CNwXqt1W.js","assets/octagon-alert-BRAzZNeG.js","assets/dropdown-menu-bHoOJ61X.js","assets/index-v24TFYKQ.js","assets/popover-DaRbHQOK.js","assets/avatar-oBOSifLN.js","assets/PopUpIncidencias-CaovAEi3.js","assets/card-DYkZYgg5.js","assets/Button-CQuYVLGu.js","assets/textarea-C969rVin.js","assets/useTranslation-BtIkv0Na.js","assets/UserAvatar-cKyxDEhx.js","assets/ApplicationLogo-C2FcO4AY.js","assets/Yoopta-Dj4Guze5.js","assets/throttle-CmSTFqON.js","assets/index-WlsBA3k2.js","assets/PrimaryButton-SsXyLm2e.js","assets/DecisionModal-Dl8siGBG.js","assets/alert-dialog-kDfn0La3.js","assets/useNotifications-CSWGH93r.js","assets/ShowNotificactionFromJestream-cKOlvVdg.js","assets/OnboardingModal-D0HRNKzO.js","assets/Modal-BkRna8gK.js","assets/transition-ByAjZSmr.js","assets/StepItem-bNLmZaq8.js","assets/StepProgress-DNpLodXf.js","assets/WelcomeContent-BPJ5E7_N.js","assets/onboardingImages-CoczwfNn.js","assets/AboutContent-DOlAXyok.js","assets/TeamContent-C0DysUYq.js","assets/CreateLanguageForm-xwtvYsjX.js","assets/checkbox-BQT_ir1e.js","assets/index-BxSEkZvI.js","assets/alert-D9izbOQG.js","assets/dialog-iaZkf6Xy.js","assets/InputSkeleton-CFMfUb-2.js","assets/table-cS0UKUSm.js","assets/GlobalFilter-DNA5td8x.js","assets/DataTableContext-BYrqyX0i.js","assets/index-Z1g0u-qm.js","assets/TableDebugging-C1u6ii1k.js","assets/InputSkeleton-CXD3IfZM.css","assets/AdvancedHeader-CpvwMmYr.js","assets/command-PoUoScut.js","assets/badge-BgloL8Ae.js","assets/DatePicker-YJSItPq7.js","assets/calendar-DctTJhwg.js","assets/endOfWeek-DoVA-Yvp.js","assets/toDate-qOSwr3PX.js","assets/format-Be40hyfq.js","assets/constants-BKFt95HM.js","assets/addDays-B9Fzl-_R.js","assets/parseISO-Efi0RkWR.js","assets/RowActionsColumn-CM2slffX.js","assets/RowActionsTrigger-DnJzXomR.js","assets/EmpleadoAvatar-BBWI_HPN.js","assets/ColumnFilter-oxYUebdb.js","assets/multi-select-BSyp-qjs.js","assets/Pill-l4GaXyto.js","assets/StatusEmpleadoMapColor-Bp2doaTo.js","assets/RowActionsColumn-C3VJw1Sg.js","assets/RowActionsTrigger-C2PXJFNn.js","assets/RowCheckedColumn-BShQ1j9z.js","assets/CreateUpdateDialog-1qQQjI_x.js","assets/types-BZmDMmQb.js","assets/useApiEndpoints-CHm1F3ft.js","assets/GoogleAddress-DWOptz48.js","assets/Map-D73hm0ip.js","assets/index.modern-WcJlzckG.js","assets/Spinner-DPRe7Z_J.js","assets/SheetTable-CiCNZjvD.js","assets/SheetTable-oFCbTdfY.js","assets/tabs-DtCm3GAf.js","assets/SheetTableHeader-vhJO3F_n.js","assets/ContratosVigentesDialog-SpBmuJuH.js","assets/DataHandlerContext--vx6a3_3.js","assets/WeekDay-C1ZcXS4Y.js","assets/GetModalidadIcon-BUgIPR97.js","assets/getRoundingMethod-D0I6Z7xl.js","assets/es-DNLwfvrq.js","assets/functions-B_hVx-4e.js","assets/CreateUpdateDialog-Do8sw1Sp.js","assets/TurnoSelect-DHdheWBO.js","assets/DateTimePicker-22RgvA6H.js","assets/react-icons.esm-DXl_FId9.js","assets/scroll-area-CvQ1XCoU.js","assets/DataHandlerContext-DvtbAn32.js"])))=>i.map(i=>d[i]);
import{r as d,G as ke,a as te,j as e,R as ye,_ as Qe}from"./app-fwyInB3c.js";import{f as De,c as Se,d as Ce,e as Ee,b as Ae,D as $e}from"./dialog-iaZkf6Xy.js";import{u as Xe}from"./useTranslation-BtIkv0Na.js";import{o as Ze,u as pe,a as W,s as ee,d as Ke,b as es}from"./types-BZmDMmQb.js";import{toast as R}from"./index-WlsBA3k2.js";import{b as se,a as he}from"./DateTimePicker-22RgvA6H.js";import{useDataHandler as Te}from"./DataHandlerContext-DvtbAn32.js";import{S as b}from"./skeleton-DSiYFg9q.js";import{B as re}from"./Button-CQuYVLGu.js";import{S as xe}from"./Spinner-DPRe7Z_J.js";import{O as Fe}from"./octagon-alert-BRAzZNeG.js";import{S as ge}from"./SheetTable-oFCbTdfY.js";import{T as Pe,a as Ie,b as ne,c as ie}from"./tabs-DtCm3GAf.js";import{A as Re,a as Me,b as Le}from"./avatar-oBOSifLN.js";import{I as z}from"./LucideIcon-CEqEhMjI.js";import{P as ss}from"./Pill-l4GaXyto.js";import{S as as}from"./StatusEmpleadoMapColor-Bp2doaTo.js";import{C as ze}from"./ContratosVigentesDialog-SpBmuJuH.js";import{B as oe}from"./button-Blwr-A5N.js";import{c as ce}from"./utils-CytzSlOG.js";import{D as ts,a as rs,b as ns,c as ae}from"./dropdown-menu-bHoOJ61X.js";import{I as Oe}from"./input-CqlBlYgU.js";import{S as de}from"./separator-BWKairMX.js";import{F as V}from"./FetchSelect-CvqHmH4Y.js";import"./card-DYkZYgg5.js";import{G as is}from"./GetModalidadIcon-BUgIPR97.js";import{P as je,a as be,b as Ne}from"./popover-DaRbHQOK.js";import{C as _e}from"./calendar-DctTJhwg.js";import{f as me}from"./format-Be40hyfq.js";import{e as os}from"./es-DNLwfvrq.js";const He=()=>{const{t:s}=Xe(["datatable"]);return Ze({id:Ke().nullable(),n_expediente:ee().nonempty({message:"El nÃºmero de expediente es obligatorio"}),tipo_contrato_id:W(),asignacion_id:W(),fecha_inicio:ee().nonempty({message:"La fecha de inicio es obligatoria"}),fecha_fin:pe([ee(),es()]).optional(),empresa_id:W(),centro_id:W(),departamento_id:W(),empleado_id:W(),jornada_id:pe([W(),ee().min(0)]).refine(a=>a!==""||typeof a=="number",{message:"La jornada es obligatoria"})})},qe={id:null,n_expediente:"",tipo_contrato_id:null,asignacion_id:null,fecha_inicio:"",fecha_fin:null,empresa_id:null,centro_id:null,departamento_id:null,empleado_id:null,jornada_id:""},ve=s=>{var r,l,t,o,h,N,u;if(!s)return{};const a=n=>{if(!n)return null;try{if(typeof n=="string"){const x=new Date(n);return isNaN(x.getTime())?null:n}return n instanceof Date?isNaN(n.getTime())?null:n.toISOString():null}catch{return null}};return{id:s.id||null,n_expediente:s.n_expediente,tipo_contrato_id:((r=s.tipoContrato)==null?void 0:r.id)||s.tipo_contrato_id,asignacion_id:((l=s.asignacion)==null?void 0:l.id)||s.asignacion_id,fecha_inicio:a(s.fechaInicio||s.fecha_inicio),fecha_fin:a(s.fechaFin||s.fecha_fin),empresa_id:((t=s.empresa)==null?void 0:t.id)||s.empresa_id||s.empresaId||"",centro_id:((o=s.centro)==null?void 0:o.id)||s.centro_id||s.centroId||"",departamento_id:((h=s.departamento)==null?void 0:h.id)||s.departamento_id||s.departamentoId||"",empleado_id:((N=s.empleado)==null?void 0:N.id)||s.empleado_id||s.empleadoId||"",jornada_id:((u=s.jornada)==null?void 0:u.id)||s.jornada_id||s.jornadaId||""}},ue=s=>d.useMemo(()=>({dataKey:"contrato",show:s?route("api.v1.admin.contratos.show",{contrato:s}):null,store:route("api.v1.admin.contratos.store"),update:s?route("api.v1.admin.contratos.update",{contrato:s}):null,delete:s?route("api.v1.admin.contratos.destroy",{contrato:s}):null}),[s]),Be=d.createContext(null),ls=({children:s,model:a,onOpenChange:i,dataKey:r,onSaveData:l=null,modelAlias:t="registro",open:o=!1})=>{const[h,N]=d.useState(null),[u,n]=d.useState(!1),[x,m]=d.useState([]),[p,v]=d.useState(null),[f,_]=d.useState(null),[T,$]=d.useState(!1),[S,A]=d.useState(!1),[O,B]=d.useState(!1);ue(a);const w=ke(qe),Q=He(),{getContratoDetail:C,clearContratoCache:k}=Te(),D=d.useRef(!1);d.useEffect(()=>{if(!o||!a){o||(_(null),N(null),v(null),m([]),n(!1),A(!1),D.current=!1);return}if(D.current)return;const y=async()=>{try{D.current=!0,A(!0),n(!1);const g=await C(a);if(g){const H=g.anexos||[],c=ve(g),q=H.map(Z=>{const I=ve(Z);return{...I,n_expediente:I.n_expediente||c.n_expediente,tipo_contrato_id:I.tipo_contrato_id||c.tipo_contrato_id,asignacion_id:I.asignacion_id||c.asignacion_id,departamento_id:I.departamento_id||c.departamento_id,empresa_id:I.empresa_id||c.empresa_id,centro_id:I.centro_id||c.centro_id,empleado_id:I.empleado_id||c.empleado_id}}),F=g.empleado;let P=null;q.length>0&&(P=q.sort((I,fe)=>{const Ye=I.fecha_inicio?new Date(I.fecha_inicio):new Date(0);return(fe.fecha_inicio?new Date(fe.fecha_inicio):new Date(0))-Ye})[0]);const le={...c,anexos:q};_(c),w.setData(le),m(q),N(F),v(P)}else n(!0)}catch(g){console.error("âŒ Error al cargar datos del contrato:",g),n(!0)}finally{A(!1)}};return w.clearErrors(),y(),()=>{}},[o,a]);const J=d.useCallback(async y=>{var g,H;if(!(f!=null&&f.id))throw new Error("ID del contrato no encontrado");try{const c={...y};c.fecha_inicio&&(c.fecha_inicio=se(c.fecha_inicio)),c.fecha_fin&&(c.fecha_fin=se(c.fecha_fin)),c.jornada_id&&c.jornada_id!==""&&(c.jornada_id=Number(c.jornada_id));const q=Object.fromEntries(Object.entries(c).filter(([F,P])=>P!=null&&P!==""));await te.post(route("api.v1.admin.contratos.anexos.store",{contrato:f.id}),q),R.success("Anexo creado con Ã©xito"),k(a)}catch(c){if((H=(g=c.response)==null?void 0:g.data)!=null&&H.errors){const q=Object.entries(c.response.data.errors).map(([F,P])=>`${F}: ${P.join(", ")}`).join(`
`);R.error(`Errores de validaciÃ³n:
${q}`)}else R.error("Error al crear un anexo");throw c}},[f,a,k]),M=d.useCallback(async y=>{if(!(f!=null&&f.id))throw new Error("ID del contrato no encontrado");try{const g={...y};g.fecha_inicio&&(g.fecha_inicio=se(g.fecha_inicio)),g.fecha_fin&&(g.fecha_fin=se(g.fecha_fin)),await te.put(route("api.v1.admin.contratos.anexos.update",{contrato:f.id,anexo:g.id}),g),R.success("Anexo actualizado con Ã©xito"),k(a)}catch(g){throw R.error("Error al actualizar un anexo"),g}},[f,a,k]),G=d.useCallback(async y=>{if(!(f!=null&&f.id))throw new Error("ID del contrato no encontrado");try{await te.delete(route("api.v1.admin.contratos.anexos.destroy",{contrato:f.id,anexo:y})),R.success("Anexo eliminado con Ã©xito"),k(a)}catch(g){throw R.error("Error al eliminar un anexo"),g}},[f,a,k]),X=d.useCallback((y,g)=>{if(!p)return;const H=typeof y=="object"?y:{[y]:g},c={...p,...H};v(c);const q=w.data.anexos.findIndex(F=>F.id===p.id);if(q>-1){const F=[...w.data.anexos];F[q]=c,w.setData("anexos",F)}},[w,p,v]),j=d.useCallback(()=>{const y=Q.safeParse(w.data);if(w.clearErrors(),!y.success){const g=y.error.flatten().fieldErrors;Object.keys(g).forEach(H=>{w.setError(H,g[H][0])})}return y.success},[w,Q]),E=d.useCallback(async()=>{if(j())try{B(!0),n(!1),w.clearErrors();const g=w.data.anexos||[];let H=!1;for(const c of g)if(typeof c.id=="string"&&c.id.startsWith("new_")){H=!0;const F={fecha_inicio:c.fecha_inicio,n_expediente:c.n_expediente||f.n_expediente,tipo_contrato_id:c.tipo_contrato_id||f.tipo_contrato_id,departamento_id:c.departamento_id||f.departamento_id,asignacion_id:c.asignacion_id||f.asignacion_id,empresa_id:c.empresa_id||f.empresa_id,centro_id:c.centro_id||f.centro_id,empleado_id:c.empleado_id||f.empleado_id},P=Object.entries(F).filter(([Z,I])=>!I||I==="").map(([Z])=>Z);if(P.length>0)throw R.error(`Faltan campos obligatorios: ${P.join(", ")}`),new Error(`Campos obligatorios faltantes: ${P.join(", ")}`);const le={n_expediente:c.n_expediente||f.n_expediente,tipo_contrato_id:c.tipo_contrato_id||f.tipo_contrato_id,departamento_id:c.departamento_id||f.departamento_id,asignacion_id:c.asignacion_id||f.asignacion_id,empresa_id:c.empresa_id||f.empresa_id,centro_id:c.centro_id||f.centro_id,empleado_id:c.empleado_id||f.empleado_id,jornada_id:c.jornada_id,fecha_inicio:c.fecha_inicio,fecha_fin:c.fecha_fin};await J(le)}else{const F=x.find(P=>P.id===c.id);F&&JSON.stringify(F)!==JSON.stringify(c)&&await M(c)}if(l){const c=await C(a);c&&l(c)}H||!p||p&&typeof p.id=="string"&&p.id.startsWith("new_")?(i(!1),R.success("Contrato y anexos actualizados con Ã©xito"),$(!1)):(R.success("Anexo actualizado con Ã©xito"),$(!1))}catch{n(!0),R.error(`Error al actualizar el ${t}`)}finally{B(!1)}},[a,w.data.anexos,x,l,i,J,M,G,t,j,p,C]),U=d.useMemo(()=>({modelAlias:t,model:a,error:u,form:w,updateForm:X,handleSubmit:E,setError:n,onOpenChange:i,isLoading:S,isSaving:O,empleado:h,empleado_id:w.data.empleado_id,deleteAnexo:G,selectedAnexo:p,setSelectedAnexo:v,contractData:f,isEditingMode:T,setIsEditingMode:$}),[t,a,u,w,X,E,i,S,O,h,G,p,f,T]);return e.jsx(Be.Provider,{value:U,children:s})};function Y(){const s=d.useContext(Be);if(!s)throw new Error("useDialogData debe usarse dentro de DialogDataContextProvider");return s}const cs=s=>s?{id:s.id||null,n_expediente:s.n_expediente||"",tipo_contrato_id:s.tipoContrato.id||null,asignacion_id:s.asignacion.id||null,fecha_inicio:s.fechaInicio||"",fecha_fin:s.fechaFin||null,empresa_id:s.empresa.id||null,centro_id:s.centro.id||null,departamento_id:s.departamento.id||null,empleado_id:s.empleado.id||null,jornada_id:s.jornada.id||null}:void 0,Ge=d.createContext(null),ds=({children:s,model:a,onOpenChange:i,dataKey:r,onSaveData:l=null,modelAlias:t="registro",open:o=!1})=>{const[h,N]=d.useState(!1),[u,n]=d.useState(!1),[x,m]=d.useState(!1),[p,v]=d.useState(!1),f=ue(a),_=ke(qe),T=He(),{getContratoDetail:$,clearContratoCache:S}=Te();d.useEffect(()=>{if(!o||!a){o||(n(!1),m(!1));return}const C=async()=>{try{m(!0),n(!1);const k=await $(a);k?_.setData(cs(k)):n(!0)}catch(k){console.error("Error al cargar datos:",k),n(!0)}finally{m(!1)}};return _.clearErrors(),C(),()=>{}},[o,a]);const A=d.useCallback((C,k)=>{if(typeof C=="object"&&k===void 0){_.setData(D=>({...D,...C}));return}_.setData(D=>({...D,[C]:k}))},[_]),O=d.useCallback(()=>{const C=T.safeParse(_.data);if(_.clearErrors(),!C.success){const k=C.error.flatten().fieldErrors;Object.keys(k).forEach(D=>{_.setError(D,k[D][0])})}return C.success},[_,T]),B=d.useCallback(async()=>{var C,k;try{v(!0),n(!1),_.clearErrors();const D=new FormData;Object.entries(_.data).forEach(([M,G])=>{G instanceof File?D.append(M,G):D.append(M,G??"")}),a&&D.append("_method","PUT");const J=a?await axios.post(f.update,D,{headers:{"Content-Type":"multipart/form-data"}}):await axios.post(f.store,D,{headers:{"Content-Type":"multipart/form-data"}});if(l)if(a){const M=await $(a);M&&l(M)}else l(J.data[r]);i(!1),_.clearErrors(),a&&S(a),R.success(a?`Registro ${t} actualizado con Ã©xito`:`Registro ${t} creado con Ã©xito`)}catch(D){if(n(!0),(k=(C=D.response)==null?void 0:C.data)!=null&&k.errors){const{errors:J}=D.response.data;Object.keys(J).forEach(M=>{_.setError(M,J[M][0])})}R.error(a?`Error al actualizar el ${t}`:`Error al crear el ${t}`)}finally{v(!1)}},[a,f.update,f.store,_,l,i,$,S,r,t]),w=d.useCallback(()=>{O()&&B()},[O,B]),Q=d.useMemo(()=>({modelAlias:t,model:a,error:u,form:_,updateForm:A,handleSubmit:w,setError:n,onOpenChange:i,isProcessing:h,isLoading:x,isSaving:p,setIsProcessing:N}),[t,a,u,_,A,w,i,h,x,p]);return e.jsx(Ge.Provider,{value:Q,children:s})};function K(){const s=d.useContext(Ge);if(!s)throw new Error("useDialogData debe usarse dentro de DialogDataContextProvider");return s}function we(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col w-full gap-12 bg-custom-white dark:bg-custom-blackLight p-4",children:[e.jsx("div",{className:"flex flex-col gap-4 dark:dark-scrollbar",children:e.jsx(b,{className:"h-8 w-[350px]"})}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]})]}),e.jsx(b,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4",children:[e.jsx(b,{className:"h-10 w-24"}),e.jsx(b,{className:"h-10 w-24"})]})]})}function ms(){const{model:s,handleSubmit:a,onOpenChange:i,isSaving:r}=K(),l=s?"Actualizar":"Guardar",t=s?"Actualizando...":"Guardando...";return e.jsxs(De,{children:[e.jsx("div",{className:"flex flex-row w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center ml-auto justify-end gap-2",children:[e.jsx(re,{variant:"secondary",onClick:()=>i(!1),disabled:r,children:"Cancelar"}),e.jsx(re,{variant:"primary",onClick:()=>a(),disabled:r,children:l})]})}),r&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2",children:[e.jsx(xe,{size:"sm",className:"text-custom-orange"}),e.jsxs("span",{className:"text-md",children:[t,"..."]})]})]})}function xs(){const{modelAlias:s,model:a}=K(),i=d.useMemo(()=>a?`Actualizar ${s}`:`Crear ${s}`,[a]);return e.jsxs(Se,{children:[e.jsx(Ce,{className:"dark:text-custom-white",children:i}),e.jsx(Ee,{className:"hidden",children:i})]})}const us=()=>{const{error:s}=K();return s?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(Fe,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo procesar la solicitud. Por favor, intÃ©ntalo de nuevo."})]})]}):null};function fs({children:s}){const{isSaving:a}=K();return e.jsxs("div",{className:`flex flex-col gap-4 h-full overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200 ${a?"opacity-60":"opacity-100"}`,children:[e.jsx(us,{}),s]})}const ps=ye.lazy(()=>Qe(()=>import("./FormFields-gEQCVFUJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129])));function hs(){const{isLoading:s,isSaving:a}=K();return e.jsx(Ae,{className:"flex flex-col gap-4 justify-between max-w-[1225px] max-h-[725px] bg-custom-white dark:bg-custom-blackLight",onInteractOutside:i=>{a&&i.preventDefault()},children:s?e.jsx(we,{}):e.jsxs(e.Fragment,{children:[e.jsx(xs,{}),e.jsx(fs,{children:e.jsx(ye.Suspense,{fallback:e.jsx(we,{}),children:e.jsx(ps,{})})}),e.jsx(ms,{})]})})}const gs=d.memo(function({open:a,onOpenChange:i,model:r=null,onSaveData:l=null}){return e.jsx($e,{open:a,onOpenChange:i,children:e.jsx(ds,{model:r,onSaveData:l,onOpenChange:i,modelAlias:"Contrato",dataKey:"contrato",open:a,children:e.jsx(hs,{})})})});function js({data:s}){var a,i;return e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 mb-4 w-full",children:[e.jsx(Re,{className:"h-24 w-24 rounded-full",children:s!=null&&s.profile_photo_url?e.jsx(Me,{src:s==null?void 0:s.profile_photo_url,alt:s==null?void 0:s.name}):e.jsx(Le,{className:"rounded-full",children:s==null?void 0:s.name[0]})}),e.jsxs("div",{className:"space-y-1 text-center sm:text-left w-full",children:[e.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2",children:e.jsx("span",{className:"text-xl font-semibold text-custom-gray-semiDark dark:text-white",children:s==null?void 0:s.name})}),e.jsx("div",{className:"text-base text-custom-gray-semiDark dark:text-gray-300",children:((a=s==null?void 0:s.role)==null?void 0:a.name)&&((i=s==null?void 0:s.role)==null?void 0:i.name)}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center gap-4 mt-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{name:"Mail",size:"16",className:"text-custom-orange"}),e.jsx("span",{className:"text-sm text-custom-gray-semiDark dark:text-gray-300 break-all",children:s==null?void 0:s.email})]})})]})]})}const Je=({label:s,value:a,isLast:i,isFirst:r})=>e.jsxs("div",{className:`overflow-hidden ${r?"rounded-t-[20px]":""} ${i?"rounded-b-[20px]":""}`,children:[e.jsx("div",{className:"bg-custom-gray-default/50 dark:bg-custom-gray-darker/50 p-3",children:e.jsx("span",{className:"text-sm text-custom-gray-semiDark dark:text-gray-300 font-medium",children:s})}),e.jsx("div",{className:`bg-white dark:bg-custom-gray-sidebar p-3 border border-custom-gray-default dark:border-custom-gray-darker/50 ${i?"rounded-b-[20px]":""} ${r?"":"-mt-[1px]"}`,children:e.jsx("div",{className:"text-sm text-custom-gray-semiDark dark:text-gray-200 break-words",children:a||"No disponible"})})]}),Ve=({label:s,value:a,className:i="",isHeader:r=!1,isLast:l=!1})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-custom-gray-default/50 dark:bg-custom-gray-darker/50 p-3 flex justify-between items-center",children:e.jsx("span",{className:"text-sm text-custom-gray-semiDark dark:text-gray-300 font-medium",children:s})}),e.jsx("div",{className:`bg-white dark:bg-custom-gray-sidebar p-3 flex items-center border border-custom-gray-default dark:border-custom-gray-darker/50 ${i} ${l?"rounded-br-[20px]":""} ${r?"rounded-tr-[20px]":""} ${r?"":"-mt-[1px]"}`,children:e.jsx("div",{className:"text-sm text-custom-gray-semiDark dark:text-gray-200 break-words w-full",children:a||"No disponible"})})]}),bs=({data:s})=>{var t,o,h,N,u;const a=n=>{if(!n)return"N/A";const x=new Date(n),m=`0${x.getDate()}`.slice(-2),p=`0${x.getMonth()+1}`.slice(-2),v=x.getFullYear();return`${m}-${p}-${v}`},i=[{label:"AsignaciÃ³n",value:((t=s.asignacion)==null?void 0:t.nombre)||"N/A"},{label:"Tipo de contrato",value:((o=s.tipoContrato)==null?void 0:o.nombre)||"N/A"},{label:"Centro",value:((h=s.centro)==null?void 0:h.nombre)||"N/A"},{label:"Departamento",value:((N=s.departamento)==null?void 0:N.nombre)||"N/A"},{label:"Empresa",value:((u=s.empresa)==null?void 0:u.nombre)||"N/A"},{label:"Numero expediente",value:s.n_expediente||"N/A"},{label:"Fecha de inicio",value:a(s.fechaInicio)},{label:"Fecha de fin",value:a(s.fechaFin)}],r=()=>e.jsx("div",{className:"block md:hidden space-y-0",children:i.map((n,x,m)=>e.jsx(Je,{label:n.label,value:n.value,isFirst:x===0,isLast:x===m.length-1},n.label))}),l=()=>e.jsx("div",{className:"hidden md:grid md:grid-cols-2 overflow-hidden rounded-[20px]",children:i.map((n,x)=>e.jsx(Ve,{label:n.label,value:n.value,isHeader:x===0,isLast:x===i.length-1},n.label))});return e.jsxs(e.Fragment,{children:[e.jsx(r,{}),e.jsx(l,{})]})},Ns=({data:s})=>{var l,t,o,h,N,u,n,x,m,p,v,f,_,T,$;const[a,i]=d.useState(!1),r=[{label:"Nombre",value:((l=s.empleado)==null?void 0:l.nombre)||"N/A"},{label:"Primer apellido",value:((t=s.empleado)==null?void 0:t.primerApellido)||"N/A"},{label:"Segundo apellido",value:((o=s.empleado)==null?void 0:o.segundoApellido)||"N/A"},{label:"NIF",value:((h=s.empleado)==null?void 0:h.nif)||"N/A"},{label:"Estado",value:e.jsx(ss,{identifier:(u=(N=s.empleado)==null?void 0:N.estadoEmpleado)==null?void 0:u.nombre,mapColor:as,children:((x=(n=s.empleado)==null?void 0:n.estadoEmpleado)==null?void 0:x.nombre)||"N/A"})},{label:"Direccion",value:((p=(m=s.empleado)==null?void 0:m.direccion)==null?void 0:p.full_address)||"N/A"},{label:"Email",value:((v=s.empleado)==null?void 0:v.email)||"N/A"},{label:"Email secundario",value:((f=s.empleado)==null?void 0:f.emailSecundario)||"N/A"},{label:"Telefono",value:((_=s.empleado)==null?void 0:_.telefono)||"N/A"},{label:"Telefono de emergencia",value:((T=s.empleado)==null?void 0:T.telefonoEmergencia)||"N/A"},{label:"Contrato",value:e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 text-custom-primary hover:text-custom-primary/80 dark:text-custom-orange dark:hover:text-custom-orange/80 transition-colors",children:[e.jsx("span",{className:"text-sm font-medium",children:"Contratos vigentes"}),e.jsx(z,{name:"ArrowUpRight",size:"16"})]})}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden space-y-0",children:r.map((S,A,O)=>e.jsx(Je,{label:S.label,value:S.value,isFirst:A===0,isLast:A===O.length-1},S.label))}),e.jsx("div",{className:"hidden md:grid md:grid-cols-2 overflow-hidden rounded-[20px]",children:r.map((S,A)=>e.jsx(Ve,{label:S.label,value:S.value,isHeader:A===0,isLast:A===r.length-1},S.label))}),a&&e.jsx(ze,{model:($=s.empleado)==null?void 0:$.id,open:a,onOpenChange:i})]})};function _s({data:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(js,{data:s.user}),e.jsxs(Pe,{defaultValue:"tab1",className:"w-full",children:[e.jsxs(Ie,{className:`w-full h-12 grid ${s.empleado?"grid-cols-2":"grid-cols-1"} bg-custom-gray-default/50 dark:bg-custom-gray-darker/50 rounded-lg p-1`,children:[e.jsx(ne,{value:"tab1",className:"h-10 px-2 md:px-3 text-sm font-medium transition-all text-custom-gray-dark data-[state=active]:text-custom-gray-semiDark data-[state=active]:bg-white dark:text-gray-300 dark:data-[state=active]:bg-custom-gray-sidebar dark:data-[state=active]:text-white rounded-md",children:e.jsx("span",{className:"whitespace-nowrap truncate",children:"InformaciÃ³n de contrato"})}),s.empleado&&e.jsx(ne,{value:"tab2",className:"h-10 px-2 md:px-3 text-sm font-medium transition-all text-custom-gray-dark data-[state=active]:text-custom-gray-semiDark data-[state=active]:bg-white dark:text-gray-300 dark:data-[state=active]:bg-custom-gray-sidebar dark:data-[state=active]:text-white rounded-md",children:e.jsx("span",{className:"whitespace-nowrap truncate",children:"InformaciÃ³n de empleado"})})]}),e.jsx(ie,{className:"mt-4 w-full",value:"tab1",children:e.jsx(bs,{data:s})}),s.empleado&&e.jsx(ie,{className:"mt-4 w-full",value:"tab2",children:e.jsx(Ns,{data:s})})]})]})}function vs(){return e.jsxs("div",{className:"flex flex-col w-full space-y-8",children:[e.jsxs("div",{className:"w-full flex items-center space-x-4",children:[e.jsx(b,{className:"h-24 w-24 rounded-full"}),e.jsxs("div",{className:"flex flex-col justify-center space-y-2",children:[e.jsx(b,{className:"h-4 w-[250px]"}),e.jsx(b,{className:"h-4 w-[200px]"})]})]}),e.jsx(b,{className:"h-20 w-full"}),e.jsx(b,{className:"h-96 w-full"})]})}function ws({open:s,onOpenChange:a,model:i,enableToView:r=!0}){const l=ue(i),[t,o]=d.useState(null),[h,N]=d.useState(!1),[u,n]=d.useState(!1);return d.useEffect(()=>((async()=>{if(s&&i)try{N(!0);const m=await axios.get(l.show);m.status===200?o(m.data[l.dataKey]):n(!0)}catch{n(!0)}finally{N(!1)}})(),()=>{}),[s,i,l.show,l.dataKey]),h||!r?e.jsx(ge,{title:null,open:s,onOpenChange:a,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx("div",{className:"flex items-center justify-center w-full h-full mt-6",children:e.jsx(vs,{})})}):e.jsx(ge,{title:null,open:s,onOpenChange:a,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx(e.Fragment,{children:t&&e.jsx(e.Fragment,{children:e.jsx(_s,{data:t})})})})}function Ue({onEdit:s,onDelete:a,onAdd:i,onInfo:r,canDelete:l=!0,showEditActions:t=!0}){return e.jsxs(ts,{children:[e.jsx(rs,{asChild:!0,children:e.jsx(oe,{variant:"ghost",size:"icon",children:e.jsx(z,{name:"Ellipsis",className:"h-4 w-4"})})}),e.jsxs(ns,{align:"end",children:[e.jsxs(ae,{onSelect:r,children:[e.jsx(z,{name:"Info",className:"h-4 w-4"}),"InformaciÃ³n"]}),t&&e.jsxs(ae,{onSelect:s,children:[e.jsx(z,{name:"SquarePen",className:"h-4 w-4"}),"Editar"]}),e.jsxs(ae,{onSelect:i,children:[e.jsx(z,{name:"Plus",className:"h-4 w-4"}),"AÃ±adir Anexo"]}),t&&l&&e.jsxs(ae,{onSelect:a,className:"text-red-500 dark:text-red-400",children:[e.jsx(z,{name:"Trash",className:"h-4 w-4"}),"Eliminar"]})]})]})}const L={cache:new Map,pendingRequests:new Map,subscribers:new Map},We=({jornadaId:s})=>{const[a,i]=d.useState(null),[r,l]=d.useState(!1),[t,o]=d.useState(null);if(d.useEffect(()=>{if(!s){i(null),l(!1),o(null);return}if(L.cache.has(s)){i(L.cache.get(s)),l(!1),o(null);return}if(L.pendingRequests.has(s)){l(!0),o(null);const m=p=>{p.success?(i(p.jornada),l(!1),o(null)):(o(p.error),l(!1))};return L.subscribers.get(s).add(m),()=>{const p=L.subscribers.get(s);p&&p.delete(m)}}l(!0),o(null),L.subscribers.set(s,new Set);const u=L.subscribers.get(s),n=te.get(route("api.v1.admin.jornadas.show",{jornada:s})).then(m=>{const p=m.data.jornada;return L.cache.set(s,p),u.forEach(v=>v({success:!0,jornada:p})),L.pendingRequests.delete(s),L.subscribers.delete(s),p}).catch(m=>{const p="Error al cargar la jornada.";throw u.forEach(v=>v({success:!1,error:p})),L.pendingRequests.delete(s),L.subscribers.delete(s),m});L.pendingRequests.set(s,n);const x=m=>{m.success?(i(m.jornada),l(!1),o(null)):(o(m.error),l(!1))};return u.add(x),()=>{u.delete(x)}},[s]),!s)return null;if(r)return e.jsx("div",{className:"flex justify-center items-center h-24",children:e.jsx(xe,{})});if(t)return e.jsx("div",{className:"text-red-500 text-center py-4",children:t});if(!a)return null;const h=["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado","Domingo"],N=h.map((u,n)=>a.esquema.find(x=>x.weekday_number===n));return e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"flex space-x-2 overflow-x-auto",children:N.map((u,n)=>{var x,m,p,v,f,_,T,$,S,A,O,B,w;return e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-stretch h-full min-h-[80px] w-52 rounded-xl overflow-hidden shadow-sm border border-gray-200 dark:border-gray-700",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-[10px] min-w-[10px] rounded-ss-xl rounded-es-xl",style:{backgroundColor:((x=u.turno)==null?void 0:x.color)||"#ccc"}}),e.jsxs("div",{className:"flex flex-col flex-1 py-2 px-3 bg-custom-gray-default dark:bg-custom-blackSemi rounded-ee-xl rounded-se-xl gap-1 min-w-0",children:[e.jsx("div",{className:"font-bold text-sm text-gray-900 dark:text-gray-100",children:h[n]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-300",children:[e.jsx(z,{name:"Clock",className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{children:(p=(m=u.turno)==null?void 0:m.horaInicio)==null?void 0:p.substring(0,5)}),e.jsx(z,{name:"ArrowRight",className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{children:(f=(v=u.turno)==null?void 0:v.horaFin)==null?void 0:f.substring(0,5)})]}),e.jsx("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-300 min-w-0",children:u.turno?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(is,{modalidad:((_=u.modalidad)==null?void 0:_.name)||(($=(T=u.turno)==null?void 0:T.modalidad)==null?void 0:$.name),className:"h-3 w-3"})}),e.jsxs("div",{className:"truncate min-w-0",children:[e.jsx("span",{className:"truncate",children:((A=(S=u.turno)==null?void 0:S.centro)==null?void 0:A.nombre)||"Sin centro"}),e.jsx("span",{className:"text-gray-400",children:" - "}),e.jsx("span",{className:"truncate text-gray-500",children:((w=(B=(O=u.turno)==null?void 0:O.centro)==null?void 0:B.empresa)==null?void 0:w.nombre)||"Sin empresa"})]})]}):e.jsx("span",{className:"text-xs text-gray-500",children:"Sin modalidad asignada"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-[10px] min-w-[10px] bg-gray-300 dark:bg-gray-600 rounded-ss-xl rounded-es-xl"}),e.jsxs("div",{className:"flex flex-col flex-1 py-2 px-3 bg-gray-50 dark:bg-custom-blackSemi rounded-ee-xl rounded-se-xl justify-center",children:[e.jsx("div",{className:"font-bold text-sm text-custom-blue dark:text-white",children:h[n]}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:"Descanso"})]})]})})},h[n])})})})};function ks({isEditing:s}){const{form:a,updateForm:i,selectedAnexo:r,contractData:l}=Y(),{errors:t}=a;if(!r&&!l)return null;const o=r||l,h=!r&&l,N=m=>{if(!m)return null;try{const p=new Date(m);return isNaN(p.getTime())?null:p}catch{return null}},u=(m,p)=>{r&&i(m,p)},n={n_expediente:o.n_expediente||"",tipo_contrato_id:o.tipo_contrato_id||"",departamento_id:o.departamento_id||"",asignacion_id:o.asignacion_id||"",fecha_inicio:N(o.fecha_inicio),fecha_fin:N(o.fecha_fin),jornada_id:o.jornada_id||""},x=h||s;return e.jsxs("div",{className:"flex flex-col gap-4",children:[h&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"ðŸ“„ Esta es la informaciÃ³n del contrato base. Para crear modificaciones, aÃ±ade un anexo."})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["NÂº Expediente",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(Oe,{disabled:!0,placeholder:"1232343",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:n.n_expediente}),t.n_expediente&&e.jsx("span",{className:"text-red-500 text-sm",children:t.n_expediente})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Tipo de contrato",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{disabled:!0,fetchRoute:"api.v1.admin.contratos.types",responseParameter:"tipos",value:n.tipo_contrato_id}),t.tipo_contrato_id&&e.jsx("span",{className:"text-red-500 text-sm",children:t.tipo_contrato_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Departamento",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{disabled:!0,fetchRoute:"api.v1.admin.departamentos.index",responseParameter:"departamentos",value:n.departamento_id}),t.departamento_id&&e.jsx("span",{className:"text-red-500 text-sm",children:t.departamento_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["AsignaciÃ³n",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{disabled:!0,fetchRoute:"api.v1.admin.asignaciones.index",responseParameter:"asignaciones",value:n.asignacion_id}),t.asignacion_id&&e.jsx("span",{className:"text-red-500 text-sm",children:t.asignacion_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Fecha de inicio",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(he,{disabled:x,value:n.fecha_inicio,onChange:m=>u("fecha_inicio",m),placeholder:"Seleccionar fecha",format:"PP, HH:mm",modal:!0}),t.fecha_inicio&&e.jsx("span",{className:"text-red-500 text-sm",children:t.fecha_inicio}),!n.fecha_inicio&&!h&&e.jsx("span",{className:"text-orange-500 text-sm",children:"âš ï¸ Este campo es obligatorio para crear el anexo"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Fecha de fin"}),e.jsx(he,{disabled:x,value:n.fecha_fin,onChange:m=>u("fecha_fin",m),placeholder:"Seleccionar fecha",format:"PP, HH:mm",modal:!0}),t.fecha_fin&&e.jsx("span",{className:"text-red-500 text-sm",children:t.fecha_fin})]})]}),e.jsx(de,{className:"bg-custom-gray-semiLight dark:bg-custom-gray-semiDark"}),e.jsx("h1",{className:"font-bold text-custom-blue dark:text-custom-white",children:"Jornada"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Seleccionar Jornada"}),e.jsx(V,{disabled:x,fetchRoute:"api.v1.admin.jornadas.index",responseParameter:"jornadas",value:n.jornada_id,onValueChange:m=>r&&i("jornada_id",m||""),placeholder:"Selecciona una jornada..."}),t.jornada_id&&e.jsx("span",{className:"text-red-500 text-sm",children:t.jornada_id})]}),n.jornada_id&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsx(We,{jornadaId:n.jornada_id})})]})}function ys({isEditing:s=!1,onEdit:a,onAdd:i,onInfo:r}){const{form:l}=Y(),{data:t,errors:o}=l;return e.jsxs("div",{className:"flex flex-col gap-6 py-4 h-full",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-custom-blue dark:text-custom-white",children:"Datos del contrato"}),e.jsx(Ue,{onEdit:a,onAdd:i,onInfo:r,canDelete:!1})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["NÂº Expediente",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(Oe,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",value:t.n_expediente??"",disabled:!0}),o.n_expediente&&e.jsx("span",{className:"text-red-500 text-sm",children:o.n_expediente})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Tipo de contrato",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",fetchRoute:"api.v1.admin.contratos.types",responseParameter:"tipos",value:t.tipo_contrato_id,disabled:!0}),o.tipo_contrato_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.tipo_contrato_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Departamento",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",fetchRoute:"api.v1.admin.departamentos.index",responseParameter:"departamentos",value:t.departamento_id,disabled:!0}),o.departamento_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.departamento_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["AsignaciÃ³n",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",fetchRoute:"api.v1.admin.asignaciones.index",responseParameter:"asignaciones",value:t.asignacion_id,disabled:!0}),o.asignacion_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.asignacion_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Fecha de inicio",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsxs(je,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(oe,{variant:"outline",className:ce("flex justify-between items-center text-left font-normal bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",!t.fecha_inicio&&"text-muted-foreground"),disabled:!0,children:[e.jsx("span",{children:t.fecha_inicio?me(new Date(t.fecha_inicio),"dd/MM/yyyy"):"Seleccionar fecha"}),e.jsx(z,{name:"Calendar",className:"ml-2 h-4 w-4 text-custom-orange"})]})}),e.jsx(Ne,{className:"w-auto p-0 bg-custom-gray-default dark:bg-custom-blackSemi",children:e.jsx(_e,{mode:"single",selected:new Date(t.fecha_inicio??""),initialFocus:!0})})]}),o.fecha_inicio&&e.jsx("span",{className:"text-red-500 text-sm",children:o.fecha_inicio})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Fecha de fin"}),e.jsxs(je,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(oe,{variant:"outline",className:ce("flex justify-between items-center text-left font-normal bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",!t.fecha_fin&&"text-muted-foreground"),disabled:!0,children:[e.jsx("span",{children:t.fecha_fin?me(new Date(t.fecha_fin),"dd/MM/yyyy"):"-- / -- / --"}),e.jsx(z,{name:"Calendar",className:"ml-2 h-4 w-4 text-custom-orange"})]})}),e.jsx(Ne,{className:"w-auto p-0 bg-custom-gray-default dark:bg-custom-blackSemi",children:e.jsx(_e,{mode:"single",selected:new Date(t.fecha_fin??""),initialFocus:!0})})]}),o.fecha_fin&&e.jsx("span",{className:"text-red-500 text-sm",children:o.fecha_fin})]})]})]})]}),e.jsx(de,{className:"bg-custom-gray-semiLight dark:bg-custom-gray-semiDark"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-custom-blue dark:text-custom-white mb-4",children:"Vinculaciones"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Empresa",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",fetchRoute:"api.v1.admin.empresas.index",responseParameter:"empresas",value:t.empresa_id,disabled:!0}),o.empresa_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.empresa_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Centro",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(V,{className:"bg-custom-gray-default dark:bg-custom-gray-darker rounded-full",fetchRoute:"api.v1.admin.centros.index",responseParameter:"centros",value:t.centro_id,disabled:!0}),o.centro_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.centro_id})]})]})]}),e.jsx(de,{className:"bg-custom-gray-semiLight dark:bg-custom-gray-semiDark"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-custom-blue dark:text-custom-white mb-4",children:"Jornada"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(We,{jornadaId:t.jornada_id})}),o.jornada_id&&e.jsx("span",{className:"text-red-500 text-sm",children:o.jornada_id})]})]})}const Ds=({isEditing:s,onEdit:a,onAdd:i,onInfo:r})=>e.jsx(ys,{isEditing:s,onEdit:a,onAdd:i,onInfo:r}),Ss=({anexos:s,selectedAnexo:a,isEditing:i,handleSelectAnexo:r,handleEdit:l,handleEditAnexo:t,handleDelete:o,handleAddAnexo:h,handleShowInfo:N,model:u})=>{const n=s.findIndex(x=>x.id===(a==null?void 0:a.id));return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 py-4",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-custom-blackSemi p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-gray-500 dark:text-gray-400 px-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("span",{children:"Anexo"}),e.jsx("span",{children:"Fecha inicio"})]}),e.jsx("div",{className:"flex-grow mt-2 space-y-1",children:s.length>0?s.map((x,m)=>e.jsxs("button",{onClick:()=>r(x),className:ce("w-full flex justify-between items-center text-left p-2 rounded-md transition-colors",(a==null?void 0:a.id)===x.id?"bg-custom-gray-light text-custom-blackSemi dark:bg-custom-blackSemi dark:text-white":"hover:bg-gray-200 dark:hover:bg-gray-700"),children:[e.jsx("span",{className:"font-semibold",children:`Anexo ${m+1}`}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:x.fecha_inicio?me(new Date(x.fecha_inicio),"PPP",{locale:os}):"Nuevo"})]},x.id)):e.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[e.jsx("p",{className:"text-sm",children:"No hay anexos"}),e.jsx("p",{className:"text-xs mt-1",children:"AÃ±ade un anexo para comenzar"})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs(oe,{variant:"outline",className:"w-full rounded-full bg-transparent dark:text-white",onClick:h,children:[e.jsx(z,{name:"Plus",className:"mr-2 h-4 w-4"}),"AÃ±adir Anexo"]})})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold dark:text-white",children:a?a&&typeof a.id=="string"&&a.id.startsWith("new_")?"Nuevo Anexo":`Anexo ${n!==-1?n+1:""}`:"Datos del contrato"}),a&&e.jsx(Ue,{onEdit:t||l,onDelete:o,onAdd:h,onInfo:N,empleado:u==null?void 0:u.empleado,canDelete:!0,showEditActions:a&&a.id&&typeof a.id!="string"})]}),e.jsx(ks,{isEditing:i})]})]})};function Cs({model:s,anexos:a,selectedAnexo:i,isEditing:r,handleSelectAnexo:l,handleEdit:t,handleEditAnexo:o,handleDelete:h,handleAddAnexo:N,handleShowInfo:u}){const[n,x]=d.useState("anexos"),m=()=>{N(),x("anexos")};return e.jsxs(Pe,{value:n,onValueChange:x,className:"w-full",children:[e.jsxs(Ie,{className:"grid w-full grid-cols-2 bg-custom-gray-default/50 dark:bg-custom-gray-darker/50 rounded-lg",children:[e.jsx(ne,{value:"contratos",className:"h-full px-3 text-sm font-medium transition-all text-custom-gray-dark data-[state=active]:text-custom-gray-semiDark data-[state=active]:bg-white dark:text-gray-300 dark:data-[state=active]:bg-custom-gray-sidebar dark:data-[state=active]:text-white rounded-lg",children:"Contratos"}),e.jsx(ne,{value:"anexos",className:"h-full px-3 text-sm font-medium transition-all text-custom-gray-dark data-[state=active]:text-custom-gray-semiDark data-[state=active]:bg-white dark:text-gray-300 dark:data-[state=active]:bg-custom-gray-sidebar dark:data-[state=active]:text-white rounded-lg",children:"Anexos"})]}),e.jsx(ie,{value:"contratos",className:"mt-4",children:n==="contratos"&&e.jsx(Ds,{isEditing:r,onEdit:t,onAdd:m,onInfo:u})}),e.jsx(ie,{value:"anexos",className:"mt-4",children:n==="anexos"&&e.jsx(Ss,{anexos:a,selectedAnexo:i,isEditing:r,handleSelectAnexo:l,handleEdit:t,handleEditAnexo:o,handleDelete:h,handleAddAnexo:N,handleShowInfo:u,model:s})})]})}function Es(){var G,X;const{form:s,model:a,empleado_id:i,empleado:r,deleteAnexo:l,selectedAnexo:t,setSelectedAnexo:o,contractData:h,isEditingMode:N,setIsEditingMode:u}=Y(),n=((G=s.data)==null?void 0:G.anexos)||[],[x,m]=d.useState(!1),[p,v]=d.useState(!1),[f,_]=d.useState(!1),[T,$]=d.useState(!1),S=d.useRef(null);d.useEffect(()=>{if(t){const j=t.id&&typeof t.id!="string";m(j),S.current!==null&&S.current!==t.id&&u(!1),S.current=t.id}},[t,u]);const A=x&&!N,O=()=>{if(!r)return"??";if(r.nombre&&r.primerApellido)return`${r.nombre[0]}${r.primerApellido[0]}`;if(r.name){const j=r.name.split(",");if(j.length>1)return`${j[1].trim()[0]}${j[0].trim()[0]}`;const E=r.name.split(" ");return E.length>1?`${E[0][0]}${E[1][0]}`:E[0].substring(0,2)}return"??"},B=()=>{if(!r)return"";if(r.nombre)return`${r.nombre} ${r.primerApellido||""} ${r.segundoApellido||""}`.trim();if(r.name){const j=r.name.split(",");return j.length>1?`${j[1].trim()} ${j[0].trim()}`:r.name}return""},w=j=>{o(j)},Q=()=>{v(!0)},C=()=>{u(!0)},k=()=>{_(!0)},D=j=>{s.setData(E=>({...E,...j})),v(!1)},J=async()=>{if(!t)return;const j=t.id,E=n.findIndex(y=>y.id===j),U=n.filter(y=>y.id!==j);s.setData("anexos",U),typeof j=="string"&&j.startsWith("new_")?R.success("Anexo temporal eliminado"):await l(j),o(U[E-1]||U[0]||null)},M=()=>{if(!h)return;const j=n.length>0?n[0]:h,E=g=>g==null||g===""?"":g.toString(),U={id:`new_${Date.now()}`,n_expediente:h.n_expediente||j.n_expediente||"",tipo_contrato_id:E(h.tipo_contrato_id||j.tipo_contrato_id),departamento_id:E(h.departamento_id||j.departamento_id),asignacion_id:E(h.asignacion_id||j.asignacion_id),empresa_id:E(h.empresa_id||j.empresa_id),centro_id:E(h.centro_id||j.centro_id),empleado_id:E(h.empleado_id||j.empleado_id),jornada_id:"",fecha_inicio:"",fecha_fin:null},y=[...n,U];s.setData("anexos",y),o(U)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col-reverse min-[500px]:flex-row min-[500px]:justify-between min-[500px]:items-center gap-4 mb-6",children:[r&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Re,{className:"h-12 w-12 rounded-full",children:[e.jsx(Me,{src:((X=r==null?void 0:r.user)==null?void 0:X.profile_photo_url)||(r==null?void 0:r.profile_photo_url),alt:B()}),e.jsx(Le,{className:"rounded-full",children:O()})]}),e.jsx("h1",{className:"text-xl font-semibold text-custom-blue dark:text-custom-white",children:B()})]}),e.jsxs("button",{onClick:()=>$(!0),className:"w-full min-[500px]:w-auto flex items-center justify-center gap-2 bg-transparent border border-gray-300 dark:border-gray-600 rounded-full px-4 py-2 text-custom-gray-dark dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(z,{name:"History",size:"16"}),e.jsx("span",{className:"text-sm font-medium",children:"Historial de contratos"})]})]}),T&&e.jsx(ze,{model:i,open:T,onOpenChange:$}),e.jsx(Cs,{model:a,anexos:n,selectedAnexo:t,isEditing:A,handleSelectAnexo:w,handleEdit:Q,handleEditAnexo:C,handleDelete:J,handleAddAnexo:M,handleShowInfo:k}),e.jsx(gs,{open:p,onOpenChange:v,model:a,onSaveData:D}),e.jsx(ws,{open:f,onOpenChange:_,model:a,enableToView:!0})]})}function As(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col w-full gap-12 bg-custom-white dark:bg-custom-blackLight p-4",children:[e.jsx("div",{className:"flex flex-col gap-4 dark:dark-scrollbar",children:e.jsx(b,{className:"h-8 w-[350px]"})}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]})]}),e.jsx(b,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(b,{className:"h-8 w-[250px]"}),e.jsx(b,{className:"h-12 w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4",children:[e.jsx(b,{className:"h-10 w-24"}),e.jsx(b,{className:"h-10 w-24"})]})]})}function $s(){const{model:s,handleSubmit:a,onOpenChange:i,isSaving:r}=Y(),l=s?"Actualizar":"Guardar",t=s?"Actualizando...":"Guardando...";return e.jsxs(De,{children:[e.jsx("div",{className:"flex flex-row w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center ml-auto justify-end gap-2",children:[e.jsx(re,{variant:"secondary",onClick:()=>i(!1),disabled:r,children:"Cancelar"}),e.jsx(re,{variant:"primary",onClick:()=>a(),disabled:r,children:l})]})}),r&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2",children:[e.jsx(xe,{size:"sm",className:"text-custom-orange"}),e.jsxs("span",{className:"text-md",children:[t,"..."]})]})]})}function Ts(){return e.jsxs(Se,{children:[e.jsx(Ce,{className:"dark:text-custom-white text-lg font-bold",children:"InformaciÃ³n de contrato"}),e.jsx(Ee,{className:"sr-only",children:"Gestiona la informaciÃ³n de contratos y sus anexos correspondientes"})]})}const Fs=()=>{const{error:s}=Y();return s?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(Fe,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo procesar la solicitud. Por favor, intÃ©ntalo de nuevo."})]})]}):null};function Ps({children:s}){const{isSaving:a}=Y();return e.jsxs("div",{className:`flex-1 flex flex-col gap-4 overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200 ${a?"opacity-60":"opacity-100"}`,children:[e.jsx(Fs,{}),s]})}function Is(){const{isLoading:s}=Y();return e.jsxs(Ae,{className:"flex flex-col gap-4 justify-between max-w-[1225px] max-h-[85vh] bg-custom-white dark:bg-custom-blackLight overflow-y-auto overflow-x-auto",children:[e.jsx(Ts,{}),s?e.jsx(As,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ps,{children:e.jsx(Es,{})}),e.jsx($s,{})]})]})}const ua=d.memo(function({open:a,onOpenChange:i,model:r=null,onSaveData:l=null}){return e.jsx($e,{open:a,onOpenChange:i,description:"AÃ±ade o edita anexos de contratos",children:e.jsx(ls,{model:r,onSaveData:l,onOpenChange:i,modelAlias:"Contrato",dataKey:"contrato",open:a,children:e.jsx(Is,{})})})});export{ua as A,gs as C,We as J,ws as S,K as a,ue as u};
