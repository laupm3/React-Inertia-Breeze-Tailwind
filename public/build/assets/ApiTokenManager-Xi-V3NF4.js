import{j as e,X as P,G as h,r as g}from"./app-fwyInB3c.js";import{z as B}from"./transition-ByAjZSmr.js";import{C as N}from"./Checkbox-DRGhoIDo.js";import{S as j,D as M}from"./SecondaryButton-BuSrYOV0.js";import{D as y}from"./DialogModal-BHNZflaY.js";import{I as _}from"./InputError-CrNaC_eR.js";import{I as v}from"./InputLabel-DwHTKIkK.js";import{P as T}from"./PrimaryButton-j7mQYH_F.js";import{T as E}from"./TextInput-CZi-2d99.js";import"./index-BxSEkZvI.js";import"./index-DloWbRVd.js";import"./index-p2DxCSsL.js";import"./index-DmpKZt4E.js";import"./index-4A9uUPu1.js";import"./index-BZgm3BCW.js";import"./index-BZxTbISK.js";import"./index-BIJodELy.js";import"./utils-CytzSlOG.js";import"./check-5DjPwM22.js";import"./createLucideIcon-DoJ0Kelj.js";import"./Modal-BkRna8gK.js";function z({on:n=!1,children:r}){return e.jsx(B,{show:n,enter:"transition ease-in duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition ease-out duration-1000",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r})})}function A({title:n,description:r,aside:o}){return e.jsxs("div",{className:"md:col-span-1 flex justify-between",children:[e.jsxs("div",{className:"px-4 sm:px-0",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:n}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r})]}),e.jsx("div",{className:"px-4 sm:px-0",children:o})]})}function L({title:n,description:r,children:o,className:l=""}){return e.jsxs("div",{className:"md:grid md:grid-cols-3 md:gap-6"+l,children:[e.jsx(A,{title:n,description:r}),e.jsx("div",{className:"mt-5 md:mt-0 md:col-span-2",children:e.jsx("div",{className:"px-4 py-5 sm:p-6 bg-white dark:bg-gray-800 shadow sm:rounded-lg",children:o})})]})}function G({onSubmit:n,title:r,description:o,children:l,actions:t=null}){const d=c=>{c.preventDefault(),n&&n()},i=t!==null;return e.jsxs("div",{className:"md:grid md:grid-cols-3 md:gap-6",children:[e.jsx(A,{title:r,description:o}),e.jsx("div",{className:"mt-5 md:mt-0 md:col-span-2",children:e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:`px-4 py-5 bg-white dark:bg-gray-800 sm:p-6 shadow ${i?"sm:rounded-tl-md sm:rounded-tr-md":"sm:rounded-md"}`,children:e.jsx("div",{className:"grid grid-cols-6 gap-6",children:l})}),i&&e.jsx("div",{className:"flex items-center justify-end px-4 py-3 bg-gray-50 dark:bg-gray-800 text-end sm:px-6 shadow sm:rounded-bl-md sm:rounded-br-md",children:t})]})})]})}function H(){return e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"})})})}function le({tokens:n,availablePermissions:r,defaultPermissions:o}){const l=P().props.jetstream,t=h({name:"",permissions:o??[]}),d=(s,a,u)=>{u.setData("permissions",s.target.checked?[...u.data.permissions,a]:u.data.permissions.filter(I=>I!==a))},i=h({permissions:[]}),c=h(),[b,x]=g.useState(null),[k,m]=g.useState(null),[f,p]=g.useState(null),C=()=>{t.post(route("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{x(!0),t.reset()}})},S=s=>{i.setData("permissions",s.abilities),m(s)},w=()=>{i.put(route("api-tokens.update",k),{preserveScroll:!0,preserveState:!0,onSuccess:()=>m(null)})},F=s=>{p(s)},D=()=>{c.delete(route("api-tokens.destroy",f),{preserveScroll:!0,preserveState:!0,onSuccess:()=>p(null)})};return e.jsxs("div",{children:[e.jsxs(G,{onSubmit:C,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf.",actions:e.jsxs(e.Fragment,{children:[e.jsx(z,{on:t.recentlySuccessful,children:e.jsx("span",{className:"me-3",children:"Created."})}),e.jsx(T,{className:t.processing?"opacity-25":"",disabled:t.processing,children:"Create"})]}),children:[e.jsxs("div",{className:"col-span-6 sm:col-span-4",children:[e.jsx(v,{htmlFor:"name",value:"Name"}),e.jsx(E,{id:"name",value:t.data.name,onChange:s=>t.setData("name",s.target.value),type:"text",className:"mt-1 block w-full",autoFocus:!0}),e.jsx(_,{message:t.errors.name,className:"mt-2"})]}),r.length>0&&e.jsxs("div",{className:"col-span-6",children:[e.jsx(v,{htmlFor:"permissions",value:"Permissions"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:r.map(s=>e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx(N,{checked:t.data.permissions.find(a=>a===s)?"checked":"",value:s,onChange:a=>d(a,s,t)}),e.jsx("span",{className:"ms-2 text-sm text-gray-600 dark:text-gray-400",children:s})]})},s))})]})]}),n.length>0&&e.jsxs("div",{children:[e.jsx(H,{}),e.jsx("div",{className:"mt-10 sm:mt-0",children:e.jsx(L,{title:"Manage API Tokens",description:"You may delete any of your existing tokens if they are no longer needed.",children:e.jsx("div",{className:"space-y-6",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"break-all dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center ms-2",children:[s.last_used_ago&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Last used ",s.last_used_ago]}),r.length>0&&e.jsx("button",{className:"cursor-pointer ms-6 text-sm text-gray-400 underline",onClick:()=>S(s),children:"Permissions"}),e.jsx("button",{className:"cursor-pointer ms-6 text-sm text-red-500",onClick:()=>F(s),children:"Delete"})]})]},s.id))})})})]}),e.jsxs(y,{show:b,onClose:()=>x(!1),title:"API Token",footer:e.jsx(j,{onClick:()=>x(!1),children:"Close"}),children:[e.jsx("div",{children:"Please copy your new API token. For your security, it won't be shown again."}),l.flash.token&&e.jsx("div",{className:"mt-4 bg-gray-100 dark:bg-gray-900 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all",children:l.flash.token})]}),e.jsx(y,{show:k!=null,onClose:()=>m(!1),title:"API Token Permissions",footer:e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:()=>m(null),children:"Cancel"}),e.jsx(T,{className:"ms-3 "+(i.processing?"opacity-25":""),disabled:i.processing,onClick:w,children:"Save"})]}),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(s=>e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx(N,{checked:i.data.permissions.find(a=>a===s)?"checked":"",value:s,onChange:a=>d(a,s,i)}),e.jsx("span",{className:"ms-2 text-sm text-gray-600 dark:text-gray-400",children:s})]})},s))})}),e.jsx(y,{show:f!=null,onClose:()=>p(null),title:"Delete API Token",footer:e.jsxs(e.Fragment,{children:[e.jsx(j,{onClick:()=>p(null),children:"Cancel"}),e.jsx(M,{className:"ms-3 "+(c.processing?"opacity-25":""),disabled:c.processing,onClick:D,children:"Delete"})]}),children:"Are you sure you would like to delete this API token?"})]})}export{le as default};
