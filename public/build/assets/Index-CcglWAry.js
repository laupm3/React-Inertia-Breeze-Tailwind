import{r as o,G as q,j as e,a as G,S as _}from"./app-fwyInB3c.js";import{A as J}from"./AuthenticatedLayout-B4CSARVj.js";import Q from"./CreateUpdateView-DaspU6o4.js";import{ViewContextProvider as W}from"./ViewContext-n1lBeHZ7.js";import{DataHandlerContextProvider as X}from"./DataHandlerContext-Cw2Ucqzd.js";import Y from"./DataTablePortal-BoW9el51.js";import Z from"./SheetTableView-8TNOrT2a.js";import K from"./DeleteView-BPiuShQw.js";import{f as ee,c as se,d as te,e as re,b as ae,D as oe}from"./dialog-iaZkf6Xy.js";import{u as ie}from"./useTranslation-BtIkv0Na.js";import{o as le,s as A,d as ne}from"./types-BZmDMmQb.js";import{toast as L}from"./index-WlsBA3k2.js";import{I as M}from"./input-CqlBlYgU.js";import"./separator-BWKairMX.js";import{u as ce}from"./useDebounce-xNcQ83OW.js";import"./select-B5O0TxCl.js";import"./AdvanceDropdown-qoEi4BOz.js";import"./avatar-oBOSifLN.js";import"./tooltip-DFfoxvAF.js";import"./DataTableContext-BYrqyX0i.js";import"./popover-DaRbHQOK.js";import"./button-Blwr-A5N.js";import"./AdvancedHeader-CpvwMmYr.js";import{B as R}from"./Button-CQuYVLGu.js";import"./calendar-DctTJhwg.js";import"./multi-select-BSyp-qjs.js";import"./RowActionsTrigger-C2PXJFNn.js";import"./CreateUpdateDialog-1qQQjI_x.js";import"./sheet-DHc5Hgr8.js";import"./tabs-DtCm3GAf.js";import"./DataHandlerContext--vx6a3_3.js";import{S as f}from"./skeleton-DSiYFg9q.js";import{S as me}from"./Spinner-DPRe7Z_J.js";import{O as de}from"./octagon-alert-BRAzZNeG.js";import{S as H}from"./SheetTable-oFCbTdfY.js";import{L as pe}from"./label-zCtqi3J5.js";import{S as ue}from"./switch-C4_FZWz0.js";import{B as O}from"./BlockCard-TCX704se.js";import{S as xe}from"./SheetTable-Cfz8sMya.js";import{T as fe}from"./TextInput-B-VFdlBC.js";import{I as C}from"./LucideIcon-CEqEhMjI.js";import{D as he}from"./DeleteDialog-CkqCyH9n.js";import{D as je}from"./DecisionModal-Dl8siGBG.js";import"./sidebar-CPh6C6LB.js";import"./index-DloWbRVd.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./dropdown-menu-bHoOJ61X.js";import"./index-DmpKZt4E.js";import"./index-p2DxCSsL.js";import"./index-BIJodELy.js";import"./index-C_F9oucK.js";import"./index-B7srb2QZ.js";import"./index-DmaU4p-o.js";import"./index-CyKk8pQ_.js";import"./tslib.es6-BUas5LQb.js";import"./index-CLai1W86.js";import"./index-BZgm3BCW.js";import"./index-BZxTbISK.js";import"./index-v24TFYKQ.js";import"./check-5DjPwM22.js";import"./createLucideIcon-DoJ0Kelj.js";import"./chevron-right-B1iws4WK.js";import"./PopUpIncidencias-CaovAEi3.js";import"./card-DYkZYgg5.js";import"./textarea-C969rVin.js";import"./UserAvatar-cKyxDEhx.js";import"./ApplicationLogo-C2FcO4AY.js";import"./Yoopta-Dj4Guze5.js";import"./throttle-CmSTFqON.js";import"./PrimaryButton-SsXyLm2e.js";import"./useNotifications-CSWGH93r.js";import"./ShowNotificactionFromJestream-cKOlvVdg.js";import"./OnboardingModal-D0HRNKzO.js";import"./Modal-BkRna8gK.js";import"./transition-ByAjZSmr.js";import"./StepItem-bNLmZaq8.js";import"./StepProgress-DNpLodXf.js";import"./WelcomeContent-BPJ5E7_N.js";import"./onboardingImages-CoczwfNn.js";import"./AboutContent-DOlAXyok.js";import"./TeamContent-C0DysUYq.js";import"./calendar-days-Dti00tYQ.js";import"./calendar-k1x2vwx8.js";import"./chevron-up-OjKdrhzc.js";import"./user-plus-zM6CnMXf.js";import"./user-CNwXqt1W.js";import"./x-2mzC_aTV.js";import"./index-CeuhGnKJ.js";import"./DataTable-D4Fn3B2g.js";import"./table-cS0UKUSm.js";import"./index-Z1g0u-qm.js";import"./TableFilters-ZojjKFl2.js";import"./GlobalFilter-DNA5td8x.js";import"./ImportExportDropdown-COI3HdRN.js";import"./index-C-xs73Vr.js";import"./index-DpIruHMc.js";import"./badge-BgloL8Ae.js";import"./scroll-area-CvQ1XCoU.js";import"./checkbox-BQT_ir1e.js";import"./index-BxSEkZvI.js";import"./index-4A9uUPu1.js";import"./TableDebugging-C1u6ii1k.js";import"./useColumns-D_V-9jaL.js";import"./RowSelectionColumn-COjZFz9T.js";import"./RowActionsColumn-CM2slffX.js";import"./RowActionsTrigger-DnJzXomR.js";import"./command-PoUoScut.js";import"./index-DVo7DTeW.js";import"./DatePicker-YJSItPq7.js";import"./format-Be40hyfq.js";import"./constants-BKFt95HM.js";import"./toDate-qOSwr3PX.js";import"./endOfWeek-DoVA-Yvp.js";import"./addDays-B9Fzl-_R.js";import"./parseISO-Efi0RkWR.js";import"./Create-tmHr2JLD.js";import"./CreateLanguageForm-xwtvYsjX.js";import"./alert-D9izbOQG.js";import"./alert-dialog-kDfn0La3.js";import"./InputSkeleton-CFMfUb-2.js";import"./useApiEndpoints-CHm1F3ft.js";import"./GoogleAddress-DWOptz48.js";import"./Map-D73hm0ip.js";import"./index.modern-WcJlzckG.js";import"./FetchSelect-CvqHmH4Y.js";import"./Pill-l4GaXyto.js";import"./StatusEmpleadoMapColor-Bp2doaTo.js";import"./ContratosVigentesDialog-SpBmuJuH.js";import"./WeekDay-C1ZcXS4Y.js";import"./GetModalidadIcon-BUgIPR97.js";import"./getRoundingMethod-D0I6Z7xl.js";import"./es-DNLwfvrq.js";import"./StatusUsuarioMapColor-BJWSxlNS.js";import"./EmpleadoAvatar-BBWI_HPN.js";const ge=()=>{const{t:s}=ie(["datatable"]);return le({id:ne().nullable(),name:A().min(2),description:A().min(2).max(255)})},B={id:null,name:"",description:""},we=s=>s?{id:s.id||null,name:s.name||"",description:s.description||""}:void 0,V=s=>o.useMemo(()=>({dataKey:"role",show:s?route("api.v1.admin.roles.show",{role:s}):null,store:route("api.v1.admin.roles.store"),update:s?route("api.v1.admin.roles.update",{role:s}):null,delete:s?route("api.v1.admin.roles.destroy",{role:s}):null}),[s]),I=o.createContext(null),Ne=({children:s,model:a,onOpenChange:l,dataKey:n,onSaveData:m=null,modelAlias:c="registro"})=>{const[h,N]=o.useState(!1),[d,j]=o.useState(!1),[w,k]=o.useState(!1),[g,E]=o.useState(!1),b=V(a),p=q(B),T=ge();o.useEffect(()=>{const r=async()=>{try{k(!0),j(!1);const i=await axios.get(b.show);i.status===200?p.setData(we(i.data[n])):j(!0)}catch(i){console.error("Error al cargar datos:",i),j(!0)}finally{k(!1)}};return p.clearErrors(),a?r():(p.setData(B),j(!1),k(!1)),()=>{}},[a]);const P=o.useCallback((r,i)=>{if(typeof r=="object"&&i===void 0){p.setData(u=>({...u,...r}));return}p.setData(u=>({...u,[r]:i}))},[p]),F=o.useCallback(()=>{const r=T.safeParse(p.data);if(p.clearErrors(),!r.success){const i=r.error.flatten().fieldErrors;Object.keys(i).forEach(u=>{p.setError(u,i[u][0])})}return r.success},[p,T]),U=o.useCallback(async()=>{try{E(!0),j(!1),p.clearErrors();const r=a?await axios.put(b.update,p.data):await axios.post(b.store,p.data);m&&m(r.data[n]),l(!1),p.clearErrors(),L.success(a?`Registro ${c} actualizado con éxito`:`Registro ${c} creado con éxito`)}catch(r){if(j(!0),r.response&&r.response.data&&r.response.data.errors){const{errors:i}=r.response.data;Object.keys(i).forEach(u=>{p.setError(u,i[u][0])})}L.error(a?`Error al actualizar el ${c}`:`Error al crear el ${c}`)}finally{E(!1)}},[a,b.update,b.store,p,m,l]),t=o.useCallback(()=>{F()&&U()},[F,U]),x=o.useMemo(()=>({modelAlias:c,model:a,error:d,form:p,updateForm:P,handleSubmit:t,setError:j,onOpenChange:l,isProcessing:h,isLoading:w,isSaving:g,setIsProcessing:N}),[c,a,d,p,P,t,l,h,w,g]);return e.jsx(I.Provider,{value:x,children:s})};function D(){const s=o.useContext(I);if(!s)throw new Error("useDialogData debe usarse dentro de DialogDataContextProvider");return s}function be({}){const{form:s,updateForm:a}=D(),{data:l,errors:n}=s,[m,c]=o.useState(l),h=ce(a,500);o.useEffect(()=>{c(l)},[l]);const N=o.useCallback((d,j)=>{c(typeof d=="object"?w=>({...w,...d}):w=>({...w,[d]:j})),n[d]&&delete n[d],h(d,j)},[h]);return e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:" font-bold",children:["Nombre",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(M,{placeholder:"Añadir nombre",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-gray-darker",value:m.name,onChange:d=>N("name",d.target.value)}),n.name&&e.jsx("span",{className:"text-red-500 text-sm",children:n.name})]}),e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx("span",{className:" font-bold",children:"Descripción"}),e.jsx(M,{placeholder:"Añadir descripción",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-gray-darker",value:m.description,onChange:d=>N("description",d.target.value)}),e.jsx("p",{className:"text-xs font-bold ml-auto text-custom-gray-dark dark:text-custom-gray-darker",children:"Máximo 255 caracteres"}),n.description&&e.jsx("span",{className:"text-red-500 text-sm",children:n.description})]})]})})}function ve(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col w-full gap-12 bg-custom-white dark:bg-custom-blackLight p-4",children:[e.jsx("div",{className:"flex flex-col gap-4 dark:dark-scrollbar",children:e.jsx(f,{className:"h-8 w-[350px]"})}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(f,{className:"h-8 w-[250px]"}),e.jsx(f,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(f,{className:"h-8 w-[250px]"}),e.jsx(f,{className:"h-12 w-full"})]})]}),e.jsx(f,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(f,{className:"h-8 w-[250px]"}),e.jsx(f,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(f,{className:"h-8 w-[250px]"}),e.jsx(f,{className:"h-12 w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4",children:[e.jsx(f,{className:"h-10 w-24"}),e.jsx(f,{className:"h-10 w-24"})]})]})}function ye(){const{model:s,handleSubmit:a,onOpenChange:l,isSaving:n}=D(),m=s?"Actualizar":"Guardar",c=s?"Actualizando...":"Guardando...";return e.jsxs(ee,{children:[e.jsx("div",{className:"flex flex-row w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center ml-auto justify-end gap-2",children:[e.jsx(R,{variant:"secondary",onClick:()=>l(!1),disabled:n,children:"Cancelar"}),e.jsx(R,{variant:"primary",onClick:()=>a(),disabled:n,children:m})]})}),n&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2",children:[e.jsx(me,{size:"sm",className:"text-custom-orange"}),e.jsxs("span",{className:"text-md",children:[c,"..."]})]})]})}function ke(){const{modelAlias:s,model:a}=D(),l=o.useMemo(()=>a?`Actualizar ${s}`:`Crear ${s}`,[a]);return e.jsxs(se,{children:[e.jsx(te,{className:"dark:text-custom-white",children:l}),e.jsx(re,{className:"hidden",children:l})]})}const De=()=>{const{error:s}=D();return s?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(de,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo procesar la solicitud. Por favor, inténtalo de nuevo."})]})]}):null};function Se({children:s}){const{isSaving:a}=D();return e.jsxs("div",{className:`flex flex-col gap-4 h-full overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200 ${a?"opacity-60":"opacity-100"}`,children:[e.jsx(De,{}),s]})}function Ce(){const{isLoading:s}=D();return e.jsx(ae,{className:"flex flex-col gap-4 justify-between sm:max-w-[1225px] sm:max-h-[725px] bg-custom-white dark:bg-custom-blackLight",children:s?e.jsx(ve,{}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{}),e.jsx(Se,{children:e.jsx(be,{})}),e.jsx(ye,{})]})})}const Ee=o.memo(function({open:a,onOpenChange:l,model:n=null,onSaveData:m=null}){return e.jsx(oe,{open:a,onOpenChange:l,children:e.jsx(Ne,{model:n,onSaveData:m,onOpenChange:l,modelAlias:"rol",dataKey:"role",children:e.jsx(Ce,{})})})});function Te({data:s,setData:a}){const[l,n]=o.useState(null),[m,c]=o.useState(!1),[h,N]=o.useState(null),[d,j]=o.useState([]),[w,k]=o.useState(""),[g,E]=o.useState(null),b=g==null?void 0:g.filter(t=>t.name.toLowerCase().includes(w.toLowerCase()));o.useEffect(()=>((async()=>{try{const x=await axios.get(route("api.v1.admin.modules.index"));x.status===200?E(x.data.modules):setError(!0)}catch(x){console.error("Error fetching data:",x)}})(),()=>{}),[s]);const p=async(t,x,r)=>{try{const i=await axios.put(route("api.v1.admin.roles.permission.switch",{role:t,permission:x}));if(console.log("response :>> ",i.data.roleHasPermission),i.status===200)return a(u=>{const S=u.permissions.some(y=>y.id===x);let v;if(S)v=u.permissions.filter(y=>y.id!==x);else{const y=g==null?void 0:g.find($=>$.id===r),z=y==null?void 0:y.permissions.find($=>$.id===x);if(!z)return u;v=[...u.permissions,z]}return{...u,permissions:v}}),i.data.roleHasPermission}catch(i){console.error("Error changing permission:",i)}},T=async(t,x)=>{try{const r=await axios.put(route("api.v1.admin.users.role.switch",{user:t,role:x}));if(console.log("response :>> ",r.data),r.status===200)return a(i=>{if(!i.users.some(v=>v.id===t))return i;const S=i.users.filter(v=>v.id!==t);return{...i,users:S}}),r.data.roleHasPermission}catch(r){console.error("Error changing permission:",r)}},P=t=>{N(t),c(!0)},F=()=>{h&&(T(h.id,s.id),c(!1),N(null))};function U({user:t}){return e.jsxs("section",{className:"flex items-center text-custom-black dark:text-custom-white justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 w-full",children:[e.jsx("img",{src:t.profile_photo_url,alt:t.name,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[e.jsx("span",{className:"text-sm text-custom-black dark:text-custom-white opacity-70",children:t.name}),e.jsx("span",{className:"text-xs text-custom-black dark:text-custom-white opacity-50",children:t.email})]})]}),e.jsx("button",{className:"flex items-center gap-1 text-custom-primary dark:text-custom-primary cursor-pointer",onClick:()=>n(t.id),children:e.jsx(C,{name:"ArrowUpRight",size:"16"})}),e.jsx("div",{className:"flex items-center gap-1 text-custom-primary dark:text-custom-primary cursor-pointer hover:text-red-400 duration-200",onClick:()=>P(t),children:e.jsx(C,{name:"Trash",size:"16"})})]})}return e.jsxs(e.Fragment,{children:[e.jsxs(O,{title:"Permisos",children:[e.jsx(fe,{type:"text",placeholder:"Buscar...",value:w,onChange:t=>k(t.target.value),className:"ml-auto w-1/2"}),e.jsx("div",{className:"rounded-3xl overflow-auto text-custom-black dark:text-custom-white max-h-[500px]",children:b&&b.map(t=>{const x=s==null?void 0:s.permissions.filter(r=>t.permissions.some(i=>i.id===r.id)).length;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between space-y-4",children:[e.jsx("p",{children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-xs font-bold text-custom-orange",children:[x," / ",t.permissions.length]}),e.jsxs("div",{className:"flex items-center w-fit p-2 mr-2 rounded-lg bg-custom-gray-default dark:bg-custom-blackSemi hover:opacity-50 duration-300 cursor-pointer select-none",onClick:()=>j(t.id===d?null:t.id),children:["editar permisos",d===t.id?e.jsx(C,{name:"ChevronUp",className:"w-4 h-4 ml-2 text-custom-orange"}):e.jsx(C,{name:"ChevronDown",className:"w-4 h-4 ml-2"})]})]})]}),d===t.id&&e.jsx("div",{className:"absolute mt-2 right-4 bg-white dark:bg-custom-blackSemi p-4 rounded-lg shadow-lg z-10",children:t.permissions.map(r=>{var u;const i=(u=s==null?void 0:s.permissions)==null?void 0:u.some(S=>S.id===r.id);return e.jsxs("div",{className:"flex items-center justify-between gap-2 space-y-4",children:[e.jsx(pe,{htmlFor:r.name,className:"capitalize",children:r.name}),e.jsx(ue,{id:r.name,checked:i,className:"data-[state=checked]:bg-custom-orange",onCheckedChange:()=>p(s.id,r.id,t.id)})]},r.id)})})]},t.id)})})]}),e.jsx(O,{title:"Usuarios con el rol",children:e.jsx("div",{className:"flex flex-col max-h-[500px] gap-6 px-2 pt-4 overflow-y-auto dark:dark-scrollbar",children:s.users.map((t,x)=>e.jsx(U,{user:t},x))})}),l&&e.jsx(xe,{open:l!==null,onOpenChange:()=>n(null),model:l,enableToView:!0}),m&&e.jsx(he,{open:m,onOpenChange:()=>c(!1),model:h,onDelete:F})]})}function Pe(){return e.jsxs("div",{className:"flex flex-col w-full space-y-8",children:[e.jsxs("div",{className:"w-full flex items-center space-x-4",children:[e.jsx(f,{className:"h-24 w-24 rounded-full"}),e.jsxs("div",{className:"flex flex-col justify-center space-y-2",children:[e.jsx(f,{className:"h-4 w-[250px]"}),e.jsx(f,{className:"h-4 w-[200px]"})]})]}),e.jsx(f,{className:"h-20 w-full"}),e.jsx(f,{className:"h-96 w-full"})]})}function Fe({open:s,onOpenChange:a,model:l,enableToView:n=!0}){const m=V(l),[c,h]=o.useState(null),[N,d]=o.useState(!0),[j,w]=o.useState(!1);return o.useEffect(()=>((async()=>{try{d(!0);const g=await axios.get(m.show);g.status===200?h(g.data[m.dataKey]):w(!0)}catch{w(!0)}finally{d(!1)}})(),()=>{}),[l]),N||!n?e.jsx(H,{title:null,open:s,onOpenChange:a,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx("div",{className:"flex items-center justify-center w-full h-full mt-6",children:e.jsx(Pe,{})})}):e.jsx(H,{title:null,open:s,onOpenChange:a,className:"w-full max-w-full sm:min-w-[600px]",descriptionContent:e.jsx(e.Fragment,{children:c&&e.jsx(e.Fragment,{children:e.jsx(Te,{data:c,setData:h})})})})}function Ue({open:s,onOpenChange:a,model:l,onDelete:n}){const m=V(l);console.log("endpoints :>> ",m);const c=async()=>{console.log("handleDelete :>> ",m.delete);try{(await G.delete(m.delete)).status===200&&(n&&n(l),L.success("Registro eliminado correctamente"))}catch(h){console.error("error :>> ",h),L.error("Error al eliminar el registro")}};return e.jsx(je,{title:"¿Estás seguro de que quieres eliminar este rol?",content:"Esta acción no se puede deshacer. Todos los datos relacionados con este rol se eliminarán.",open:s,onOpenChange:a,action:c,variant:"destructive",icon:e.jsx(C,{name:"OctagonAlert",className:"w-6 h-6 text-red-500"})})}function Le(){return e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Administración de roles"}),e.jsx("div",{className:"max-w-full mx-auto py-7 xl:px-8 px-4 overflow-hidden",children:e.jsx(W,{CreateUpdateViewComponent:Ee,SheetTableViewComponent:Fe,DeleteViewComponent:Ue,children:e.jsxs(X,{children:[e.jsx(Y,{}),e.jsx(Q,{}),e.jsx(Z,{}),e.jsx(K,{})]})})})]})}Le.layout=s=>e.jsx(J,{children:s});export{Le as default};
