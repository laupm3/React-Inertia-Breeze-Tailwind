import{r as t,j as e,a as C}from"./app-fwyInB3c.js";function L({empleados:M}){const[o,r]=t.useState(""),[c,i]=t.useState(""),[m,d]=t.useState(""),[u,x]=t.useState(""),[p,b]=t.useState(""),[v,h]=t.useState([]),[g,N]=t.useState(!1),[w,n]=t.useState(null),[k,j]=t.useState(null),l=t.useRef(null),A=s=>{h([...s.target.files])},O=async()=>{var E,S;n(null),j(null);let s=[];o.includes("{todos}")&&(s=M.map(a=>a.email));const F=o.split(",").map(a=>a.trim()).filter(a=>a!=="{todos}"&&a!==""),y=[...new Set([...s,...F])];if(!y.length||!c.trim()||!m.trim()){n("Todos los campos obligatorios deben estar completos.");return}try{N(!0);const a=new FormData;y.forEach(f=>{a.append("to[]",f)}),a.append("subject",c),a.append("message",m),u.trim()&&a.append("message1",u),p.trim()&&a.append("message2",p),v.length>0&&v.forEach(f=>{a.append("attachments[]",f)}),(await C.post("/api/send-email",a)).data.message&&(j("Â¡Correo enviado exitosamente!"),r(""),i(""),d(""),x(""),b(""),h([]),l.current&&(l.current.value=""))}catch(a){n(((S=(E=a.response)==null?void 0:E.data)==null?void 0:S.error)||"Error al enviar el correo.")}finally{N(!1)}},R=()=>{r(""),i(""),d(""),x(""),b(""),h([]),n(null),j(null),l.current&&(l.current.value="")},D=async()=>{const s=await C.get("/sync-templates");console.log(s.data)};return e.jsxs("div",{className:"p-6 max-w-lg mx-auto bg-white shadow-md rounded-lg",children:[e.jsx("h2",{className:"text-black font-semibold mb-4",children:"Enviar Email"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Para (usa ","{todos}"," o correos separados por coma):"]}),e.jsx("input",{type:"text",value:o,onChange:s=>r(s.target.value),placeholder:"Ejemplo: {todos}, usuario1@dominio.com",className:"w-full text-black p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto:"}),e.jsx("input",{type:"text",value:c,onChange:s=>i(s.target.value),placeholder:"Asunto",className:"w-full text-black p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje:"}),e.jsx("textarea",{value:m,onChange:s=>d(s.target.value),placeholder:"Mensaje",className:"w-full text-black p-2 border rounded",rows:4})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje Opcional 1:"}),e.jsx("textarea",{value:u,onChange:s=>x(s.target.value),placeholder:"Mensaje Opcional 1",className:"w-full text-black p-2 border rounded",rows:4})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje Opcional 2:"}),e.jsx("textarea",{value:p,onChange:s=>b(s.target.value),placeholder:"Mensaje Opcional 2",className:"w-full text-black p-2 border rounded",rows:4})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adjuntar archivos:"}),e.jsx("input",{type:"file",multiple:!0,onChange:A,ref:l,className:"text-black"})]}),w&&e.jsx("p",{className:"text-red-500 mb-2",children:w}),k&&e.jsx("p",{className:"text-green-500 mb-2",children:k}),e.jsx("div",{children:e.jsx("button",{onClick:D,children:"Sincronizar plantillas"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:O,className:`w-full p-2 text-white rounded ${g?"bg-gray-400":"bg-green-500"}`,disabled:g,children:g?"Enviando...":"Enviar Email"}),e.jsx("button",{onClick:R,className:"w-full p-2 text-white bg-red-500 rounded",children:"Cancelar"})]})]})}export{L as default};
