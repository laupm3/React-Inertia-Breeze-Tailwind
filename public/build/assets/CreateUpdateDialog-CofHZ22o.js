import{r as a,j as e,G as q,a as J}from"./app-fwyInB3c.js";import{D as K,b as Q,c as W,d as X,f as Y,g as Z}from"./dialog-iaZkf6Xy.js";import{I as k}from"./LucideIcon-CEqEhMjI.js";import{B as ee}from"./button-Blwr-A5N.js";import{I as E}from"./input-CqlBlYgU.js";import{S as D}from"./separator-BWKairMX.js";import{E as _}from"./EmpleadoSelect-uBQCJxR7.js";import{D as se}from"./DecisionModal-Dl8siGBG.js";import{G as te}from"./GoogleSearch-Altsbd1c.js";import{c as B}from"./utils-CytzSlOG.js";import{e as L,C as T,f as M,b as O,c as U,d as P}from"./command-PoUoScut.js";import{P as G,a as I,b as F}from"./popover-DaRbHQOK.js";import{u as $}from"./useTranslation-BtIkv0Na.js";import ae from"./DefaultValuesForm-CRExAQyu.js";import re from"./centroSchema-CYx9S5hk.js";import"./index-DVo7DTeW.js";import"./index-DmpKZt4E.js";import"./index-p2DxCSsL.js";import"./index-DloWbRVd.js";import"./index-B7srb2QZ.js";import"./index-BIJodELy.js";import"./index-DmaU4p-o.js";import"./index-CyKk8pQ_.js";import"./tslib.es6-BUas5LQb.js";import"./index-BZxTbISK.js";import"./x-2mzC_aTV.js";import"./createLucideIcon-DoJ0Kelj.js";import"./calendar-days-Dti00tYQ.js";import"./calendar-k1x2vwx8.js";import"./check-5DjPwM22.js";import"./chevron-up-OjKdrhzc.js";import"./chevron-right-B1iws4WK.js";import"./user-plus-zM6CnMXf.js";import"./user-CNwXqt1W.js";import"./octagon-alert-BRAzZNeG.js";import"./index-BwobEAja.js";import"./EmpleadoAvatar-BBWI_HPN.js";import"./avatar-oBOSifLN.js";import"./tooltip-DFfoxvAF.js";import"./index-CLai1W86.js";import"./index-BZgm3BCW.js";import"./index-CeuhGnKJ.js";import"./alert-dialog-kDfn0La3.js";import"./Button-CQuYVLGu.js";import"./Map-D73hm0ip.js";import"./index.modern-WcJlzckG.js";import"./types-BZmDMmQb.js";function oe({prevEmpresaId:l,fetchUrl:x,className:f,onSelect:r}){const[n,m]=a.useState(!1),[c,u]=a.useState(null),[i,h]=a.useState([]),[N,p]=a.useState(null),[t,g]=a.useState(!0),b=a.useCallback(o=>{r&&r(o)},[r]);a.useEffect(()=>{if(l){const o=i.find(s=>s.id===l);o&&u(o)}else u(null)},[l,i]),a.useEffect(()=>{(async()=>{try{const s=await axios.get(x);s.status===200?h(s.data.empresas):p(!0)}catch{p(!0)}finally{g(!1)}})()},[x]);const j=a.useMemo(()=>i.map(o=>e.jsxs(L,{value:o.id,onSelect:()=>{u(o),m(!1),b(o)},children:[e.jsx(k,{name:"Check",className:B("mr-2 h-4 w-4",(c==null?void 0:c.id)===o.id?"opacity-100":"opacity-0")}),o.nombre]},o.id)),[i,c,b]);return e.jsxs(G,{open:n,onOpenChange:m,modal:!0,children:[e.jsx(I,{asChild:!0,children:e.jsxs("button",{role:"combobox","aria-expanded":n,className:`w-full justify-between rounded-full bg-custom-gray-default dark:bg-custom-gray-darker text-custom-gray-semilight ${f} text-sm flex p-2.5 items-center cursor-default`,onClick:()=>m(!n),children:[c?e.jsx("div",{className:"flex items-center ml-4 -m-1.5",children:c.nombre}):"Selecciona empresa",e.jsx(k,{name:"ChevronsUpDown",className:"ml-2 mr-4 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(F,{className:"w-full p-2",children:e.jsxs(T,{children:[e.jsx(M,{className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-gray-darker",placeholder:"Buscar empresa..."}),e.jsxs(O,{children:[e.jsx(U,{children:N?"Ninguna empresa encontrada":e.jsx("span",{className:"text-red-500",children:"Error al cargar las empresas."})}),e.jsx(P,{children:j})]})]})})]})}function le({prevStatusId:l,fetchUrl:x,className:f,onSelect:r}){const[n,m]=a.useState(!1),[c,u]=a.useState(null),[i,h]=a.useState([]),[N,p]=a.useState(null),[t,g]=a.useState(!0),{t:b}=$("datatable"),j=a.useCallback(s=>{r&&r(s)},[r]);a.useEffect(()=>{if(l){const s=i.find(d=>d.id===l);s&&u(s)}else u(null)},[l,i]),a.useEffect(()=>{(async()=>{try{const d=await axios.get(x);d.status===200?h(d.data.estadoCentros):p(!0)}catch{p(!0)}finally{g(!1)}})()},[x]);const o=a.useMemo(()=>i.map(s=>e.jsxs(L,{value:s.id,onSelect:()=>{u(s),m(!1),j(s)},children:[e.jsx(k,{name:"Check",className:B("mr-2 h-4 w-4",(c==null?void 0:c.id)===s.id?"opacity-100":"opacity-0")}),s.nombre]},s.id)),[i,c,j]);return e.jsxs(G,{open:n,onOpenChange:m,modal:!0,children:[e.jsx(I,{asChild:!0,children:e.jsxs("button",{role:"combobox","aria-expanded":n,className:`w-full justify-between rounded-full bg-custom-gray-default dark:bg-custom-gray-darker text-gray-600 ${f} text-sm flex p-2.5 items-center cursor-default`,onClick:()=>m(!n),children:[c?e.jsx("div",{className:"flex items-center ml-4 -m-1.5",children:c.nombre}):b("placeholder.SeleccionaEstado"),e.jsx(k,{name:"ChevronsUpDown",className:"ml-2 mr-4 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(F,{className:"w-full p-2",children:e.jsxs(T,{children:[e.jsx(M,{className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-gray-darker",placeholder:"Buscar estado..."}),e.jsxs(O,{children:[e.jsx(U,{children:N?"Ningún estado encontrado":e.jsx("span",{className:"text-red-500",children:"Error al cargar los estados."})}),e.jsx(P,{children:o})]})]})})]})}function es({dataId:l,open:x,onOpenChange:f}){const{t:r}=$("datatable"),[n,m]=a.useState(null),[c,u]=a.useState(!0),[i,h]=a.useState(!1),[N,p]=a.useState(!1),t=q(ae),g=a.useCallback(async()=>{try{const s=await J.get(route("api.v1.admin.centros.show",{id:l}));s.status===200?(m(s.data.centro),b(s.data.centro)):h(!0)}catch{h(!0)}finally{u(!1)}},[l]);a.useEffect(()=>{l&&g()},[l,g]);const b=a.useCallback(s=>{const{id:d,nombre:y,email:A,telefono:V,responsable:v,coordinador:C,direccion:z,estado:S,empresa:w,departamentos:H}=s;t.setData({id:d,nombre:y,email:A,telefono:V,responsable_id:v==null?void 0:v.id,coordinador_id:C==null?void 0:C.id,empresa_id:w==null?void 0:w.id,estado_id:S==null?void 0:S.id,departamento_ids:H.map(R=>R.id),direccion:z})},[l,t]),j=a.useCallback(()=>{const s=re(r).safeParse(t.data);if(!s.success){const d=s.error.flatten().fieldErrors;Object.keys(d).forEach(y=>{t.setError(y,d[y][0])});return}n?t.put(route("admin.centros.update",{id:n.id})):t.post(route("admin.centros.store"),{onSuccess:()=>{t.reset(),f()},errorBag:"updateOrCreateCentro"})},[n,t,f,r]),o=r(l?"tables.editarcentro":"tables.creacioncentro");return e.jsxs(e.Fragment,{children:[e.jsx(K,{open:x,onOpenChange:f,children:e.jsxs(Q,{className:"sm:max-w-[1225px] sm:h-[725px] bg-custom-white dark:bg-custom-blackLight",children:[e.jsx(W,{children:e.jsx(X,{className:"",children:o})}),e.jsxs("div",{className:"flex flex-col gap-4 h-full overflow-y-auto p-4",children:[e.jsx("div",{className:"grid gap-8",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.nombrecentro"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(E,{placeholder:r("tables.añadircentro"),className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.nombre,onChange:s=>t.setData("nombre",s.target.value)}),t.errors.nombre&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.nombre})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.administradorcentro"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(_,{fetchUrl:route("api.v1.admin.empleados.searchByType",{typeId:3}),onSelect:s=>t.setData("responsable_id",s.id),prevEmpleadoId:t.data.responsable_id}),t.errors.responsable_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.responsable_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.coordinador"),e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(_,{fetchUrl:route("api.v1.admin.empleados.searchByType",{typeId:2}),onSelect:s=>t.setData("coordinador_id",s.id),prevEmpleadoId:t.data.coordinador_id}),t.errors.coordinador_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.coordinador_id})]})]}),e.jsx(D,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h3",{className:"font-bold",children:r("tables.InformacionContacto")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.direccion")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(te,{selectedAddress:t.data.direccion.full_address,onSelect:s=>t.setData("direccion",{...t.data.direccion,...s}),showMap:!1}),t.errors.direccion&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.direccion})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Email ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(E,{placeholder:"Email de la empresa",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.email,onChange:s=>t.setData("email",s.target.value)}),t.errors.email&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.email})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.telefono")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(E,{placeholder:"Teléfono de la empresa",className:" rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:t.data.telefono,onChange:s=>t.setData("telefono",s.target.value)}),t.errors.telefono&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.telefono})]})]}),e.jsx(D,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h3",{className:"font-bold",children:r("tables.vinculacion")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.empresa")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(oe,{fetchUrl:route("api.v1.admin.empresas.index"),onSelect:s=>t.setData("empresa_id",s.id),prevEmpresaId:t.data.empresa_id}),t.errors.empresa_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.empresa_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:[r("tables.estado")," ",e.jsx("span",{className:"text-custom-orange",children:"*"})]}),e.jsx(le,{fetchUrl:route("api.v1.admin.centros.status"),onSelect:s=>t.setData("estado_id",s.id),prevStatusId:t.data.estado_id}),t.errors.estado_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.errors.estado_id})]})]})]}),e.jsxs(Y,{className:"flex justify-end gap-4",children:[e.jsx(Z,{className:"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-hidden hover:bg-custom-gray-default dark:hover:bg-custom-blackSemi text-custom-black dark:text-custom-white rounded-full",children:r("tables.cancelar")}),e.jsx(ee,{className:"bg-custom-orange hover:bg-custom-blue text-custom-white dark:text-custom-black dark:hover:bg-custom-white rounded-full",onClick:()=>p(!0),children:n?"Editar":"Crear"})]})]})}),e.jsx(se,{variant:"confirm",open:N,onOpenChange:()=>p(!x),action:j,title:"¿Estas seguro de crear el centro?",content:"Esta acción creará un nuevo centro en el sistema. Ejecutando los flujos necesarios para su correcto funcionamiento.",icon:e.jsx(k,{name:"TriangleAlert",className:"text-custom-orange"})})]})}export{es as default};
