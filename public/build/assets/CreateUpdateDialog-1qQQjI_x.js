import{r as c,G as Q,j as e,a as Z,X as K}from"./app-fwyInB3c.js";import{f as ee,c as se,d as ae,e as te,b as oe,D as re}from"./dialog-iaZkf6Xy.js";import{u as le}from"./useTranslation-BtIkv0Na.js";import{o as M,e as ie,f as F,n as $,s as _,d as C,a as ne}from"./types-BZmDMmQb.js";import{u as ce}from"./useApiEndpoints-CHm1F3ft.js";import{toast as R}from"./index-WlsBA3k2.js";import{I as N}from"./input-CqlBlYgU.js";import{S as H}from"./separator-BWKairMX.js";import{G as de}from"./GoogleAddress-DWOptz48.js";import{u as me}from"./useDebounce-xNcQ83OW.js";import{F as q}from"./FetchSelect-CvqHmH4Y.js";import{C as ue}from"./calendar-DctTJhwg.js";import{P as xe,a as fe,b as pe}from"./popover-DaRbHQOK.js";import{B as ge}from"./button-Blwr-A5N.js";import{C as he}from"./calendar-days-Dti00tYQ.js";import{D as I}from"./DatePicker-YJSItPq7.js";import{S as k}from"./skeleton-DSiYFg9q.js";import{B as z}from"./Button-CQuYVLGu.js";import{S as _e}from"./Spinner-DPRe7Z_J.js";import{O as je}from"./octagon-alert-BRAzZNeG.js";const be=()=>{const{t:o}=le(["datatable"]);return M({id:$(ne()),nombre:_().nonempty({message:"El nombre es requerido"}),primer_apellido:_().nonempty({message:"El primer apellido es requerido"}),segundo_apellido:_().nonempty({message:"El segundo apellido es requerido"}),nif:_().nonempty({message:"El NIF es requerido"}),caducidad_nif:_().nonempty({message:"La fecha de caducidad es requerida"}),tipo_empleado_id:F.number().refine(a=>a!==null,{message:"El tipo de empleado es requerido"}),genero_id:F.number().refine(a=>a!==null,{message:"El genero es requerido"}),estado_id:F.number().refine(a=>a!==null,{message:"El estado es requerido"}),tipo_documento_id:F.number().refine(a=>a!==null,{message:"El tipo de documento es requerido"}),email:_().email({message:"El email debe ser un email valido"}),email_secundario:$(_()),telefono:_().nonempty({message:"El telefono es requerido"}),telefono_personal_movil:$(_()).optional(),telefono_personal_fijo:$(_()).optional(),extension_centrex:$(_()).optional(),fecha_nacimiento:_().nonempty({message:"La fecha de nacimiento es requerida"}),niss:_().nonempty({message:"El NISS es requerido"}),contacto_emergencia:$(_()),telefono_emergencia:$(_()),direccion:M({full_address:_().nonempty({message:"La dirección es requerida"}),latitud:C().optional().transform(a=>(a==null?void 0:a.toString())||null),longitud:C().optional().transform(a=>(a==null?void 0:a.toString())||null),codigo_postal:C().optional().transform(a=>(a==null?void 0:a.toString())||null),numero:C().optional().transform(a=>(a==null?void 0:a.toString())||null),piso:C().optional().transform(a=>(a==null?void 0:a.toString())||null),puerta:C().optional().transform(a=>(a==null?void 0:a.toString())||null),escalera:C().optional().transform(a=>(a==null?void 0:a.toString())||null),bloque:C().optional().transform(a=>(a==null?void 0:a.toString())||null)}),user_id:F.number().nullable(),create_user:ie()})},B={id:null,nombre:"",primer_apellido:"",segundo_apellido:"",nif:"",caducidad_nif:"",tipo_empleado_id:"",genero_id:"",estado_id:"",tipo_documento_id:"",email:"",email_secundario:"",telefono:"",telefono_personal_movil:"",telefono_personal_fijo:"",extension_centrex:"",fecha_nacimiento:"",niss:"",contacto_emergencia:"",telefono_emergencia:"",direccion:{id:null,full_address:"",latitud:"",longitud:"",codigo_postal:"",numero:"",piso:"",puerta:"",escalera:"",bloque:""},user_id:null,create_user:!0},Ne=o=>{var l,t,d,u,r,p,j,m,S,g,v,h,b,x,E,D,n,T,y,V,s,i;return o?{id:o.id,nombre:o.nombre||"",primer_apellido:o.primerApellido||"",segundo_apellido:o.segundoApellido||"",nif:o.nif||"",caducidad_nif:o.caducidadNif||o.caducidad_nif||"",tipo_empleado_id:((t=(l=o.tipoEmpleado)==null?void 0:l.id)==null?void 0:t.toString())||"",genero_id:((u=(d=o.genero)==null?void 0:d.id)==null?void 0:u.toString())||"",estado_id:((p=(r=o.estadoEmpleado)==null?void 0:r.id)==null?void 0:p.toString())||"",tipo_documento_id:((m=(j=o.tipoDocumento)==null?void 0:j.id)==null?void 0:m.toString())||"",email:o.email||"",email_secundario:o.emailSecundario||"",telefono:o.telefono||"",telefono_personal_movil:o.telefono_personal_movil||"",telefono_personal_fijo:o.telefono_personal_fijo||"",extension_centrex:o.extension_centrex||"",fecha_nacimiento:o.fechaNacimiento||"",niss:o.niss||"",contacto_emergencia:o.contactoEmergencia||"",telefono_emergencia:o.telefonoEmergencia||"",direccion:{id:((S=o.direccion)==null?void 0:S.id)||null,full_address:((g=o.direccion)==null?void 0:g.full_address)||"",latitud:((h=(v=o.direccion)==null?void 0:v.latitud)==null?void 0:h.toString())||"",longitud:((x=(b=o.direccion)==null?void 0:b.longitud)==null?void 0:x.toString())||"",codigo_postal:((E=o.direccion)==null?void 0:E.codigo_postal)||"",numero:((D=o.direccion)==null?void 0:D.numero)||"",piso:((n=o.direccion)==null?void 0:n.piso)||"",puerta:((T=o.direccion)==null?void 0:T.puerta)||"",escalera:((y=o.direccion)==null?void 0:y.escalera)||"",bloque:((V=o.direccion)==null?void 0:V.bloque)||""},user_id:((s=o.user)==null?void 0:s.id)||null,create_user:!((i=o.user)!=null&&i.id)}:void 0},W=c.createContext(null),ve=({children:o,model:a,onOpenChange:l,dataKey:t,onSaveData:d=null,modelAlias:u="registro"})=>{const[r,p]=c.useState(!1),[j,m]=c.useState(!1),[S,g]=c.useState(!1),[v,h]=c.useState(!1),b=ce(a),x=Q(B),E=be();c.useEffect(()=>{const s=async()=>{try{g(!0),m(!1);const i=await axios.get(b.show);i.status===200?x.setData(Ne(i.data[t])):m(!0)}catch(i){console.error("Error al cargar datos:",i),m(!0)}finally{g(!1)}};return x.clearErrors(),a?s():(x.setData(B),m(!1),g(!1)),()=>{}},[a]);const D=c.useCallback((s,i)=>{if(typeof s=="object"&&i===void 0){x.setData(f=>({...f,...s}));return}x.setData(f=>({...f,[s]:i}))},[x]),n=c.useCallback(()=>{const s=E.safeParse(x.data);if(x.clearErrors(),!s.success){const i=s.error.flatten().fieldErrors;Object.keys(i).forEach(f=>{x.setError(f,i[f][0])})}return s.success},[x,E]),T=c.useCallback(async()=>{try{h(!0),m(!1),x.clearErrors();const s=a?await axios.put(b.update,x.data):await axios.post(b.store,x.data);d&&d(s.data[t]),l(!1),x.clearErrors(),R.success(a?`Registro ${u} actualizado con éxito`:`Registro ${u} creado con éxito`)}catch(s){if(m(!0),s.response&&s.response.data&&s.response.data.errors){const{errors:i}=s.response.data;Object.keys(i).forEach(f=>{x.setError(f,i[f][0])})}R.error(a?`Error al actualizar el ${u}`:`Error al crear el ${u}`)}finally{h(!1)}},[a,b.update,b.store,x,d,l]),y=c.useCallback(()=>{n()&&T()},[n,T]),V=c.useMemo(()=>({modelAlias:u,model:a,error:j,form:x,updateForm:D,handleSubmit:y,setError:m,onOpenChange:l,isProcessing:r,isLoading:S,isSaving:v,setIsProcessing:p}),[u,a,j,x,D,y,l,r,S,v]);return e.jsx(W.Provider,{value:V,children:o})};function P(){const o=c.useContext(W);if(!o)throw new Error("useDialogData debe usarse dentro de DialogDataContextProvider");return o}function ke({documentNumber:o="",expirationDate:a=null,onDocumentNumberChange:l,onExpirationDateChange:t,onDocumentNumberBlur:d,errors:u={},required:r=!1,showCalendar:p=!0,className:j=""}){const[m,S]=c.useState(null);c.useEffect(()=>{if(a){const h=a instanceof Date?a:new Date(a);S(h)}else S(null)},[a]);const g=h=>{S(h),t&&t(h)},v=()=>{if(!m)return!1;const h=new Date;h.setHours(0,0,0,0);const b=new Date(m);return b.setHours(0,0,0,0),b<h};return e.jsxs("div",{className:`flex flex-col gap-2 ${j}`,children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Número de documento",r&&e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{placeholder:"Añadir número de documento",className:`rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi border-none ${p?"pr-32":"pr-4"} h-10`,value:o,onChange:h=>l==null?void 0:l(h.target.value),onBlur:d}),p&&m&&e.jsxs("div",{className:"absolute right-12 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[e.jsx("span",{className:`text-xs ${v()?"text-red-500":"text-custom-orange"} font-medium`,children:m.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}),v()&&e.jsx("span",{className:"text-red-500 text-xs",children:"⚠️"})]}),p&&e.jsxs(xe,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(ge,{variant:"ghost",size:"sm",className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-0 h-6 w-6 hover:bg-transparent",children:e.jsx(he,{className:"h-4 w-4 text-custom-gray-semiDark dark:text-custom-gray-dark hover:text-custom-blue dark:hover:text-custom-orange transition-colors"})})}),e.jsx(pe,{className:"w-auto p-0",align:"end",children:e.jsx(ue,{mode:"single",selected:m,onSelect:g,initialFocus:!0,weekStartsOn:1})})]})]}),u.nif&&e.jsx("span",{className:"text-xs text-red-500",children:u.nif}),u.nif_format_validation&&e.jsx("span",{className:"text-xs text-red-500",children:u.nif_format_validation}),p&&u.caducidad_nif&&e.jsx("span",{className:"text-xs text-red-500",children:u.caducidad_nif})]})}let A=null,L=null;const Se=5*60*1e3,we=async()=>{try{if(A&&L&&Date.now()-L<Se)return A;const o=await Z.get(route("api.v1.admin.empleados.type-documents"));if(o.data&&o.data.tipoDocumentos){const a={};return o.data.tipoDocumentos.forEach(l=>{let t=null;if(l.regex)try{const d=l.regex.replace(/^\/|\/[gimuy]*$/g,"");t=new RegExp(d,"i")}catch(d){console.warn(`Error creando regex para tipo ${l.nombre}:`,d),t=null}a[l.id]={regex:t,message:l.regex_description?`El ${l.nombre} debe tener el formato: ${l.regex_description}`:`Formato inválido para ${l.nombre}`,name:l.nombre,description:l.descripcion}}),A=a,L=Date.now(),a}throw new Error("Formato de respuesta inválido")}catch(o){return console.warn("Error al obtener tipos de documentos de la API:",o),{}}},X=(o,a)=>{if(!a||!o)return{isValid:!0,message:"",documentType:""};const t=(A||{})[o];if(!t||!t.regex)return{isValid:!0,message:"",documentType:(t==null?void 0:t.name)||"Tipo no definido"};const d=a.trim().toUpperCase(),u=t.regex.test(d);return{isValid:u,message:u?"":t.message,documentType:t.name}};class Ee{constructor(){this.validationStates=new Map,this.timeouts=new Map,this.defaultDelay=800}async validateWithState(a,l,t,d=this.defaultDelay){return this.timeouts.has(a)&&clearTimeout(this.timeouts.get(a)),!t||!l?(this.validationStates.set(a,{isValid:!0,message:"",documentType:""}),this.validationStates.get(a)):new Promise(u=>{const r=setTimeout(async()=>{try{const p=X(l,t);this.validationStates.set(a,p),u(p)}catch(p){console.error("Error en validación con estado:",p);const j={isValid:!0,message:"",documentType:"Error de validación"};this.validationStates.set(a,j),u(j)}},d);this.timeouts.set(a,r)})}clearAllStates(){this.validationStates.clear(),this.timeouts.forEach(a=>clearTimeout(a)),this.timeouts.clear()}}const G=new Ee,De=o=>{if(!o)return{isValid:!1,message:"La fecha de caducidad es obligatoria"};try{const a=o instanceof Date?o:new Date(o),l=new Date;return l.setHours(0,0,0,0),a.setHours(0,0,0,0),a<=l?{isValid:!1,message:"El documento está caducado. Debe tener una fecha de caducidad posterior a hoy."}:{isValid:!0,message:""}}catch{return{isValid:!1,message:"Fecha de caducidad inválida"}}},O=(o,a,l)=>{const t={formatValid:!0,formatMessage:"",expirationValid:!0,expirationMessage:"",documentType:""};if(a&&o){const d=X(o,a);t.formatValid=d.isValid,t.formatMessage=d.message,t.documentType=d.documentType}if(l){const d=De(l);t.expirationValid=d.isValid,t.expirationMessage=d.message}return t},U=o=>{if(!o)return"";const a=o.getFullYear(),l=String(o.getMonth()+1).padStart(2,"0"),t=String(o.getDate()).padStart(2,"0");return`${a}-${l}-${t}`};function ye({}){var y,V;const{form:o,updateForm:a}=P(),{data:l,errors:t}=o,{auth:d}=K().props,u=(V=(y=d.user)==null?void 0:y.roles)==null?void 0:V.some(s=>["Administrator","Super Admin"].includes(s.name)),[r,p]=c.useState(l),[j,m]=c.useState({}),[S,g]=c.useState(!1),[v,h]=c.useState(!1),[b,x]=c.useState(!1),E=me(a,500);c.useEffect(()=>{we().catch(()=>{})},[]),c.useEffect(()=>{p(l),l.caducidad_nif&&l.caducidad_nif.trim()&&h(!0)},[l.id]);const D=c.useCallback((s,i)=>{if(!s||!i){m(w=>({...w,nif_format_validation:""})),g(!1);return}if(!i.trim()){m(w=>({...w,nif_format_validation:""})),g(!1);return}const f=`nif_${s}_${i}`;G.validateWithState(f,s,i,800).then(w=>{const Y=!w.isValid&&i.trim()!=="";m(J=>({...J,nif_format_validation:w.isValid?"":w.message})),Y&&i.trim()&&g(!0),w.isValid&&g(!1)}).catch(w=>{console.error("Error en validación de documento:",w)})},[]);c.useEffect(()=>{r.tipo_documento_id&&r.nif?D(r.tipo_documento_id,r.nif):(m(s=>({...s,nif_format_validation:""})),g(!1))},[r.tipo_documento_id,r.nif,D]),c.useEffect(()=>{if(b)if(r.caducidad_nif){const s=O(r.tipo_documento_id,r.nif,r.caducidad_nif);m(i=>({...i,date_expiration_validation:s.expirationValid?"":s.expirationMessage}))}else m(s=>({...s,date_expiration_validation:"La fecha de caducidad es obligatoria"}));else m(s=>({...s,date_expiration_validation:""}))},[r.caducidad_nif,r.tipo_documento_id,r.nif,b]),c.useEffect(()=>{if(t.caducidad_nif){x(!0);return}if(v&&!r.caducidad_nif){x(!0);return}!t.caducidad_nif&&(!v||r.caducidad_nif)&&x(!1)},[t.caducidad_nif,v,r.caducidad_nif]);const n=c.useCallback((s,i)=>{p(typeof s=="object"?f=>({...f,...s}):f=>({...f,[s]:i})),t[s]&&delete t[s],s==="nif"&&(i.trim()||(g(!1),m(f=>({...f,nif_format_validation:""})))),s==="caducidad_nif"?(a(s,i),i&&i.trim()&&x(!1)):E(s,i)},[E,a,t]),T=c.useCallback(()=>{if(r.tipo_documento_id&&r.nif&&r.nif.trim()){const s=O(r.tipo_documento_id,r.nif,r.caducidad_nif),i=!s.formatValid&&r.nif.trim()!=="";m(f=>({...f,nif_format_validation:s.formatValid?"":s.formatMessage})),i&&r.nif.trim()&&g(!0)}else m(s=>({...s,nif_format_validation:""})),g(!1)},[r.tipo_documento_id,r.nif,r.caducidad_nif]);return c.useEffect(()=>()=>{G.clearAllStates()},[]),e.jsxs("div",{className:"flex flex-col gap-4 h-screen",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Nombre",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"Nombre",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.nombre,onChange:s=>n("nombre",s.target.value)}),t.nombre&&e.jsx("span",{className:"text-xs text-red-500",children:t.nombre})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Primer apellido",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"Primer apellido",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.primer_apellido,onChange:s=>n("primer_apellido",s.target.value)}),t.primer_apellido&&e.jsx("span",{className:"text-xs text-red-500",children:t.primer_apellido})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Segundo apellido",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"Segundo apellido",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.segundo_apellido,onChange:s=>n("segundo_apellido",s.target.value)}),t.segundo_apellido&&e.jsx("span",{className:"text-xs text-red-500",children:t.segundo_apellido})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Tipo de documento",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(q,{fetchRoute:"api.v1.admin.empleados.type-documents",responseParameter:"tipoDocumentos",value:r.tipo_documento_id,onValueChange:s=>n("tipo_documento_id",s),disabled:!1}),t.tipo_documento_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.tipo_documento_id})]}),e.jsx(ke,{documentNumber:r.nif,onDocumentNumberChange:s=>n("nif",s),onDocumentNumberBlur:T,errors:{...t,nif_format_validation:S&&r.nif&&r.nif.trim()?j.nif_format_validation:""},required:!0,showCalendar:!1}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Fecha de caducidad del documento",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(I,{className:"rounded-full",selectedDate:r.caducidad_nif?new Date(r.caducidad_nif):void 0,onSelect:s=>{const i=U(s);n("caducidad_nif",i)}}),t.caducidad_nif?e.jsx("span",{className:"text-xs text-red-500",children:t.caducidad_nif}):j.date_expiration_validation&&e.jsx("span",{className:"text-xs text-red-500",children:j.date_expiration_validation})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Tipo de empleado",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(q,{fetchRoute:"api.v1.admin.empleados.types",responseParameter:"tipos",value:r.tipo_empleado_id,onValueChange:s=>n("tipo_empleado_id",s),disabled:!1}),t.tipo_empleado_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.tipo_empleado_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Fecha de nacimiento",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(I,{className:"rounded-full",selectedDate:r.fecha_nacimiento?new Date(r.fecha_nacimiento):void 0,onSelect:s=>{const i=U(s);n("fecha_nacimiento",i)}}),t.fecha_nacimiento&&e.jsx("span",{className:"text-xs text-red-500",children:t.fecha_nacimiento})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Género",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(q,{fetchRoute:"api.v1.admin.empleados.genders",responseParameter:"generos",value:r.genero_id,onValueChange:s=>n("genero_id",s),disabled:!1}),t.genero_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.genero_id})]})]}),e.jsx(H,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h1",{className:"font-bold dark:text-custom-white",children:"Información de contacto"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Dirección",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(de,{selectedAddress:r.direccion.full_address,onSelect:s=>n("direccion",{...r.direccion,...s}),data:r.direccion,handleChange:(s,i)=>n("direccion",{...r.direccion,[s]:i})}),t.direccion&&e.jsx("span",{className:"text-xs text-red-500",children:t.direccion})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Teléfono",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"Teléfono",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.telefono,onChange:s=>n("telefono",s.target.value),type:"tel"}),t.telefono&&e.jsx("span",{className:"text-xs text-red-500",children:t.telefono})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Teléfono personal móvil"}),e.jsx(N,{placeholder:"Teléfono personal móvil",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.telefono_personal_movil,onChange:s=>n("telefono_personal_movil",s.target.value),type:"tel"}),t.telefono_personal_movil&&e.jsx("span",{className:"text-xs text-red-500",children:t.telefono_personal_movil})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Teléfono personal fijo"}),e.jsx(N,{placeholder:"Teléfono personal fijo",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.telefono_personal_fijo,onChange:s=>n("telefono_personal_fijo",s.target.value),type:"tel"}),t.telefono_personal_fijo&&e.jsx("span",{className:"text-xs text-red-500",children:t.telefono_personal_fijo})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Extensión Centrex"}),e.jsx(N,{placeholder:"Extensión Centrex",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.extension_centrex,onChange:s=>n("extension_centrex",s.target.value)}),t.extension_centrex&&e.jsx("span",{className:"text-xs text-red-500",children:t.extension_centrex})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Email",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"Email",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.email,onChange:s=>n("email",s.target.value)}),t.email&&e.jsx("span",{className:"text-xs text-red-500",children:t.email})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Email secundario"}),e.jsx(N,{placeholder:"Email secundario",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.email_secundario,onChange:s=>n("email_secundario",s.target.value)}),t.email_secundario&&e.jsx("span",{className:"text-xs text-red-500",children:t.email_secundario})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Contacto de emergencia"}),e.jsx(N,{placeholder:"Contacto de emergencia",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.contacto_emergencia,onChange:s=>n("contacto_emergencia",s.target.value)}),t.contacto_emergencia&&e.jsx("span",{className:"text-xs text-red-500",children:t.contacto_emergencia})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Teléfono de emergencia"}),e.jsx(N,{placeholder:"Teléfono de emergencia",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.telefono_emergencia,onChange:s=>n("telefono_emergencia",s.target.value)}),t.telefono_emergencia&&e.jsx("span",{className:"text-xs text-red-500",children:t.telefono_emergencia})]}),u&&e.jsxs("div",{className:"grid grid-cols-1 lg:gap-2 sm:gap-8",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Observaciones de salud",e.jsx("span",{className:"text-xs text-gray-500 ml-1",children:"(Opcional - Solo visible para administradores)"})]}),e.jsx("textarea",{placeholder:"Información médica relevante, alergias, condiciones especiales...",className:"flex w-full rounded-[20px] border-none bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-0 focus-visible:border-gray-500 dark:focus-visible:border-white disabled:cursor-not-allowed disabled:opacity-50 dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi resize-none",value:r.observaciones_salud||"",onChange:s=>n("observaciones_salud",s.target.value),rows:3}),t.observaciones_salud&&e.jsx("span",{className:"text-xs text-red-500",children:t.observaciones_salud})]})]}),e.jsx(H,{className:"bg-custom-blackSemi dark:bg-custom-white"}),e.jsx("h1",{className:"font-bold dark:text-custom-white",children:"Información del empleado"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:"Asociar usuario"}),r.create_user?e.jsx("div",{className:"w-full h-10 bg-custom-gray-default dark:bg-custom-blackSemi rounded-full cursor-not-allowed"}):e.jsx(q,{fetchRoute:"api.v1.admin.users.index",responseParameter:"users",value:r.user_id,onValueChange:s=>n("user_id",s),disabled:!1}),t.user_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.user_id}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.create_user,onChange:s=>n("create_user",s.target.checked),className:"text-custom-orange bg-transparent focus:ring-custom-orange mr-2"}),e.jsx("p",{className:"dark:text-custom-white",children:"¿Desea crear un usuario?"})]}),e.jsx("p",{className:"text-xs ml-8 mt-1 opacity-70",children:"Se creará un usuario con la información del empleado"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["Estado",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(q,{fetchRoute:"api.v1.admin.empleados.status",responseParameter:"estados",value:r.estado_id,onValueChange:s=>n("estado_id",s),disabled:!1}),t.estado_id&&e.jsx("span",{className:"text-xs text-red-500",children:t.estado_id})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"text-sm font-bold text-custom-blue dark:text-custom-white",children:["NISS",e.jsx("span",{className:"text-custom-orange",children:" *"})]}),e.jsx(N,{placeholder:"NISS",className:"rounded-full dark:text-custom-gray-default bg-custom-gray-default dark:bg-custom-blackSemi",value:r.niss,onChange:s=>n("niss",s.target.value)}),t.niss&&e.jsx("span",{className:"text-xs text-red-500",children:t.niss})]})]})]})}function Ce(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col w-full gap-12 bg-custom-white dark:bg-custom-blackLight p-4",children:[e.jsx("div",{className:"flex flex-col gap-4 dark:dark-scrollbar",children:e.jsx(k,{className:"h-8 w-[350px]"})}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(k,{className:"h-8 w-[250px]"}),e.jsx(k,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(k,{className:"h-8 w-[250px]"}),e.jsx(k,{className:"h-12 w-full"})]})]}),e.jsx(k,{className:"h-1 w-full"}),e.jsxs("div",{className:"flex flex-row w-full gap-4 overflow-y-auto dark:dark-scrollbar",children:[e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(k,{className:"h-8 w-[250px]"}),e.jsx(k,{className:"h-12 w-full"})]}),e.jsxs("div",{className:"flex flex-col w-1/2 gap-4 dark:dark-scrollbar",children:[e.jsx(k,{className:"h-8 w-[250px]"}),e.jsx(k,{className:"h-12 w-full"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 p-4",children:[e.jsx(k,{className:"h-10 w-24"}),e.jsx(k,{className:"h-10 w-24"})]})]})}function Te(){const{model:o,handleSubmit:a,onOpenChange:l,isSaving:t}=P(),d=o?"Actualizar":"Guardar",u=o?"Actualizando...":"Guardando...";return e.jsxs(ee,{children:[e.jsx("div",{className:"flex flex-row w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center ml-auto justify-end gap-2",children:[e.jsx(z,{variant:"secondary",onClick:()=>l(!1),disabled:t,children:"Cancelar"}),e.jsx(z,{variant:"primary",onClick:()=>a(),disabled:t,children:d})]})}),t&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center gap-2",children:[e.jsx(_e,{size:"sm",className:"text-custom-orange"}),e.jsxs("span",{className:"text-md",children:[u,"..."]})]})]})}function Ve(){const{modelAlias:o,model:a}=P(),l=c.useMemo(()=>a?`Actualizar ${o}`:`Crear ${o}`,[a]);return e.jsxs(se,{children:[e.jsx(ae,{className:"dark:text-custom-white",children:l}),e.jsx(te,{className:"hidden",children:l})]})}const $e=()=>{const{error:o}=P();return o?e.jsxs("div",{className:"mt-4 mb-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-300 p-3 rounded-md flex items-start gap-2 animate-in fade-in slide-in-from-top-3 duration-300",children:[e.jsx(je,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Ha ocurrido un error"}),e.jsx("p",{className:"text-sm",children:"No se pudo procesar la solicitud. Por favor, inténtalo de nuevo."})]})]}):null};function Pe({children:o}){const{isSaving:a}=P();return e.jsxs("div",{className:`flex flex-col gap-4 h-full overflow-y-auto p-4 dark:dark-scrollbar transition-opacity duration-200 ${a?"opacity-60":"opacity-100"}`,children:[e.jsx($e,{}),o]})}function Fe(){const{isLoading:o}=P();return e.jsx(oe,{className:"flex flex-col gap-4 justify-between max-w-[1225px] h-[725px] bg-custom-white dark:bg-custom-blackLight",children:o?e.jsx(Ce,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{}),e.jsx(Pe,{children:e.jsx(ye,{})}),e.jsx(Te,{})]})})}const ss=c.memo(function({open:a,onOpenChange:l,model:t=null,onSaveData:d=null}){return e.jsx(re,{open:a,onOpenChange:l,children:e.jsx(ve,{model:t,onSaveData:d,onOpenChange:l,modelAlias:"empleado",dataKey:"empleado",children:e.jsx(Fe,{})})})});export{ss as C};
