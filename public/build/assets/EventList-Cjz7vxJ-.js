import{r as p,a as y,j as b}from"./app-fwyInB3c.js";import h from"./EventCard-COmVwt0v.js";const m=()=>{const[n,o]=p.useState([]),[i,l]=p.useState([]),[c,a]=p.useState(!1),r=async()=>{try{a(!0);const e=await y.get(route("api.v1.user.eventos.index"));e.data?Array.isArray(e.data)?o(e.data):e.data.eventos&&Array.isArray(e.data.eventos)?o(e.data.eventos):Array.isArray(Object.values(e.data))&&Object.values(e.data).length>0?o(Object.values(e.data)):(console.error("No se encontrÃ³ un array de eventos en la respuesta:",e.data),o([])):(console.error("La respuesta no contiene datos:",e.data),o([]))}catch(e){console.error("Error al obtener eventos:",e),o([])}finally{a(!1)}},s=async()=>{try{const e=await y.get(route("api.v1.user.eventos.tipos"));if(e.data){let t=[];if(e.data.tiposEvento&&Array.isArray(e.data.tiposEvento))t=e.data.tiposEvento;else if(Array.isArray(e.data))t=e.data;else if(typeof e.data=="object"){const u=Object.values(e.data);u.length>0&&typeof u[0]=="object"&&(t=u)}l(t)}else l([])}catch(e){console.error("Error al obtener tipos de eventos:",e),l([])}},d=async e=>{try{const t={nombre:e.titulo,descripcion:e.descripcion||"",fecha_inicio:e.fecha_inicio,hora_inicio:e.hora_inicio||"00:00",tipo_evento_id:e.tipo_evento_id,users:Array.isArray(e.users)&&e.users.length>0?typeof e.users[0]=="object"?e.users.map(f=>f.id):e.users:[],team_id:e.team_id||null,empresa_id:e.empresa_id||null,departamento_id:e.departamento_id||null};if((await y.post(route("user.eventos.store"),t)).data)return await r(),{success:!0}}catch(t){return console.error("Error al crear el evento:",t),{success:!1,error:t}}},_=async e=>{try{const t={nombre:e.titulo,descripcion:e.descripcion||"",fecha_inicio:e.fecha_inicio,hora_inicio:e.hora_inicio||"00:00",tipo_evento_id:e.tipo_evento_id,users:Array.isArray(e.users)&&e.users.length>0?typeof e.users[0]=="object"?e.users.map(f=>f.id):e.users:[],team_id:e.team_id||null,empresa_id:e.empresa_id||null,departamento_id:e.departamento_id||null};if((await y.put(route("user.eventos.update",{evento:e.id}),t)).data)return await r(),{success:!0}}catch(t){return console.error("Error al actualizar el evento:",t),{success:!1,error:t}}},g=e=>{o(n.filter(t=>t.id!==e))};return p.useEffect(()=>{r(),s()},[]),{events:n,eventTypes:i,isLoading:c,fetchEvents:r,fetchEventTypes:s,createEvent:d,updateEvent:_,deleteEvent:g}},E=n=>{const o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return o?{r:parseInt(o[1],16),g:parseInt(o[2],16),b:parseInt(o[3],16)}:null},v=n=>{const o=p.useMemo(()=>{if(!Array.isArray(n)||n.length===0)return{};const c={};return n.forEach(a=>{const r=a.color||"#cccccc",s=E(r);s?c[a.nombre]={hex:r,point:{backgroundColor:r},bg:{backgroundColor:`rgba(${s.r}, ${s.g}, ${s.b}, 0.3)`},text:{color:r},border:{borderColor:r}}:c[a.nombre]={hex:r,point:{backgroundColor:r},bg:{backgroundColor:`${r}33`},text:{color:r},border:{borderColor:r}}}),c},[n]),i=c=>o[c]||{hex:"#cccccc",point:{backgroundColor:"#cccccc"},bg:{backgroundColor:"rgba(204, 204, 204, 0.3)"},text:{color:"#cccccc"},border:{borderColor:"#cccccc"}};return{colorMap:o,getEventTypeColor:i,getEventTypeColorById:c=>{const a=n.find(r=>r.id===c);return i(a?a.nombre:null)}}};function x({filteredEvents:n,handleOpenEventDetails:o,extractTextFromDescription:i}){const{eventTypes:l}=m(),{getEventTypeColorById:c}=v(l),a=r=>{const s=new Date,d=new Date(r);return s.setHours(0,0,0,0),d.setHours(0,0,0,0),d<s};return b.jsx("div",{className:"overflow-y-auto overflow-x-hidden max-h-[540px] p-4",children:n.length>0?n.map(r=>{let s=r.tipo_evento_id;!s&&r.tipo_evento&&(s=r.tipo_evento.id);const d=c(s);return b.jsx(h,{event:r,eventTypeColor:d,onClick:o,extractTextFromDescription:i,isPast:a(r.fecha_inicio)},r.id)}):b.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No hay eventos disponibles."})})}const j=Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"}));export{x as E,j as a,m as u};
