import{r as w,j as e}from"./app-fwyInB3c.js";import{useDataHandler as A}from"./DataHandlerContext-BFIpl_ls.js";import{I as s}from"./LucideIcon-CEqEhMjI.js";import z from"./ApprovalConfirmationDialog-BzOIQ1Nc.js";import"./index-WlsBA3k2.js";import"./ViewContext-ChS6KolG.js";import"./createLucideIcon-DoJ0Kelj.js";import"./calendar-days-Dti00tYQ.js";import"./calendar-k1x2vwx8.js";import"./check-5DjPwM22.js";import"./chevron-up-OjKdrhzc.js";import"./chevron-right-B1iws4WK.js";import"./user-plus-zM6CnMXf.js";import"./user-CNwXqt1W.js";import"./octagon-alert-BRAzZNeG.js";import"./x-2mzC_aTV.js";import"./dialog-iaZkf6Xy.js";import"./index-DVo7DTeW.js";import"./index-DmpKZt4E.js";import"./index-p2DxCSsL.js";import"./index-DloWbRVd.js";import"./index-B7srb2QZ.js";import"./index-BIJodELy.js";import"./index-DmaU4p-o.js";import"./index-CyKk8pQ_.js";import"./tslib.es6-BUas5LQb.js";import"./index-BZxTbISK.js";import"./utils-CytzSlOG.js";import"./button-Blwr-A5N.js";import"./index-BwobEAja.js";import"./textarea-C969rVin.js";function se({solicitud:n,onClose:p=null,className:g="px-6 py-4 border-t dark:border-gray-700"}){var y;const{userApprovalTypes:m,getApprovalTypeInfo:d,handleDropdownAction:v,isProcessingApproval:l}=A(),[c,f]=w.useState({isOpen:!1,approvalType:null,action:null});if(!n)return null;const x=(y=n.estado)==null?void 0:y.nombre,u=["Aprobado","Denegado"].includes(x),b=(t,r)=>{f({isOpen:!0,approvalType:t,action:r})},h=()=>{f({isOpen:!1,approvalType:null,action:null})},N=t=>{v(n,c.approvalType,c.action,t),h(),p&&setTimeout(()=>p(),1e3)},j=()=>{if(!n.aprobaciones||n.aprobaciones.length===0)return{};const t={};return n.aprobaciones.forEach(r=>{t[r.tipo_aprobacion]={...r,typeInfo:d(r.tipo_aprobacion)}}),t},k=t=>j()[t]||null,i=j();if(u&&Object.keys(i).length>0){const t=Object.values(i).find(a=>a.aprobado===(x==="Aprobado"))||Object.values(i)[0],r=x==="Aprobado";return e.jsx("div",{className:g,children:e.jsx("div",{className:"w-full max-w-4xl mx-auto",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[e.jsxs("div",{className:`flex items-center gap-3 ${r?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[e.jsx(s,{name:r?"CheckCircle2":"XCircle",size:24}),e.jsx("span",{className:"font-medium text-lg",children:r?"Solicitud Aprobada":"Solicitud Denegada"})]}),e.jsxs("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(s,{name:t.typeInfo.icon,size:18}),e.jsxs("span",{children:["Por ",t.typeInfo.label]})]}),t.usuario_aprobador&&e.jsx("div",{className:"text-base font-medium text-gray-700 dark:text-gray-200",children:t.usuario_aprobador.name}),t.fecha_aprobacion&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:new Date(t.fecha_aprobacion).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}),t.observacion&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm italic max-w-md mx-auto",children:['"',t.observacion,'"']})]}),Object.keys(i).length>1&&e.jsxs("div",{className:"mt-6 w-full",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3 text-center",children:"Historial de Aprobaciones:"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:Object.values(i).map((a,o)=>e.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-full text-sm ${a.aprobado?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200"}`,children:[e.jsx(s,{name:a.typeInfo.icon,size:14}),e.jsx("span",{children:a.typeInfo.label}),e.jsx(s,{name:a.aprobado?"Check":"X",size:14})]},o))})]})]})})})}return!u&&m&&m.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:g,children:e.jsxs("div",{className:"w-full max-w-4xl mx-auto",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 text-center mb-6",children:"Estado de Aprobaciones"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center",children:m.sort((t,r)=>d(t).order-d(r).order).map(t=>{const r=d(t),a=k(t);if(a){const o=a.aprobado;return e.jsxs("div",{className:"flex flex-col items-center gap-3 w-full max-w-[200px]",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${o?"bg-green-500":"bg-red-500"} shadow-lg`,children:e.jsx(s,{name:o?"Check":"X",size:24,className:"text-white"})}),e.jsxs("div",{className:"flex flex-col items-center text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(s,{name:r.icon,size:16,className:"text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.label})]}),e.jsx("div",{className:`text-sm font-semibold ${o?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:o?"Aprobado":"Denegado"}),a.usuario_aprobador&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center max-w-full break-words",children:["por ",a.usuario_aprobador.name]})]})]},t)}return e.jsxs("div",{className:"flex flex-col items-center gap-3 w-full max-w-[200px]",children:[e.jsxs("div",{className:"flex items-center gap-3 justify-center",children:[e.jsx("button",{onClick:()=>b(t,"aprobar"),disabled:l,className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white w-12 h-12 rounded-full flex items-center justify-center transition-colors shadow-lg hover:shadow-xl",title:`Aprobar como ${r.label}`,children:l?e.jsx(s,{name:"MoreHorizontal",size:20,className:"animate-spin"}):e.jsx(s,{name:"ThumbsUp",size:20})}),e.jsx("button",{onClick:()=>b(t,"denegar"),disabled:l,className:"bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white w-12 h-12 rounded-full flex items-center justify-center transition-colors shadow-lg hover:shadow-xl",title:`Denegar como ${r.label}`,children:l?e.jsx(s,{name:"MoreHorizontal",size:20,className:"animate-spin"}):e.jsx(s,{name:"ThumbsDown",size:20})})]}),e.jsxs("div",{className:"flex flex-col items-center text-center space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{name:r.icon,size:16,className:"text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.label})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Pendiente"})]})]},t)})}),Object.keys(i).length>0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:Object.keys(i).length===1?"1 aprobaci√≥n registrada":`${Object.keys(i).length} aprobaciones registradas`})})]})}),e.jsx(z,{isOpen:c.isOpen,onClose:h,onConfirm:N,solicitud:n,approvalType:c.approvalType,action:c.action,isProcessing:l})]}):null}export{se as default};
